<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>API Coverage Tool Quick Start Examples</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 1.0.24" />
<meta name="dcterms.created" content="2014-07-01T13:22:30Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="SigTest User's Guide" />
<meta name="dcterms.identifier" content="E19036-03" />
<meta name="dcterms.isVersionOf" content="SIGTS" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2006, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../../index.html" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="a_sig_examples.htm" title="Previous" type="text/html" />
<link rel="Next" href="a_compat.htm" title="Next" type="text/html" />
<link rel="alternate" href="SIGTS.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../../dcommon/css/fonts.css">
<link rel="stylesheet" href="../../dcommon/css/foundation.css">
<link rel="stylesheet" href="../../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../../nav/css/html5.css">
<link rel="stylesheet" href="../../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns">
<a id="BEGIN" name="BEGIN"></a>
<span id="PAGE" style="display:none;">20/25</span> <!-- End Header --><a id="Z40000981034657"></a>
<h1 class="appendix"><span class="secnum">B</span> API Coverage Tool Quick Start Examples</h1>
<p>This section contains step-by-step examples that show how to produce test coverage reports using the API Coverage tool. The examples are located in the following directory:</p>
<p><span class="italic">SIGTEST_HOME</span><code>/examples/userguide/apicover</code></p>
<p>The appendix consists of the following examples. The examples build upon each other.</p>
<ul>
<li>
<p><a href="#Z40001ef1036708">Set Up the API Coverage Tool Ant Build Script</a></p>
</li>
<li>
<p><a href="#Z40001ef1037023">Build API Coverage Tool Examples</a></p>
</li>
<li>
<p><a href="#Z40001ef1037276">Run the Example Test Suite</a></p>
</li>
<li>
<p><a href="#Z40001ef1037276">Run the Example Test Suite</a></p>
</li>
<li>
<p><a href="#Z40001ef1037322">Use the API Coverage Tool to Calculate Test Coverage</a></p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<p>The examples use UNIX operating system syntax.</p>
</div>
<div class="infobox-note">
<p class="notep1">Caution:</p>
<p>Code examples are an optional part of the SigTest distribution and are not required to use the SigTest tools. You can remove the example directory (<span class="italic">$SIGTEST_HOME</span><code>/examples)</code> if you are concerned about security issues the examples might create.</p>
</div>
</li>
</ul>
<a id="Z40001ef1036699"></a>
<div class="sect1">
<h2 class="sect1"><span class="secnum">B.1</span> Example Procedures</h2>
<p>The following procedures describes how to set up and use the API Coverage tool.</p>
<a id="Z40001ef1036708"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">B.1.1</span> Set Up the API Coverage Tool Ant Build Script</h3>
<ol>
<li>
<p><a id="Z40002531036723"></a>Make <span class="italic">SIGTEST_HOME</span><code>/examples/userguide/apicover</code> the current directory.</p>
</li>
<li>
<p><a id="Z40002531036731"></a>Make sure that the <code>JAVA_HOME</code> environment variable refers to JDK 5.0 or higher.</p>
</li>
<li>
<p><a id="Z40002531036740"></a>Edit the following file:</p>
<p><span class="italic">SIGTEST_HOME</span><code>/examples/userguide/apicover/build.properties</code></p>
<p>Set the junit.jar property to point to the <code>junit.jar</code> file. Obtain this file from version 3.7 or higher of the JUnit test harness product.</p>
</li>
<li>
<p><a id="Z40002531036749"></a>Make sure Apache Ant 1.7 or higher is available and properly configured on your system.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="Z40001ef1037023"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">B.1.2</span> Build API Coverage Tool Examples</h3>
<ol>
<li>
<p><a id="Z40002531037038"></a>Run the <code>ant</code> command and specify the &rdquo;build&rdquo; target.</p>
<p>This command builds the following:</p>
<ul>
<li>
<p>API classes</p>
</li>
<li>
<p>Example application (<code>helloWorld.jar</code>)</p>
</li>
<li>
<p>Test suite</p>
</li>
<li>
<p>API documentation (<code>doc/</code> directory)</p>
</li>
</ul>
</li>
<li>
<p><a id="Z40002531037046"></a>Run the example application to verify that it built correctly.</p>
<p><code>%java -jar helloWorld.jar</code></p>
<p>The application's output should look like this:</p>
<pre>
Good morning, Brazil!
Good morning, USA!
Good evening, China!
Good afternoon, Czech Republic!
Good afternoon, Russia!
Good afternoon, United Kingdom!
Good evening, India!
Good afternoon, Mali!
Hello, world!
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="Z40001ef1037276"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">B.1.3</span> Run the Example Test Suite</h3>
<ol>
<li>
<p><a id="Z40002531037291"></a>Use the Ant &rdquo;test&rdquo; target to run the test suite.</p>
<p>%ant test</p>
<p>The test suite runs and produces the following output:</p>
<pre>
[junit] Running TestGreet
[junit] Tests run: 4, Failures: 0, Errors: 1, Time elapsed: 0.219 sec
[junit] Test TestGreet FAILED
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="Z40001ef1037299"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">B.1.4</span> Generate a Signature File for the Tested API</h3>
<ol>
<li>
<p><a id="Z40002531037314"></a>Use the Ant &rdquo;sigtest&rdquo; target to generate the signature file.</p>
<p><code>%ant sigtest</code></p>
<p>The &rdquo;sigtest&rdquo; target executes the following command:</p>
<p><code>java -jar sigtestdev.jar setup -filename reports/greetapi.sig -package com.sun.tdk.samples.helloworld.api -classpath helloWorld.jar:$JAVA_HOME/jre/lib/rt.jar</code></p>
<p>This command generates the file reports/greetapi.sig. While the command runs you should see the following output:</p>
<pre>
sigtest:
     [java] Class path: "helloWorld.jar:/opt/java/jdk1.5.0_16/jre/lib/rt.jar"
     [java] Constant checking: on
     [java] Found in total: 13217 classes
     [java] Selected by -Package: 5 classes
     [java] Written to sigfile: 8 classes
     [java] STATUS:Passed.
     [java] Java Result: 95
</pre></li>
</ol>
</div>
<!-- class="sect2" -->
<a id="Z40001ef1037322"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">B.1.5</span> Use the API Coverage Tool to Calculate Test Coverage</h3>
<ol>
<li>
<p><a id="Z40002531037337"></a>Use the Ant &rdquo;apicov&rdquo; target to calculate static test coverage</p>
<p><code>%ant apicov</code></p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="Z40001ef1037347"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">B.1.6</span> Worst Case Mode</h3>
<p>The script executes the following command:</p>
<p>java -jar apicover.jar -ts test_classes -api reports/greetapi.sig -apiinclude com.sun.tdk.samples.helloworld.api -mode w -report reports/cov-worst-case.txt</p>
<p>This mode reports that about of 37% of the API is covered by the tests. Some members that are defined in superclasses, such as finalize() or clone(), are marked as not covered. Some fields are also marked as not covered by the tests. The output written to a file named reports/cov-worst-case.txt and should appear as shown below.</p>
<pre>
Coverage Report

==========================================================================
Package                                 classes
     Class                                         members tested  %%
         Member
==========================================================================
com                                     4         33      14      42%
--------------------------------------------------------------------------
com.sun                                 4         33      14      42%
--------------------------------------------------------------------------
com.sun.tdk                             4         33      14      42%
--------------------------------------------------------------------------
com.sun.tdk.samples                     4         33      14      42%
--------------------------------------------------------------------------
com.sun.tdk.samples.helloworld          4         33      14      42%
--------------------------------------------------------------------------
com.sun.tdk.samples.helloworld.api      4         33      14      42%

    Greet                                         3       3       100%

    GreetFactory                                  6       1       16%
      - clone()
      - equals(Object)
      - finalize()
      - hashCode()
      - toString()

    Places                                        15      6       40%
      - getCountry()
      - toString()
      - valueOf(Class,String)
      - valueOf(String)
      - China
      - Czech
      - India
      - Mali
      - UK

    TimeOfDay                                      9      4       44%
      - valuOf(Class,String)
      - AFTERNOON
      - EVENING
      - MORNING
      - NIGHT
==========================================================================
Overall coverage                        4         33      14      42%
==========================================================================

Configuration
ts   test_classes
api  reports/greetapi.sig
mode w
</pre></div>
<!-- class="sect2" -->
<a id="Z4000c511036266"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">B.1.7</span> Real World Mode</h3>
<p>The script executes the following command:</p>
<pre>
java -jar apicover.jar -ts test_classes -api reports/greetapi.sig -apiinclude com.sun.tdk.samples.helloworld.api -mode r -report reports/cov-realworld.txt
</pre>
<p>This estimation does not take into account overridden members defined in superclasses. Overall coverage is 52%.</p>
<p>The report is named <code>reports/cov-realworld.txt</code> and is shown below.</p>
<pre>
Coverage Report

==========================================================================
Package                                 classes
    Class                                         members tested  %%
        Member
==========================================================================
com                                     4         25      14      56%
--------------------------------------------------------------------------
com.sun                                 4         25      14      56%
--------------------------------------------------------------------------
com.sun.tdk                             4         25      14      56%
--------------------------------------------------------------------------
com.sun.tdk.samples                     4         25      14      56%
--------------------------------------------------------------------------
com.sun.tdk.samples.helloworld          4         25      14      56%
--------------------------------------------------------------------------
com.sun.tdk.samples.helloworld.api      4         25      14      56%

    Greet                                         3       3       100%

    GreetFactory                                  1       1       100%

    Places                                        13      6       46%
      - getCountry()
      - valueOf(String)
      - Brazil
      - China
      - Czech
      - India
      - Mali
      - UK

    TimeOfDay                                     8       4       50%
      - AFTERNOON
      - EVENING
      - MORNING
      - NIGHT
==========================================================================
Overall coverage                        4         25      14      56%
==========================================================================

Configuration
ts   test_classes
api  reports/greetapi.sig
mode r
</pre></div>
<!-- class="sect2" -->
<a id="Z4000c511036272"></a>
<div class="sect2">
<h3 class="sect2"><span class="secnum">B.1.8</span> Real World Mode Without Fields and Enum Constants, detail Level 5</h3>
<p>The script executes the following command:</p>
<pre>
java -jar apicover.jar -ts test_classes -api reports/greetapi.sig -apiinclude com.sun.tdk.samples.helloworld.api -mode r -excludeFields -detail 5 -report reports/cov-realworld-without-fields.txt
</pre>
<p>In this case test coverage is 84%.</p>
<p>The report is named <code>reports/cov-realworld-without-fields.txt</code> and is shown below.</p>
<pre>
Coverage Report

==========================================================================
Package                                 classes
    Class                                         members tested  %%
        Member                                                    count
==========================================================================
com                                     4         13      11      84%
--------------------------------------------------------------------------
com.sun                                 4         13      11      84%
--------------------------------------------------------------------------
com.sun.tdk                             4         13      11      84%
--------------------------------------------------------------------------
com.sun.tdk.samples                     4         13      11      84%
--------------------------------------------------------------------------
com.sun.tdk.samples.helloworld          4         13      11      84%
--------------------------------------------------------------------------
com.sun.tdk.samples.helloworld.api      4         13      11      84%

    Greet                                         3       3       100%
      + greetPlaces()                                               1
      + greetWorld()                                                1
      + setWriter(java.io.Writer)                                   1

    GreetFactory                                  1       1       100%
      + getInstance()                                               1

    Places                                        5       3       60%
      - getCountry()
      + getTz()                                                    1
      + shuffledValues()                                           1
      - valueOf(String)
      + values()                                                   2

    TimeOfDay                                     4       4       100%
      + getCurrentTime(java.util.TimeZone)                          1
      + toString()                                                  2
      + valueOf(String)                                             1
      + values()                                                    2
==========================================================================
Overall coverage                        4         13      11      84%
==========================================================================

Legend 
+ covered member
- uncovered member 

Configuration
ts            test_classes
api           reports/greetapi.sig
excludeFields yes
mode          r
</pre></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment24">
<tr>
<td class="cellalignment31">
<table class="cellalignment29">
<tr>
<td class="cellalignment28"><a href="a_sig_examples.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment28"><a href="a_compat.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2006, 2014,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment33">
<table class="cellalignment27">
<tr>
<td class="cellalignment28"><a href="../../index.html"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment28"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment28"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
