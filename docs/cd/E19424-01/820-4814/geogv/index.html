<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd"><html><head><title>Analyzing Memory Leaks Using the libumem Library (Sun Directory Server Enterprise Edition 7.0 Troubleshooting Guide) </title><meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><link type="text/css" rel="stylesheet" href="/docs/dcommon/dsc/css/default.css" /><link type="text/css" rel="stylesheet" href="/docs/dcommon/dsc/css/www.css" /><link type="text/css" rel="stylesheet" href="/docs/dcommon/dsc/css/dsc.css" /><script language="javascript1.2" type="text/javascript" src="/docs/dcommon/dsc/js/sniff.js"></script><script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head><body><div id='a0v0' class='a0 a0v0'><div class='a2w0'><div id='a2v7' class='a2'><div class='a2w1'><div class='a2w2'><div class='a2w3'><div class='a2w4'><div class='a2topiclinks'><div class='a2x1'></div><a id='sunlogo' title='Oracle Home Page' href='http://www.oracle.com'><img width='98' height='58' border='0' alt='Oracle Homeage' src='/docs/dcommon/dsc/im/a.gif'></a><img width='1' height='33' border='0' alt='test' src='/docs/dcommon/dsc/im/a.gif' id='venuespacer'></div></div></div></div></div></div></div><div id='breadcrumb'><a href='http://www.oracle.com/technetwork/indexes/documentation/index.html'>Documentation Home</a> &nbsp;&gt; <a href='../index.html'>Sun Directory Server Enterprise Edition 7.0 Troubleshooting Guide </a>  &nbsp;&gt; <a href='../6ng8ktnvv/index.html'>Chapter 5 Troubleshooting Directory Server Problems </a>  &nbsp;&gt; <a href='../6ng8kto1b/index.html'>Troubleshooting Memory Leaks </a>  </a> &nbsp;&gt; Analyzing Memory Leaks Using the libumem Library</div><br /><div class='pagetitle' id='sharepage'>Sun Directory Server Enterprise Edition 7.0 Troubleshooting Guide</div><div class='d8 d8v1' style='margin: 10px;'><div class='d8w1'><div class='d8w2'><div class='d8w3'><div class='d8w4'><ul><li class='d8left'><a href='../gegyn/index.html'><em>Previous</em>: Collecting Data About a Memory Leak</a></li><li class='d8right'><a href='../data_mgmt/index.html'><em>Next</em>: Chapter 6 Troubleshooting Data Management Problems</a></li></ul></div></div></div></div></div><div class='pc11 imgMax-590' style='margin: 10px;'><a xmlns:str="http://xml.apache.org/xalan/java/java.lang.String" name="6ng8kto1f"></a><h2 class="sol">Analyzing Memory Leaks Using the <tt>libumem</tt> Library</h2>
<a name="indexterm-132"></a><a name="indexterm-133"></a><a name="indexterm-134"></a><p>On Solaris systems, the <tt>libumem</tt> library is a memory
agent library that is helpful for analyzing the cause of a memory leak. For
more information about the <tt>libumem</tt> library, see the technical
article at the following location: <a href="http://developers.sun.com/solaris/articles/libumem_library.html"><tt>http://developers.sun.com/solaris/articles/libumem_library.html</tt></a>
</p>
<p>Restart the Directory Server using the following command:</p>
<table cellpadding="1" border="1" width="100%">
<tr>
<td nowrap="1">
<br>
<pre># SUN_SUPPORT_SLAPD_NOSH=true LD_PRELOAD=libumem.so \
UMEM_DEBUG=contents,audit=40,guards UMEM_LOGGING=transaction ./dsadm start</pre>
</td>
</tr>
</table><p>The <tt>libumem</tt> library is now loaded before the Directory Server starts,
instead of using the Directory Server memory allocation.</p>
<p>Next, run the <tt>gcore</tt> command several times, once before
the memory use started to grow and once after. The <tt>gcore</tt> command
will dump a memory image in the current directory.</p>
<table cellpadding="1" border="1" width="100%">
<tr>
<td nowrap="1">
<br>
<pre># gcore core.<var>process-id</var>
</pre>
</td>
</tr>
</table><p>Finally, use the <tt>mdb</tt> tool to analyze the results.</p>
</div><div class='d8 d8v1' style='margin: 10px;'><div class='d8w1'><div class='d8w2'><div class='d8w3'><div class='d8w4'><ul><li class='d8left'><a href='../gegyn/index.html'><em>Previous</em>: Collecting Data About a Memory Leak</a></li><li class='d8right'><a href='../data_mgmt/index.html'><em>Next</em>: Chapter 6 Troubleshooting Data Management Problems</a></li></ul></div></div></div></div></div><div class='a5 a5v0' id='a5'>
<ul>
    <li class='copyright'>&copy; 2010, Oracle Corporation and/or its affiliates</li>
</ul>
</div>
</div></body></html>