<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This appendix describes some command-line options that can be useful when diagnosing problems with the Java HotSpot VM.">
      <meta name="description" content="This appendix describes some command-line options that can be useful when diagnosing problems with the Java HotSpot VM.">
      <title>Command-Line Options</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Troubleshooting Guide">
      <meta property="og:description" content="This appendix describes some command-line options that can be useful when diagnosing problems with the Java HotSpot VM.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Troubleshooting Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="troubleshooting-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-20T10:41:43-07:00">
      <meta name="dcterms.title" content="Troubleshooting Guide">
      <meta name="dcterms.dateCopyrighted" content="1995, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E94880-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="environment-variables-and-system-properties.html" title="Previous" type="text/html">
      <link rel="next" href="summary-tools-this-release.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="TROUBLESHOOT">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="environment-variables-and-system-properties.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="summary-tools-this-release.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Troubleshooting Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="appendix.html" property="item" typeof="WebPage"><span property="name"> Appendices </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Command-Line Options</li>
            </ol>
            <a id="GUID-A84ECBFB-B6CF-44C3-B627-58BB509C8D05" name="GUID-A84ECBFB-B6CF-44C3-B627-58BB509C8D05"></a><a id="JSTGD593"></a><a id="JSTGD592"></a>
            
            <h2 id="JSTGD-GUID-A84ECBFB-B6CF-44C3-B627-58BB509C8D05" class="sect2"><span class="enumeration_appendix">D </span>Command-Line Options
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This appendix describes some command-line options that can be useful when diagnosing problems with the Java HotSpot VM.</p>
               <p>This appendix contains the following sections:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="command-line-options1.html#GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6" title="Command-line options that are prefixed with -XX are specific to the Java HotSpot Virtual Machine. Many of these options are important for performance tuning and diagnostic purposes, and are therefore described in this appendix.">Java HotSpot VM Command-Line Options</a></p>
                  </li>
                  <li>
                     <p><a href="command-line-options1.html#GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A" title="In addition to the -XX options, many other command-line options can provide troubleshooting information.">Other Command-Line Options</a></p>
                  </li>
               </ul>
            </div><a id="JSTGD602"></a><a id="JSTGD594"></a><div class="props_rev_3"><a id="GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6" name="GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6"></a><h3 id="JSTGD-GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6" class="sect3">Java HotSpot VM Command-Line Options</h3>
               <div>
                  <p>Command-line options that are prefixed with <code>-XX</code> are specific to the Java HotSpot Virtual Machine. Many of these options are important for performance tuning and diagnostic purposes, and are therefore described in this appendix. 
                  </p>
                  <div class="section">
                     <p>To know more about all possible <code>-XX</code> options, see the <a href="http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html" target="_blank">Java HotSpot VM Options</a>.
                     </p>
                     <p>You can dynamically set, unset, or change the value of certain Java VM flags for a specified Java process using the <code class="codeph">jinfo -flag</code> command. See <a href="diagnostic-tools.html#GUID-8201B690-78C2-417A-8186-D6ECAAA07BEE" title="The jinfo command-line utility gets configuration information from a running Java process or crash dump, and prints the system properties or the command-line flags that were used to start the JVM.">The jinfo Utility</a> and the <a href="diagnostic-tools.html#GUID-92074912-77E2-46B4-9A2F-A27F10331576" title="Another useful tool included in the JDK download is the JConsole monitoring tool. This tool is compliant with JMX. The tool uses the built-in JMX instrumentation in the JVM to provide information about the performance and resource consumption of running applications.">JConsole</a> utility.
                     </p>
                     <p>For a complete list of these flags, use the <span class="bold">MBeans</span> tab of the JConsole utility. See the list of values for the <code class="codeph">DiagnosticOptions</code> attribute of the <code class="codeph">HotSpotDiagnostic</code> MBean, which is in the <code class="codeph">com.sun.management</code> domain. The following are the flags:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">HeapDumpOnOutOfMemoryError</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">HeapDumpPath</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">PrintGC</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">PrintGCDetails</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">PrintGCTimeStamps</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">PrintClassHistogram</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">PrintConcurrentLocks</code></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6__CHDFDIJI">
                     <p class="subhead2" id="GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6__GUID-637E0D77-2A39-47B1-AC40-21E6D77B32A4">The -XX:HeapDumpOnOutOfMemoryError Option</p>
                     <p>This option tells the Java HotSpot VM to generate a heap dump when an allocation from the Java heap or the permanent generation cannot be satisfied. There is no overhead in running with this option, so it can be useful for production systems where the <code class="codeph">OutOfMemoryError</code> exception takes a long time to appear.
                     </p>
                     <p>You can also specify this option at runtime with the <span class="bold">MBeans</span> tab in the <a href="diagnostic-tools.html#GUID-92074912-77E2-46B4-9A2F-A27F10331576" title="Another useful tool included in the JDK download is the JConsole monitoring tool. This tool is compliant with JMX. The tool uses the built-in JMX instrumentation in the JVM to provide information about the performance and resource consumption of running applications.">JConsole</a> utility.
                     </p>
                     <p>The following example shows the result of running out of memory with this flag set.</p><pre class="pre codeblock"><code>$ <span class="bold"><code class="codeph">java -XX:+HeapDumpOnOutOfMemoryError -mn256m -mx512m ConsumeHeap</code></span>
java.lang.OutOfMemoryError: Java heap space
Dumping heap to java_pid2262.hprof ...
Heap dump file created [531535128 bytes in 14.691 secs]
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
        at ConsumeHeap$BigObject.(ConsumeHeap.java:22)
        at ConsumeHeap.main(ConsumeHeap.java:32)
</code></pre><p>The <code class="codeph">ConsumeHeap</code> fills the Java heap and runs out of memory. When the <code class="codeph">java.lang.OutOfMemoryError</code> exception is thrown, a heap dump file is created. In this case the file is 507 MB and is created with the name <code class="codeph">java_pid2262.hprof</code> in the current directory.
                     </p>
                     <p>By default, the heap dump is created in a file called <code class="codeph">java_pid<span class="variable" translate="no">pid.hprof</span></code> in the working directory of the VM, as in the example above. You can specify an alternative file name or directory with the <code class="codeph">-XX:HeapDumpPath=</code> option. For example <code class="codeph">-XX:HeapDumpPath=/disk2/dumps</code> will cause the heap dump to be generated in the <code>/disk2/dumps</code> directory.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6__CHDFEJBB">
                     <p class="subhead2" id="GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6__GUID-F921471E-2AD1-4525-944D-43FB613EF3F4">The -XX:OnError Option</p>
                     <p>When a fatal error occurs, the Java HotSpot VM can optionally execute a user-supplied script or command. The script or command is specified using the <code class="codeph">-XX:OnError=<span class="variable" translate="no">string</span></code> command-line option, where <code class="codeph"><span class="variable" translate="no">string</span></code> is a single command, or a list of commands separated by semicolons. Within this string, all occurrences of <code class="codeph">%p</code> are replaced with the current PID, and all occurrences of <code class="codeph">%%</code> are replaced by a single <code class="codeph">%</code>. The following examples demonstrate how this option can be used when launching a Java application named MyApp with the <code class="codeph">java</code> launcher.
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold"><code class="codeph">java -XX:OnError="pmap %p" MyApp</code></span></p>
                           <p>On the Oracle Solaris operating system the <code class="codeph">pmap</code> command displays information about the address space of a process. In the example, if a fatal error occurs, then the <code class="codeph">pmap</code> command is executed and displays the address space of the current process.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">java -XX:OnError="cat hs_err_pid%p.log | mail support@acme.com" MyApp</code></span></p>
                           <p>In the example above, the contents of the fatal error log file are mailed to a support alias when a fatal error occurs.</p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">java -XX:OnError="gcore %p; dbx - %p" MyApp</code></span></p>
                           <p>On the Oracle Solaris operating system the <code class="codeph">gcore</code> command creates a core image of the specified process, and the <code class="codeph">dbx</code> command launches the debugger. In the example above, the <code class="codeph">gcore</code> command is executed to create the core image of the current process, and the debugger is started to attach to the process when an unexpected error occurs.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">java -XX:OnError="gdb - %p" MyApp</code></span></p>
                           <p>On Linux, the <code class="codeph">gdb</code> command launches the debugger. In the example above, the <code class="codeph">gdb</code> debugger is launched and attached to the current process when an unexpected error is encountered.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">java -XX:OnError="userdump.exe %p" MyApp</code></span></p>
                           <p>On Windows, the <code class="codeph">userdump.exe</code> utility creates a crash dump of the specified process. The utility does not ship with Windows and should be downloaded from the Microsoft website as a part of the Microsoft OEM Support Tools package.
                           </p>
                           <p>In the example, the <code class="codeph">userdump.exe</code> utility is executed to create a core dump of the current process in case of a fatal error.
                           </p>
                           <div class="infoboxnote" id="GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6__GUID-263FEA30-30BF-44CE-8150-4E11EC5F3DBA">
                              <p class="notep1">Note:</p>
                              <p>The example assumes that the path to the <code class="codeph">userdump.exe</code> utility is defined in the <code class="codeph">PATH</code> variable.
                              </p>
                           </div>
                        </li>
                     </ul>
                     <p>To know more about creating crash dumps on Windows, see <a href="submit-bug-report.html#GUID-F7841268-D783-4E3D-9BB3-3EB50CD186BE" title="In the Windows operating system there are three types of crash dumps: Dr. Watson log file, user minidump, and Dr. Watson full dump.">Collect Crash Dumps on Windows</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6__CHDJIEHH">
                     <p class="subhead2" id="GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6__GUID-12CB07F9-648D-4DE6-9C67-45E431E240E2">The -XX:ShowMessageBoxOnError Option</p>
                     <p>When this option is set and a fatal error occurs, the HotSpot VM will display information about the fatal error and prompt the user to specify whether the native debugger is to be launched. In the case of the Oracle Solaris and Linux operating systems, the output and prompt are sent to the application console (standard input and standard output). In the case of Windows, a Windows message box pops up.</p>
                     <p>The following example shows a fatal error on a Linux system.</p><pre class="pre codeblock"><code>==============================================================================
Unexpected Error
------------------------------------------------------------------------------
SIGSEGV (0xb) at pc=0x2000000001164db1, pid=10791, tid=1026

Do you want to debug the problem?

To debug, run 'gdb /proc/10791/exe 10791'; then switch to thread 1026
Enter 'yes' to launch gdb automatically (PATH must include gdb)
Otherwise, press RETURN to abort...
==============================================================================
</code></pre><p>In this case, a <code class="codeph">SIGSEGV</code> error occurred, and the user is prompted to specify whether the <code class="codeph">gdb</code> debugger is to be launched to attach to the process. If the user enters <code class="codeph">y</code> or <code class="codeph">yes</code>, then<code class="codeph">gdb</code> will be launched (assuming it is set in the <code class="codeph">PATH</code> variable).
                     </p>
                     <p>On the Oracle Solaris operating system, the message is similar to the Linux example, except that the user is prompted to start the <code class="codeph">dbx</code> debugger.
                     </p>
                     <p>On Windows a message box is displayed. If the user clicks <span class="bold">Yes</span>, the VM will attempt to start the default debugger. This debugger is configured by a registry setting which is described in <a href="submit-bug-report.html#GUID-F7841268-D783-4E3D-9BB3-3EB50CD186BE" title="In the Windows operating system there are three types of crash dumps: Dr. Watson log file, user minidump, and Dr. Watson full dump.">Collect Crash Dumps on Windows</a>. If Microsoft Visual Studio is installed, the default debugger is typically configured to be <code class="codeph">msdev.exe</code>.
                     </p>
                     <p>In the above example, the output includes the PID (<code class="codeph">pid=10791</code>) and also the thread ID (<code class="codeph">tid=1026</code>). If the debugger is launched, one of the initial steps in the debugger might be to select the thread and get its stack trace.
                     </p>
                     <p>When the process is waiting for a response, it is possible to use other tools to get a crash dump or query the state of the process. On the Oracle Solaris operating system, for example, a core dump can be obtained using the <code class="codeph">gcore</code> utility.
                     </p>
                     <p>On Windows, a Dr. Watson crash dump can be obtained using the <code class="codeph">userdump</code> or <code class="codeph">windbg</code> programs. The <code class="codeph">windbg</code> utility is included in Microsoft's Debugging Tools for Windows and is described in <a href="submit-bug-report.html#GUID-F7841268-D783-4E3D-9BB3-3EB50CD186BE" title="In the Windows operating system there are three types of crash dumps: Dr. Watson log file, user minidump, and Dr. Watson full dump.">Collect Crash Dumps on Windows</a>. In <code class="codeph">windbg</code>, select the <span class="bold">Attach to a Process</span> menu option, which displays the list of processes and prompts for the PID. The HotSpot VM displays a message box, which includes the PID. After you selected the PID, the <code class="codeph">.dump /f</code> command can be used to force a crash dump. <a href="command-line-options1.html#GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6__CHDCJIHF">Figure D-1</a> is an example crash dump created in a file named <code class="codeph">crash.dump</code>.
                     </p>
                     <div class="figure" id="GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6__CHDCJIHF">
                        <p class="titleinfigure">Figure D-1 Example of a Crash Dump Created by windbg</p><img src="img/crash-dump-windbg.gif" alt="Description of Figure D-1 follows" title="Description of Figure D-1 follows" longdesc="img_text/crash-dump-windbg.html"><br><a href="img_text/crash-dump-windbg.html">Description of "Figure D-1 Example of a Crash Dump Created by windbg"</a></div>
                     <!-- class="figure" -->
                     <p>In general, the <code class="codeph">-XX:+ShowMessageBoxOnError</code> option is more useful in a development environment where the debugger tools are available. The <code class="codeph">-XX:OnError</code> option is more suitable for production environments where a fixed sequence of commands or scripts are executed when a fatal error occurs.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6__CHDHGIDJ">
                     <p class="subhead2" id="GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6__GUID-86DA3531-0CF3-4D64-9DFC-AC334368321F">Other -XX Options</p>
                     <p>Several other <code class="codeph">-XX</code> command-line options can be useful when troubleshooting:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="bold"><code class="codeph">-XX:OnOutOfMemoryError</code></span><span class="italic"><code class="codeph">=string</code></span></p>
                           <p>This option can be used to specify a command or script to execute when an <code class="codeph">OutOfMemoryError</code> exception is thrown.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">-XX:ErrorFile</code></span><span class="italic"><code class="codeph">=filename</code></span></p>
                           <p>This option can be used to specify a location for the fatal error log file. See <a href="fatal-error-log.html#GUID-6903F4A6-326C-403F-9DF0-475DC50F42F8" title="To specify where the log file will be created, use the product flag -XX:ErrorFile=file, where file represents the full path for the log file location.">Location of Fatal Error Log</a>.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">-xx:HeapDumpPath</code></span><span class="italic"><code class="codeph">=path</code></span></p>
                           <p>This option can be used to specify a location for the heap dump. See <a href="command-line-options1.html#GUID-B5E16C7D-AE3C-40EB-A192-234C130766A6__CHDFDIJI">The -XX:HeapDumpOnOutOfMemoryError Option</a>.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">-XX:MaxPermSize</code></span><span class="italic"><code class="codeph">=size</code></span></p>
                           <p>This option can be used to specify the size of the permanent generation memory. See <a href="troubleshoot-memory-leaks.html#GUID-19F6D28E-75A1-4480-9879-D0932B2F305B" title="java.lang.OutOfMemoryError error is thrown when there is insufficient space to allocate an object in the Java heap.">Understand the OutOfMemoryError Exception</a>.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">-XX:+PrintCommandLineFlags</code></span></p>
                           <p>This option can be used to print all the VM command-line flags. See <a href="submit-bug-report.html#GUID-E0B90A72-D502-4DD7-B7E1-CF043CF74B40" title="In general, it is recommended to test with the latest update release or even a latest available early access (EA) release to see if the issue persists , and then collect as much relevant data as possible when you create a bug report or submit a support call.">Collect Data for a Bug Report</a>.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">-XX:+PrintConcurrentLocks</code></span></p>
                           <p>This option can be used to cause the Control+Break handler to print a list of concurrent locks owned by each thread.</p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">-XX:+PrintClassHistogram</code></span></p>
                           <p>This option can be used to cause the Control+Break handler to print a heap histogram.</p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">-XX:+PrintGCDetails </code></span>and<span class="bold"><code class="codeph">-XX:+PrintGCTimeStamps</code></span></p>
                           <p>These options can be used to print detailed information about garbage collection. See <a href="command-line-options1.html#GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A__CHDJIIFF">The -verbose:gc Option</a>.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">-XX:+UseAltSigs</code></span></p>
                           <p>On Oracle Solaris 8 and 9 operating system, this option can be used to instruct the HotSpot VM to use alternate signals to <code class="codeph">SIGUSR1</code> and <code class="codeph">SIGUSR2</code>. See <a href="handle-signals-and-exceptions.html#GUID-F012840D-8E5A-4B6D-8E49-0129A9EE46DB" title="The Java HotSpot VM installs signal handlers to implement various features and to handle fatal error conditions.">Handle Signals on Oracle Solaris, Linux, and macOS</a>.
                           </p>
                        </li>
                        <li>
                           <p><span class="bold"><code class="codeph">-XX:+UseConcMarkSweepGC </code></span>, <span class="bold"><code class="codeph">-XX:+UseSerialGC</code></span> and <span class="bold"><code class="codeph">-XX:+UseParallelGC</code></span></p>
                           <p>These options can be used to specify the garbage collection policy to be used. See <a href="troubleshoot-system-crashes.html#GUID-F364244B-ABC0-4FAF-AFA5-35BABA346E48" title="Possible workaround if the crash occurs during garbage collection.">Working Around Crashes During Garbage Collection</a>.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="JSTGD603"></a><div class="props_rev_3"><a id="GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A" name="GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A"></a><h3 id="JSTGD-GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A" class="sect3">Other Command-Line Options</h3>
               <div>
                  <p>In addition to the <code>-XX</code> options, many other command-line options can provide troubleshooting information.
                  </p>
                  <div class="section">
                     <p>This section describes a few of these options.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A__CHDDEGBI">
                     <p class="subhead2" id="GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A__GUID-311C5F8C-815E-4275-A32F-5B27266E67EB">The -Xcheck:jni Option</p>
                     <p>This option is useful when diagnosing problems with applications that use the Java Native Interface (JNI). Sometimes, bugs in the native code can cause the HotSpot VM to crash or behave incorrectly.</p>
                     <p>The <code class="codeph">-Xcheck:jni</code> option is added to the command line that starts the application, as in the following example:
                     </p><pre class="pre codeblock"><code>java -Xcheck:jni MyApp
</code></pre><p>The <code>-Xcheck:jni</code> option causes the VM to do additional validation on the arguments passed to JNI functions.
                     </p>
                     <div class="infoboxnote" id="GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A__GUID-652C835C-2CD6-4409-A0F1-278B6A6CDE31">
                        <p class="notep1">Note:</p>The option is not guaranteed to find all invalid arguments or diagnose logic bugs in the application code, but it can help diagnose a large number of such problems.
                     </div>
                     <p>When an invalid argument is detected, the VM prints a message to the application console or to standard output, prints the stack trace of the offending thread, and stops the VM.</p>
                     <p>The following example shows a <code class="codeph">null</code> value was incorrectly passed to a JNI function that does not allow a <code class="codeph">null</code> value.
                     </p><pre class="pre codeblock"><code>FATAL ERROR in native method: Null object passed to JNI
    at java.net.PlainSocketImpl.socketAccept(Native Method)
    at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:343)
    - locked &lt;0x450b9f70&gt; (a java.net.PlainSocketImpl)
    at java.net.ServerSocket.implAccept(ServerSocket.java:439)
    at java.net.ServerSocket.accept(ServerSocket.java:410)
    at org.apache.tomcat.service.PoolTcpEndpoint.acceptSocket
                        (PoolTcpEndpoint.java:286)
    at org.apache.tomcat.service.TcpWorkerThread.runIt
                        (PoolTcpEndpoint.java:402)
    at org.apache.tomcat.util.ThreadPool$ControlRunnable.run
                        (ThreadPool.java:498)
    at java.lang.Thread.run(Thread.java:536)
</code></pre><p>The following example shows an incorrect argument that was provided to a JNI function that expects a <code class="codeph">jfieldID</code> argument.
                     </p><pre class="pre codeblock"><code>FATAL ERROR in native method: Instance field not found in JNI get/set 
                        field operations
        at java.net.PlainSocketImpl.socketBind(Native Method)
        at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:359)
        - locked &lt;0xf082f290&gt; (a java.net.PlainSocketImpl)
        at java.net.ServerSocket.bind(ServerSocket.java:318)
        at java.net.ServerSocket.&lt;init&gt;(ServerSocket.java:185)
        at jvm003a.&lt;init&gt;(jvm003.java:190)
        at jvm003a.&lt;init&gt;(jvm003.java:151)
        at jvm003.run(jvm003.java:51)
        at jvm003.main(jvm003.java:30)
</code></pre><p>The following are examples of other problems that the <code class="codeph">-Xcheck:jni</code> option can help diagnose:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Cases where the JNI environment for the wrong thread is used</p>
                        </li>
                        <li>
                           <p>Cases where an invalid JNI reference is used</p>
                        </li>
                        <li>
                           <p>Cases where a reference to a non-array type is provided to a function that requires an array type</p>
                        </li>
                        <li>
                           <p>Cases where a non-static field ID is provided to a function that expects a static field ID</p>
                        </li>
                        <li>
                           <p>Cases where a JNI call is made with an exception pending</p>
                        </li>
                     </ul>
                     <p>In general, all errors detected by the <code class="codeph">-Xcheck:jni</code> option are fatal errors (that is, the error is printed and the VM is stopped). There is one exception to this behavior, when a JNI call is made within a JNI critical region. In this case, the following non-fatal warning message is printed, as shown in the following example.
                     </p><pre class="pre codeblock"><code>Warning: Calling other JNI functions in the scope of 
Get/ReleasePrimitiveArrayCritical or Get/ReleaseStringCritical
</code></pre><p>A JNI critical region is created when native code uses the JNI functions <code class="codeph">GetPrimitiveArrayCritical</code> or <code class="codeph">GetStringCritical</code> to obtain a reference to an array or string in the Java heap. The reference is held until the native code calls the corresponding release function. The code between the get and release is called a JNI critical section, and during that time, the HotSpot VM cannot bring the VM to a state that allows garbage collection to occur. The general recommendation is not to use other JNI functions within a JNI critical section, and in particular any JNI function that could potentially cause a deadlock. The warning printed above by the <code class="codeph">-Xcheck:jni</code> option is thus an indication of a potential issue; it does not always indicate an application bug.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A__CHDJECGJ">
                     <p class="subhead2" id="GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A__GUID-891AEA7B-B7FE-456F-A4D7-CD1881D48BD9">The -verbose:class Option</p>
                     <p>This option enables logging of class loading and unloading.</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A__CHDJIIFF">
                     <p class="subhead2" id="GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A__GUID-85FD4428-7018-43C6-BB24-AE43B953310D">The -verbose:gc Option</p>
                     <p>This option enables logging of garbage collection (GC) information. It can be combined with other HotSpot VM-specific options such as <code>-XX:+PrintGCDetails</code> and <code>-XX:+PrintGCTimeStamps</code> to get further information about GC. The information output includes the size of the generations before and after each GC, total size of the heap, the size of objects promoted, and the time taken.
                     </p>
                     <p>More information about these options, along with detailed information about GC analysis and tuning are described in the <a href="http://www.oracle.com/technetwork/articles/javase/gcportal-136937.html" target="_blank">GC Portal article</a>.
                     </p>
                     <p>The <code>-verbose:gc</code> option can be dynamically enabled at runtime using the management API or JVM TI. See <a href="diagnostic-tools.html#GUID-55FDAAC0-8FA8-4F12-AE28-1E768FB49901" title="The JDK has extensive APIs to develop custom tools to observe, monitor, profile, debug, and diagnose issues in applications that are deployed in the JRE.">Custom Diagnostic Tools</a>.
                     </p>
                     <p>The JConsole monitoring and management tool can also enable or disable the option when the tool is attached to a management VM. See <a href="diagnostic-tools.html#GUID-92074912-77E2-46B4-9A2F-A27F10331576" title="Another useful tool included in the JDK download is the JConsole monitoring tool. This tool is compliant with JMX. The tool uses the built-in JMX instrumentation in the JVM to provide information about the performance and resource consumption of running applications.">JConsole</a>.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A__CHDCHGEE">
                     <p class="subhead2" id="GUID-DE9FAAAF-DCD4-4974-A86F-C6B8907CCE9A__GUID-D746C849-A41F-48DA-990C-51D33CA48854">The -verbose:jni Option</p>
                     <p>This option enables the logging of JNI. When a JNI or native method is resolved, the HotSpot VM prints a trace message to the application console (standard output). It also prints a trace message when a native method is registered using the JNI <code class="codeph">RegisterNative</code> function. The <code>-verbose:jni</code> option can be useful when diagnosing issues with applications that use native libraries.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>
