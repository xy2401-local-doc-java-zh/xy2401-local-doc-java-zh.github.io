<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This section describes how to access Java from a script interpreted by the Nashorn engine.">
      <meta name="description" content="This section describes how to access Java from a script interpreted by the Nashorn engine.">
      <title>The Nashorn Java API</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Nashorn User's Guide">
      <meta property="og:description" content="This section describes how to access Java from a script interpreted by the Nashorn engine.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Nashorn User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="nashorn-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-20T19:14:09-07:00">
      <meta name="dcterms.title" content="Nashorn User's Guide">
      <meta name="dcterms.dateCopyrighted" content="2014, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E94836-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="introduction.html" title="Previous" type="text/html">
      <link rel="next" href="nashorn-and-javafx.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="NASHORN">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="introduction.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="nashorn-and-javafx.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Nashorn User's Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">The Nashorn Java API</li>
            </ol>
            <a id="GUID-0C8FD2AD-6000-425F-BC22-25AAC6A14225" name="GUID-0C8FD2AD-6000-425F-BC22-25AAC6A14225"></a><a id="JSNUG113"></a><a id="JSNUG112"></a>
            
            <h2 id="JSNUG-GUID-0C8FD2AD-6000-425F-BC22-25AAC6A14225" class="sect2"><span class="enumeration_chapter">2 </span>The Nashorn Java API
            </h2>
         </header>
         <div class="ind">
            <div>
               <div><span>This section describes how to access Java from a script interpreted by the Nashorn engine.</span></div>
               <div class="infoboxnote" id="GUID-0C8FD2AD-6000-425F-BC22-25AAC6A14225__THENASHORNENGINETHEJJSTOOLANDTHEMOD-A65A6866">
                  <p class="notep1">Note:</p>The Nashorn engine, the <code class="codeph">jjs</code> tool, and the modules <span class="apiname">jdk.scripting.nashorn</span> and <span class="apiname">jdk.scripting.nashorn.shell</span> are deprecated in JDK 11 in preparation for removal in a future release.
               </div>
               <p>This section contains examples of script statements interpreted by the Nashorn engine in interactive language shell mode. This interactive shell is started by running the <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/java/javase/11/nashorn&amp;id=JSWOR-GUID-0F3625BB-9E0E-46C3-8FF1-CEFDD91EDF85" target="_blank"><code class="codeph">jjs</code></a> command without any scripts passed to it. This is useful for trying things out, but the main purpose of the Nashorn Java API is to write Java applications as scripts that can be interpreted by the Nashorn engine.
               </p>
               <div class="section">
                  <p class="subhead1" id="GUID-0C8FD2AD-6000-425F-BC22-25AAC6A14225__GUID-A51CDA65-EC53-49FC-8BAD-FB498977DD30">Topics</p>
                  <ul style="list-style-type: disc;">
                     <li><a href="nashorn-java-api.html#GUID-336B7904-ABCF-4588-A640-C2F7746F8333" title="There are two approaches to access packages and classes using Nashorn: the traditional approach is to use the Packages global object, and the recommended approach is to use the Java global object. This section describes both approaches.">Accessing Java Classes</a></li>
                     <li><a href="nashorn-java-api.html#GUID-5EB82F41-6871-4896-8495-6D3DA373DE13" title="To instantiate a class, pass the JavaClass function object to the new operator. Nashorn invokes the corresponding constructor based on the arguments passed to the function.">Creating Java Objects</a></li>
                     <li><a href="nashorn-java-api.html#GUID-5ED04A1E-9269-463A-AFB8-7A6C365ABC9F" title="You can use the standard dot notation to access static fields, methods, and inner classes as follows.">Accessing Class and Instance Members</a></li>
                     <li><a href="nashorn-java-api.html#GUID-594ED1F7-993A-433F-A2AE-B1B8B12E1690" title="Nashorn enables you to treat accessor and mutator methods in JavaBeans as equivalent JavaScript properties. The name of the property is the name of the JavaBean method without the get or set suffix, and starts with a lowecase letter.">Using JavaBeans</a></li>
                     <li><a href="nashorn-java-api.html#GUID-B63F085D-82E0-4B45-AC85-B0F78A213E9D" title="To access a Java array class, pass to the Java.type() function the type of objects that comprise the array followed by a pair of brackets (similar to Java syntax).">Working with Java Arrays</a></li>
                     <li><a href="nashorn-java-api.html#GUID-1674531B-4008-4871-B47E-D13628616C66" title="Nashorn represents strings as java.lang.String objects. When you concatenate two strings, you get a String instance.">Working with Java Strings</a></li>
                     <li><a href="nashorn-java-api.html#GUID-191A697D-23F8-4F73-BAAD-FCE653BECF36" title="Nashorn interprets numbers as java.lang.Double, java.lang.Long, or java.lang.Integer objects, depending on the computation performed. You can use the Number() function to force a number to be a Double object, as shown in the following example.">Working with Java Numbers</a></li>
                     <li><a href="nashorn-java-api.html#GUID-D1C84FB4-33D6-4584-843A-FD3356C4D11F" title="Nashorn interprets Java lists as arrays; iterate over the values of a list with the for each statement. To iterate over keys and values in a map, use the keySet() and values() methods.">Working with Java Lists and Maps</a></li>
                     <li><a href="nashorn-java-api.html#GUID-B631F440-2320-47D7-8012-85A70A40F986" title="You can extend a class using the Java.extend() function that takes a Java type as the first argument and method implementations (in the form of JavaScript functions) as the other arguments.">Extending Java Classes</a></li>
                     <li><a href="nashorn-java-api.html#GUID-44255E9F-8FAE-4FFD-84BA-90A572AFC51B" title="The jdk.nashorn.api.scripting.ClassFilter interface provides fine-grained control over access to Java classes from JavaScript code by restricting access to specified Java classes from scripts run by a Nashorn script engine.">Restricting Script Access to Specified Java Classes</a></li>
                  </ul>
               </div>
               <!-- class="section" -->
            </div><a id="JSNUG114"></a><div class="props_rev_3"><a id="GUID-336B7904-ABCF-4588-A640-C2F7746F8333" name="GUID-336B7904-ABCF-4588-A640-C2F7746F8333"></a><h3 id="JSNUG-GUID-336B7904-ABCF-4588-A640-C2F7746F8333" class="sect3">Accessing Java Classes</h3>
               <div>
                  <p>There are two approaches to access packages and classes using Nashorn: the traditional approach is to use the <code class="codeph">Packages</code> global object, and the recommended approach is to use the <code class="codeph">Java</code> global object. This section describes both approaches.
                  </p>
                  <p>The predefined top-level <code class="codeph">Packages</code> object enables you to access Java packages and classes using their fully qualified names, as if they are properties of the <code class="codeph">Packages</code> object. The following example shows how you can access the <code class="codeph">MyPackage</code> package and its <code class="codeph">MyClass</code> class if <code class="codeph">MyPackage.jar</code> is in your class path:
                  </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">Packages.MyPackage</span>
[JavaPackage MyPackage]
jjs&gt; <span class="bold">Packages.MyPackage.MyClass</span>
[JavaClass MyPackage.MyClass]
</code></pre><p>Accessing standard Java packages and classes is more straightforward than accessing custom packages and classes. For your convenience, there are global objects defined for each of the standard Java packages: <code class="codeph">com</code>, <code class="codeph">edu</code>, <code class="codeph">java</code>, <code class="codeph">javax</code>, and <code class="codeph">org</code>. They have aliases that correspond to properties of the <code class="codeph">Packages</code> object. The following example shows how you can access the <code class="codeph">java.lang</code> package and the <code class="codeph">java.lang.System</code> class:
                  </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">java.lang</span>
[JavaPackage java.lang]
jjs&gt; <span class="bold">typeof java.lang</span>
object
jjs&gt; <span class="bold">java.lang.System</span>
[JavaClass java.lang.System]
jjs&gt; <span class="bold">typeof java.lang.System</span>
function
</code></pre><p>As you can see from the previous example, Nashorn interprets Java packages as <code class="codeph">JavaPackage</code> objects, and Java classes as <code class="codeph">JavaClass</code> function objects, which can be used as constructors for the classes. <a href="nashorn-java-api.html#GUID-5EB82F41-6871-4896-8495-6D3DA373DE13" title="To instantiate a class, pass the JavaClass function object to the new operator. Nashorn invokes the corresponding constructor based on the arguments passed to the function.">Creating Java Objects</a> describes how to instantiate a class.
                  </p>
                  <p>The traditional approach for accessing Java packages and classes is intuitive and straightforward, but at the same time, it can be inefficient, limited, and error-prone for the following reasons:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Each property access has a cost, so accessing a package or class in a deep hierarchy can be slow.</p>
                     </li>
                     <li>
                        <p>There is no special syntax for creating Java arrays. You must use the <code class="codeph">java.lang.reflect.Array</code> class as a workaround.
                        </p>
                     </li>
                     <li>
                        <p>If you misspell a class name, Nashorn assumes that you provided a package name, and interprets it as a <code class="codeph">JavaPackage</code> object instead of a <code class="codeph">JavaClass</code> function object. You might not be aware of this until an error is thrown when you attempt to use it as a class. To avoid this, use the <code class="codeph">typeof</code> operator to conditionally test that the construct you are trying to access is interpreted as a function object. The following example shows how this conditional check works:
                        </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">typeof java.lang.System == "function"</span>
true
jjs&gt; <span class="bold">typeof java.lang.Zyztem == "function"</span>
false
</code></pre></li>
                  </ul>
                  <p>To avoid the disadvantages of the approach previously described, Nashorn defines the <code class="codeph">Java</code> global object that has several functions for working with Java classes. The <code class="codeph">Java.type()</code> function takes a string with the fully qualified Java class name, and returns the corresponding <code class="codeph">JavaClass</code> function object. The following example shows how you can access the <code class="codeph">java.lang.System</code> class:
                  </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">Java.type("java.lang.System")</span>
[JavaClass java.lang.System]
</code></pre><p>Similar to importing classes in Java, it is a good practice to declare variables of <code class="codeph">JavaClass</code> type at the beginning of a script. The following example shows how you can declare the <code class="codeph">System</code> variable and give it a value of the <code class="codeph">java.lang.System</code> class:
                  </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">var System = Java.type("java.lang.System")</span>
jjs&gt; <span class="bold">System</span>
[JavaClass java.lang.System]
</code></pre></div>
            </div><a id="JSNUG115"></a><div class="props_rev_3"><a id="GUID-5EB82F41-6871-4896-8495-6D3DA373DE13" name="GUID-5EB82F41-6871-4896-8495-6D3DA373DE13"></a><h3 id="JSNUG-GUID-5EB82F41-6871-4896-8495-6D3DA373DE13" class="sect3">Creating Java Objects</h3>
               <div>
                  <p>To instantiate a class, pass the <code class="codeph">JavaClass</code> function object to the <code class="codeph">new</code> operator. Nashorn invokes the corresponding constructor based on the arguments passed to the function. 
                  </p>
                  <div class="section">
                     <p>The following example shows how you can instantiate the <code class="codeph">java.util.HashMap</code> class with the default initial capacity and with the initial capacity set to 100:
                     </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">var HashMap = Java.type("java.util.HashMap")</span>
jjs&gt; <span class="bold">var mapDef = new HashMap()</span>
jjs&gt; <span class="bold">var map100 = new HashMap(100)</span>
</code></pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="JSNUG116"></a><div class="props_rev_3"><a id="GUID-5ED04A1E-9269-463A-AFB8-7A6C365ABC9F" name="GUID-5ED04A1E-9269-463A-AFB8-7A6C365ABC9F"></a><h3 id="JSNUG-GUID-5ED04A1E-9269-463A-AFB8-7A6C365ABC9F" class="sect3">Accessing Class and Instance Members</h3>
               <div>
                  <p>You can use the standard dot notation to access static fields, methods, and inner classes as follows.</p>
                  <div class="section"><pre class="pre codeblock"><code>jjs&gt; <span class="bold">Java.type("java.lang.Math").PI</span>
3.141592653589793
jjs&gt; <span class="bold">Java.type("java.lang.System").currentTimeMillis()</span>
1375813353330
jjs&gt; <span class="bold">Java.type("java.util.Map").Entry</span>
[JavaClass java.util.Map$Entry]
</code></pre><p>An inner class can also be accessed using internal representation with the dollar sign (<code class="codeph">$</code>) as the separator, or a dot, which is consistent with Java:
                     </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">Java.type("java.util.Map$Entry")</span>
[JavaClass java.util.Map$Entry]
jjs&gt; <span class="bold">Java.type("java.util.Map.Entry")</span>
[JavaClass java.util.Map$Entry]
</code></pre><p>To invoke an instance method or access an instance field of an object, use the dot operator, similar to how it is done in Java. The following example shows how you can call the <code class="codeph">toUpperCase()</code> method on a <code class="codeph">String</code> object:
                     </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">var String = Java.type("java.lang.String")</span>
jjs&gt; <span class="bold">var str = new String("Hello")</span>
jjs&gt; str
Hello
jjs&gt; <span class="bold">var upper = str.toUpperCase()</span>
jjs&gt; <span class="bold">upper</span>
HELLO
</code></pre><p>Nashorn also supports member access using the bracket notation, where you specify the name of the member as a string between brackets (<code class="codeph">[]</code>) that immediately follow the class (in case of a static member) or object (in case of an instance member). This method is defined by the ECMAScript as an alternative to the dot notation, and is not intuitive for Java developers. However, it can be used to resolve method overload ambiguity. By default, Nashorn uses the overloaded method that best matches the arguments, and this is not always what you expect. For example, if you want to print a <code class="codeph">double</code> value, you must use the <code class="codeph">java.lang.System.out.println(double)</code> method overload, as shown in the following example:
                     </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">Java.type("java.lang.System").out.println(10)</span>
10
jjs&gt; <span class="bold">Java.type("java.lang.System").out["println(double)"](10)</span>
10.0
</code></pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="JSNUG117"></a><div class="props_rev_3"><a id="GUID-594ED1F7-993A-433F-A2AE-B1B8B12E1690" name="GUID-594ED1F7-993A-433F-A2AE-B1B8B12E1690"></a><h3 id="JSNUG-GUID-594ED1F7-993A-433F-A2AE-B1B8B12E1690" class="sect3">Using JavaBeans</h3>
               <div>
                  <p>Nashorn enables you to treat accessor and mutator methods in JavaBeans as equivalent JavaScript properties. The name of the property is the name of the JavaBean method without the <code class="codeph">get</code> or <code class="codeph">set</code> suffix, and starts with a lowecase letter.
                  </p>
                  <div class="section">
                     <p>For example you can call the <code class="codeph">getYear()</code> and <code class="codeph">setYear()</code> methods in a <code class="codeph">java.util.Date</code> object using the <code class="codeph">year</code> property as follows:
                     </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">var Date = Java.type("java.util.Date")</span>
jjs&gt; <span class="bold">var date = new Date()</span>
jjs&gt; <span class="bold">date.year + 1900</span>
2013
jjs&gt; <span class="bold">date.year = 2014 - 1900</span>
114
jjs&gt; <span class="bold">date.year + 1900</span>
2014
</code></pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="JSNUG118"></a><div class="props_rev_3"><a id="GUID-B63F085D-82E0-4B45-AC85-B0F78A213E9D" name="GUID-B63F085D-82E0-4B45-AC85-B0F78A213E9D"></a><h3 id="JSNUG-GUID-B63F085D-82E0-4B45-AC85-B0F78A213E9D" class="sect3">Working with Java Arrays</h3>
               <div>
                  <p>To access a Java array class, pass to the <code class="codeph">Java.type()</code> function the type of objects that comprise the array followed by a pair of brackets (similar to Java syntax).
                  </p>
                  <div class="section">
                     <p> The following example shows how you can access a Java array of integers and a Java array of <code class="codeph">String</code> objects:
                     </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">Java.type("int[]")</span>
[JavaClass [I]
jjs&gt; <span class="bold">Java.type("java.lang.String[]")</span>
[JavaClass [Ljava.lang.String;]
</code></pre><p>After you have the array type object, you can use it to instantiate an array as you do any other class. You can access array entries by their indexes, and use the dot or bracket notation to access members (similar to Java syntax), as shown in the following example:</p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">var IntArrayType = Java.type("int[]")</span>
jjs&gt; <span class="bold">var arr = new IntArrayType(10)</span>
jjs&gt; <span class="bold">arr[1] = 123</span>
123
jjs&gt; <span class="bold">arr[2] = 321</span>
321
jjs&gt; <span class="bold">arr[1] + arr[2]</span>
444
jjs&gt; <span class="bold">arr[10]</span>
java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 10
jjs&gt; <span class="bold">arr.length</span>
10
</code></pre><p>If you have an existing JavaScript array, you can convert it to a Java array using the <code class="codeph">Java.to()</code> function. The following example shows how you can convert a JavaScript array of strings <code class="codeph">"a"</code>, <code class="codeph">"b"</code>, and <code class="codeph">"c"</code>, to a <code class="codeph">java.lang.String[]</code> array with the same values:
                     </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">var jsArr = ["a","b","c"]</span>
jjs&gt; <span class="bold">var strArrType = Java.type("java.lang.String[]")</span>
jjs&gt; <span class="bold">var javaArr = Java.to(jsArr, strArrType)</span>
jjs&gt; <span class="bold">javaArr.class</span>
class [Ljava.lang.String;
jjs&gt; <span class="bold">javaArr[0]</span>
a
</code></pre><p>You can iterate through a Java array's indexes and values using the <code class="codeph">for</code> and <code class="codeph">for each</code> statements as follows:
                     </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">for (var i in javaArr) print(i)</span>
0
1
2
jjs&gt; <span class="bold">for each (var i in javaArr) print(i)</span>
a
b
c
</code></pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="JSNUG119"></a><div class="props_rev_3"><a id="GUID-1674531B-4008-4871-B47E-D13628616C66" name="GUID-1674531B-4008-4871-B47E-D13628616C66"></a><h3 id="JSNUG-GUID-1674531B-4008-4871-B47E-D13628616C66" class="sect3">Working with Java Strings</h3>
               <div>
                  <p>Nashorn represents strings as <code class="codeph">java.lang.String</code> objects. When you concatenate two strings, you get a <code class="codeph">String</code> instance.
                  </p>
                  <div class="section"><pre class="pre codeblock"><code>jjs&gt; <span class="bold">var a = "abc"</span>
jjs&gt; <span class="bold">a.class</span>
class java.lang.String
jjs&gt; <span class="bold">var b = a + "def"</span>
jjs&gt; <span class="bold">b.class</span>
class java.lang.String
jjs&gt; <span class="bold">var c = String(b)</span>
jjs&gt; <span class="bold">c.class</span>
class java.lang.String</code></pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="JSNUG120"></a><div class="props_rev_3"><a id="GUID-191A697D-23F8-4F73-BAAD-FCE653BECF36" name="GUID-191A697D-23F8-4F73-BAAD-FCE653BECF36"></a><h3 id="JSNUG-GUID-191A697D-23F8-4F73-BAAD-FCE653BECF36" class="sect3">Working with Java Numbers</h3>
               <div>
                  <p>Nashorn interprets numbers as <code class="codeph">java.lang.Double</code>, <code class="codeph">java.lang.Long</code>, or <code class="codeph">java.lang.Integer</code> objects, depending on the computation performed. You can use the <code class="codeph">Number()</code> function to force a number to be a <code class="codeph">Double</code> object, as shown in the following example.
                  </p>
                  <div class="section"><pre class="pre codeblock"><code>jjs&gt; <span class="bold">var intNum = 10</span>
jjs&gt; <span class="bold">intNum.class</span>
class java.lang.Integer
jjs&gt; <span class="bold">var dblNum = Number(intNum)</span>
jjs&gt; <span class="bold">dblNum.class</span>
class java.lang.Double
</code></pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="JSNUG121"></a><div class="props_rev_3"><a id="GUID-D1C84FB4-33D6-4584-843A-FD3356C4D11F" name="GUID-D1C84FB4-33D6-4584-843A-FD3356C4D11F"></a><h3 id="JSNUG-GUID-D1C84FB4-33D6-4584-843A-FD3356C4D11F" class="sect3">Working with Java Lists and Maps</h3>
               <div>
                  <p>Nashorn interprets Java lists as arrays; iterate over the values of a list with the <code class="codeph">for each</code> statement. To iterate over keys and values in a map, use the <code class="codeph">keySet()</code> and <code class="codeph">values()</code> methods.
                  </p>
                  <div class="section">
                     <p>You can access list elements by using the index in brackets (<code class="codeph">[]</code>) and iterate over the values of a list using the <code class="codeph">for each</code> statement, as shown in the following example.
                     </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">var ArrayList = Java.type("java.util.ArrayList")</span>
jjs&gt; <span class="bold">var alist = new ArrayList()</span>
jjs&gt; <span class="bold">alist.add("a")</span>
true
jjs&gt; <span class="bold">alist.add("b")</span>
true
jjs&gt; <span class="bold">alist.add("c")</span>
true
jjs&gt; <span class="bold">alist[1]</span>
b
jjs&gt; <span class="bold">for each (var i in alist) print(i)</span>
a
b
c
</code></pre><div class="infoboxnote" id="GUID-D1C84FB4-33D6-4584-843A-FD3356C4D11F__GUID-312AC634-ED0F-4BDF-9F3A-23D0A3872720">
                        <p class="notep1">Note:</p>You can only access list and map elements by using the index in brackets; in particular, you cannot access queue and set elements by using this syntax.
                     </div>
                     <p>The following example shows how you can create a <code class="codeph">HashMap</code> object and iterate over its keys and values with the <code class="codeph">keySet()</code> and <code class="codeph">values()</code> methods.
                     </p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">var HashMap = Java.type("java.util.HashMap")</span>
jjs&gt; <span class="bold">var hm = new HashMap()</span>
jjs&gt; <span class="bold">hm.put("name", "Bob")</span>
jjs&gt; <span class="bold">hm.put("age", 40)</span>
jjs&gt; <span class="bold">hm.put("weight", 180)</span>
jjs&gt; <span class="bold">for each (var i in hm.keySet()) print(i)</span>
weight
age
name
jjs&gt; <span class="bold">for each (var i in hm.values()) print(i)</span>
180
40
Bob
</code></pre><p>Alternatively, you can iterate over the values of a map the same way you iterate over the values of a list, as shown in the following example:</p><pre class="pre codeblock"><code>jjs&gt; <span class="bold">for each (var i in hm) print(i)</span>
180
40
Bob
</code></pre></div>
                  <!-- class="section" -->
               </div>
            </div><a id="JSNUG123"></a><a id="JSNUG124"></a><a id="JSNUG122"></a><div class="props_rev_3"><a id="GUID-B631F440-2320-47D7-8012-85A70A40F986" name="GUID-B631F440-2320-47D7-8012-85A70A40F986"></a><h3 id="JSNUG-GUID-B631F440-2320-47D7-8012-85A70A40F986" class="sect3">Extending Java Classes</h3>
               <div>
                  <p>You can extend a class using the <code class="codeph">Java.extend()</code> function that takes a Java type as the first argument and method implementations (in the form of JavaScript functions) as the other arguments.
                  </p>
                  <div class="section">
                     <p>The following script extends the <code class="codeph">java.lang.Runnable</code> interface and uses it to construct a new <code class="codeph">java.lang.Thread</code> object:
                     </p><pre class="pre codeblock"><code>var Run = Java.type("java.lang.Runnable");
var MyRun = Java.extend(Run, {
    run: function() {
        print("Run in separate thread");
    }
});
var Thread = Java.type("java.lang.Thread");
var th = new Thread(new MyRun());
</code></pre><p>Nashorn can automatically extend functional interfaces (see the annotation type <a href="https://docs.oracle.com/javase/10/docs/api/java/lang/FunctionalInterface.html" target="_blank"><span class="apiname">FunctionalInterface</span></a>) if you provide the function for implementing the method as the argument to the constructor. The following script extends the <code class="codeph">java.lang.Runnable</code> interface and uses it to construct a new <code class="codeph">java.lang.Thread</code> object, but it uses fewer lines of code than in <a href="nashorn-java-api.html#GUID-B631F440-2320-47D7-8012-85A70A40F986__CDEFGJBD">Example 2-1</a>, because the <code class="codeph">Java.extend()</code> function is called automatically for a functional interface.
                     </p><pre class="pre codeblock"><code>var Thread = Java.type("java.lang.Thread")
var th = new Thread(function() print("Run in a separate thread"))
</code></pre><p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/java/javase/11/nashorn&amp;id=JSJSG-GUID-B631F440-2320-47D7-8012-85A70A40F986" target="_blank">Extending Java Classes</a> in <span><cite>Java Platform, Standard Edition Java Scripting Programmer's Guide</cite></span> describes the capabilities of the <code class="codeph">Java.extend()</code> function.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-B631F440-2320-47D7-8012-85A70A40F986__CDEFGJBD">
                     <p class="titleinexample">Example 2-1 Extending a Java Class</p><pre class="pre codeblock"><code>var Run = Java.type("java.lang.Runnable");
var MyRun = Java.extend(Run, {
    run: function() {
        print("Run in separate thread");
    }
});
var Thread = Java.type("java.lang.Thread");
var th = new Thread(new MyRun());
</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-B631F440-2320-47D7-8012-85A70A40F986__CDEHEEHG">
                     <p class="titleinexample">Example 2-2 Extending a Functional Interface</p><pre class="pre codeblock"><code>var Thread = Java.type("java.lang.Thread")
var th = new Thread(function() print("Run in a separate thread"))
</code></pre></div>
                  <!-- class="example" -->
               </div>
            </div><a id="JSNUG125"></a><div class="props_rev_3"><a id="GUID-44255E9F-8FAE-4FFD-84BA-90A572AFC51B" name="GUID-44255E9F-8FAE-4FFD-84BA-90A572AFC51B"></a><h3 id="JSNUG-GUID-44255E9F-8FAE-4FFD-84BA-90A572AFC51B" class="sect3">Restricting Script Access to Specified Java Classes</h3>
               <div>
                  <p>The <code class="codeph">jdk.nashorn.api.scripting.ClassFilter</code> interface provides fine-grained control over access to Java classes from JavaScript code by restricting access to specified Java classes from scripts run by a Nashorn script engine.
                  </p>
                  <p>Applications that embed Nashorn, in particular, server-side JavaScript frameworks, often have to run scripts from untrusted sources and therefore must limit access to Java APIs. These applications can implement the <a href="https://docs.oracle.com/javase/10/docs/api/jdk/nashorn/api/scripting/ClassFilter.html" target="_blank"><span class="apiname">ClassFilter</span></a> interface to restrict Java class access to a subset of Java classes. To do so, client applications must use Nashorn APIs to instantiate the Nashorn script engine.
                  </p>
                  <div class="infoboxnote" id="GUID-44255E9F-8FAE-4FFD-84BA-90A572AFC51B__GUID-38BC71CE-A2BD-4519-85B1-0721B004B440">
                     <p class="notep1">Note:</p>While the <span class="apiname">ClassFilter</span> interface can prevent access to Java classes, it is not enough to run untrusted scripts securely. The <span class="apiname">ClassFilter</span> interface is not a replacement for a security manager. Applications should still run with a security manager before evaluating scripts from untrusted sources. Class filtering provides finer control beyond what a security manager provides. For example, an application that embeds Nashorn may prevent the spawning of threads from scripts or other resource-intensive operations that may be allowed by security manager.
                  </div>
               </div><a id="JSNUG126"></a><div class="props_rev_3"><a id="GUID-8C6BE273-E3D3-475F-B56B-14458DE9F33F" name="GUID-8C6BE273-E3D3-475F-B56B-14458DE9F33F"></a><h4 id="JSNUG-GUID-8C6BE273-E3D3-475F-B56B-14458DE9F33F" class="sect4">Using Class Filters</h4>
                  <div>
                     <p>To use a class filter, implement the <code class="codeph">ClassFilter</code> interface and define the method <code class="codeph">boolean exposeToScripts(String)</code>.
                     </p>
                     <div class="section">
                        <p>The <code class="codeph">String</code> argument is the name of the Java class or package that the Nashorn script engine encounters when it runs a script. Define the method <code class="codeph">exposeToScripts</code> such that it returns <code class="codeph">false</code> for those classes and packages you want to prevent scripts from accessing. Then, create a Nashron script engine with your class filter with the method <code class="codeph">NashornScriptEngineFactory.getScriptEngine(ClassFilter)</code> or <code class="codeph">NashornScriptEngineFactory.getScriptEngine(String[], ClassLoader, ClassFilter)</code>.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JSNUG127"></a><div class="props_rev_3"><a id="GUID-FBB32DB3-CF59-4016-B690-9581E1406594" name="GUID-FBB32DB3-CF59-4016-B690-9581E1406594"></a><h4 id="JSNUG-GUID-FBB32DB3-CF59-4016-B690-9581E1406594" class="sect4">Restricting Access to Java Reflection APIs</h4>
                  <div>
                     <p>If you are using a security manager, then Nashorn allows a script to use the Java Reflection APIs (for example, the <code class="codeph">java.lang.reflect</code> and <code class="codeph">java.lang.invoke</code> packages) only if the script has the <code class="codeph">nashorn.javaReflection</code> run time permission.
                     </p>
                     <div class="section">
                        <p>If you are using a class filter, then Nashorn prevents access to Java Reflection APIs even when a security manager is not present. Note that you do not need to use a class filter if the Java Reflection APIs are available because a script can use the <code class="codeph">Class.forName(String)</code> to circumvent the class filter.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="JSNUG129"></a><a id="JSNUG128"></a><div class="props_rev_3"><a id="GUID-AEA63402-EE9B-42B4-95E6-BACAC990C04D" name="GUID-AEA63402-EE9B-42B4-95E6-BACAC990C04D"></a><h4 id="JSNUG-GUID-AEA63402-EE9B-42B4-95E6-BACAC990C04D" class="sect4">Example of Using the ClassFilter Interface</h4>
                  <div>
                     <p>This example, <code class="codeph">MyClassFilterTest.java</code>, demonstrates the <code class="codeph">ClassFilter</code> interface. It restricts scripts’ access to the class <span class="apiname">java.io.File</span>.
                     </p>
                     <div class="section"><pre class="oac_no_warn" dir="ltr">import javax.script.ScriptEngine;
import jdk.nashorn.api.scripting.ClassFilter;
import jdk.nashorn.api.scripting.NashornScriptEngineFactory;
 
public class MyClassFilterTest {
 
  class MyCF implements ClassFilter {
    @Override
    public boolean exposeToScripts(String s) {
      if (s.compareTo("java.io.File") == 0) return false;
      return true;
    }
  }
 
  public void testClassFilter() {
 
    final String script =
      "print(java.lang.System.getProperty(\"java.home\"));" +
      "print(\"Create file variable\");" +
      "var File = Java.type(\"java.io.File\");";
 
    NashornScriptEngineFactory factory = new NashornScriptEngineFactory();
 
    ScriptEngine engine = factory.getScriptEngine(
      new MyClassFilterTest.MyCF());
    try {
      engine.eval(script);
    } catch (Exception e) {
      System.out.println("Exception caught: " + e.toString());
    }
  }
 
  public static void main(String[] args) {
    MyClassFilterTest myApp = new MyClassFilterTest();
    myApp.testClassFilter();
  }
}
</pre><p>This example prints the following:</p><pre class="oac_no_warn" dir="ltr">C:\Java\jre8
Create file variable
Exception caught: java.lang.RuntimeException: java.lang.ClassNotFoundException:
java.io.File
</pre><p>The <code class="codeph">MyClassFilterTest.java</code> example does the following:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Implements the <code class="codeph">ClassFilter</code> with the inner class <code class="codeph">MyCF</code> by defining the method <code class="codeph">exposeToScripts</code>. In this example, the method <code class="codeph">exposeToScripts</code> returns false if its <code class="codeph">String</code> argument is <code class="codeph">java.io.File</code>; otherwise it returns <code class="codeph">true</code>.</span></li>
                        <li class="stepexpand"><span>Creates a Nashorn script engine, <code class="codeph">engine</code>, with the method <code class="codeph">NashornScriptEngineFactory.getScriptEngine(ClassFilter)</code>. The example invokes <code class="codeph">getScriptEgnine</code> with an instance of <code class="codeph">MyCF</code>.</span></li>
                        <li class="stepexpand"><span>Runs the following script with the Nashorn script engine <code class="codeph">engine</code>:</span><div><pre class="oac_no_warn" dir="ltr">print(java.lang.System.getProperty(\"java.home\"));
print(\"Create file variable\");
var File = Java.type(\"java.io.File\");
</pre><p>The class filter in <code class="codeph">engine</code> checks each Java package and class in the script. When the class filter encounters the class <code class="codeph">java.io.File</code>, the class filter returns <code class="codeph">false</code>, and the <code class="codeph">Java.type</code> function throws a <code class="codeph">ClassNotFoundException</code>.
                              </p>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>
