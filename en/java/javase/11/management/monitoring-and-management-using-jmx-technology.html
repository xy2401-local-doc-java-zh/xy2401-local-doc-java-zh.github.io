<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Monitoring and Management Using JMX Technology</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Monitoring and Management Guide">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Monitoring and Management Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="java-se-monitoring-and-management-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-21T10:39:15-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2006, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E95200-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="overview-java-se-monitoring-and-management.html" title="Previous" type="text/html">
      <link rel="next" href="using-jconsole.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Java SE Monitoring and Management Guide">
    <meta name="dcterms.isVersionOf" content="MANAGEMENT">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="overview-java-se-monitoring-and-management.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="using-jconsole.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Monitoring and Management Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Monitoring and Management Using JMX Technology</li>
            </ol>
            <a id="GUID-805517EC-2D33-4D61-81D8-4D0FA770D1B8" name="GUID-805517EC-2D33-4D61-81D8-4D0FA770D1B8"></a>
            
            <h2 id="JSMGM-GUID-805517EC-2D33-4D61-81D8-4D0FA770D1B8" class="sect2"><span class="enumeration_chapter">2 </span>Monitoring and Management Using JMX Technology
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>The Java virtual machine (Java VM) has built-in instrumentation
that enables you to monitor and manage it using the Java Management
Extensions (JMX) technology. These built-in management utilities
are often referred to as <span class="variable" translate="no">out-of-the-box management</span> tools for
the Java VM. You can also monitor any appropriately instrumented
applications using the JMX API.&nbsp;
               </p>
            </div>
            <div class="sect2"><a id="GUID-586BDF8F-A98E-4C16-AAA3-387E96309686" name="GUID-586BDF8F-A98E-4C16-AAA3-387E96309686"></a><h3 id="JSMGM-GUID-586BDF8F-A98E-4C16-AAA3-387E96309686" class="sect3">Setting System Properties</h3>
               <div>
                  <p>To enable and configure the ready-to-use JMX agent so that it can monitor and manage the Java VM, you must set certain system properties when you start the Java VM. You set a system property on the command line as follows:</p><pre class="pre codeblock"><code>java -D<span class="italic">property</span>=<span class="italic">value</span> ...
</code></pre><p>You can set any number of system properties in this way. If you do not specify a value for a management property, then the property is set with its default value. See <a href="monitoring-and-management-using-jmx-technology.html#GUID-2C1922AD-4BA0-4397-A3FE-7823F42A94A3__READY-TO-USEMONITORINGANDMANAGEMENT-0CCB777F" title="Ready-to-Use Monitoring and Management Properties">Table 2-1</a> for the full set of ready-to-use management properties. You can also set system properties in a configuration file, as described in the <a href="monitoring-and-management-using-jmx-technology.html#GUID-2C1922AD-4BA0-4397-A3FE-7823F42A94A3">Ready-to-Use Monitoring and Management Properties</a> section.
                  </p>
                  <div class="p">
                     <div class="infoboxnote" id="GUID-586BDF8F-A98E-4C16-AAA3-387E96309686__GUID-E3F1AB13-A780-47BD-8337-F21D66D1690E">
                        <p class="notep1">Note:</p> To run the Java VM from the command line, you must add <code class="codeph"><span class="variable" translate="no">JRE_HOME</span>/bin</code> to your path, where <code class="codeph"><span class="variable" translate="no">JRE_HOME</span></code> is the directory containing the Java Runtime Environment (JRE) implementation. Alternatively, you can enter the full path when you enter the command.
                     </div>
                  </div>
                  <p>The syntax and the full set of command-line options supported by the Java HotSpot VMs are described in the <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/java/javase/11/management&amp;id=JSWOR-GUID-3B1CE181-CD30-4178-9602-230B800D4FAE" target="_blank">Java application launcher</a> section of <span><cite>Java Platform, Standard Edition Tools Reference</cite></span>.
                  </p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-E17343B0-FED2-4050-88D7-E4793E704ED5" name="GUID-E17343B0-FED2-4050-88D7-E4793E704ED5"></a><h3 id="JSMGM-GUID-E17343B0-FED2-4050-88D7-E4793E704ED5" class="sect3">Enabling the Ready-to-Use Management</h3>
               <div>
                  <p>To monitor a Java platform using the JMX API, you must do the following:</p>
                  <ol>
                     <li>
                        <p>Enable the JMX agent (another name for the platform MBean server) when you start the Java VM. You can enable the JMX agent for:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Local monitoring, for a client management application running on the local system.</p>
                           </li>
                           <li>
                              <p>Remote monitoring, for a client management application running on a remote system.</p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>Monitor the Java VM with a tool that complies with the JMX specification, such as JConsole. See <a href="using-jconsole.html#GUID-77416B38-7F15-4E35-B3D1-34BFD88350B5">Using JConsole</a>.
                        </p>
                     </li>
                  </ol>
               </div>
               <div class="sect3"><a id="GUID-096EA656-4D07-4B09-A493-9EDEF83ABF28" name="GUID-096EA656-4D07-4B09-A493-9EDEF83ABF28"></a><h4 id="JSMGM-GUID-096EA656-4D07-4B09-A493-9EDEF83ABF28" class="sect4">Local Monitoring and Management</h4>
                  <div>
                     <p>Earlier while starting the Java VM or Java application, you set the following property to allow the JMX client access to a local Java VM:</p><pre class="pre codeblock"><code>com.sun.management.jmxremote
</code></pre><p>Setting this property registered the Java VM platform's MBeans and published the remote method invocation (RMI) connector through a private interface. This setting allows JMX client applications to monitor a local Java platform, that is, a Java VM running on the same machine as the JMX client.</p>
                     <p>In the current Java SE platform, it is no longer necessary to set this system property. Any application that is started on the current Java SE platform supports the Attach API, and will automatically be made available for local monitoring and management when needed.</p>
                     <p>For example, previously, to enable the JMX agent for the Java SE sample application <code class="codeph">Notepad</code>, you would run the following commands:
                     </p><pre class="pre codeblock"><code>% cd <span class="variable" translate="no">JDK_HOME</span>/demo/jfc/Notepad
% java -Dcom.sun.management.jmxremote -jar Notepad.jar
</code></pre><p>In the preceding command, <code class="codeph"><span class="variable" translate="no">JDK_HOME</span></code> is the directory in which the Java Development Kit (JDK) is installed. In the current Java SE platform, you have to run the following command to start <code class="codeph">Notepad</code>.
                     </p><pre class="pre codeblock"><code>% java -jar Notepad.jar
</code></pre><p>After <code class="codeph">Notepad</code> has been started, a JMX client using the Attach API can then enable the out-of-the-box management agent to monitor and manage the <code class="codeph">Notepad</code> application.
                     </p>
                     <div class="infoboxnote" id="GUID-096EA656-4D07-4B09-A493-9EDEF83ABF28__GUID-4AAFB0B7-1160-4FB2-A549-A6BE0D4DA066">
                        <p class="notep1">Note:</p>On Windows platforms, for security reasons, local monitoring and management is supported only if your default temporary directory is on a file system that allows the setting of permissions on files and directories (for example, on a New Technology File System (NTFS) file system). It is not supported on a File Allocation Table (FAT) file system, which provides insufficient access controls.
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-6F896ED5-D517-4825-869B-BB045AF51A92" name="GUID-6F896ED5-D517-4825-869B-BB045AF51A92"></a><h5 id="JSMGM-GUID-6F896ED5-D517-4825-869B-BB045AF51A92" class="sect5">Local Monitoring and Management Using JConsole</h5>
                     <div>
                        <p>Local monitoring with JConsole is useful for development and creating prototypes. Using JConsole locally is not recommended for production environments, because JConsole itself consumes significant system resources. Rather, you should use JConsole on a remote system to isolate it from the platform being monitored.</p>
                        <p>However, if you do wish to perform local monitoring using JConsole, then you start the tool by entering <code class="codeph">jconsole</code> in a command shell. When you start <code class="codeph">jconsole</code> without any arguments, it will automatically detect all local Java applications, and display a dialog box that enables you to select the application that you want to monitor. Both JConsole and the application must by executed by the same user, because the monitoring and management system uses the operating system's file permissions.
                        </p>
                        <div class="infoboxnote" id="GUID-6F896ED5-D517-4825-869B-BB045AF51A92__GUID-E200F4D2-98BA-440B-9334-A8CB522C06DA">
                           <p class="notep1">Note:</p>To run JConsole from the command line, you must add <code class="codeph"><span class="variable" translate="no">JDK_HOME</span>/bin</code> to your path. Alternatively, you can enter the full path when you enter the command. See <a href="using-jconsole.html#GUID-77416B38-7F15-4E35-B3D1-34BFD88350B5"> Using JConsole</a>.
                        </div>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-F08985BB-629A-4FBF-A0CB-8762DF7590E0" name="GUID-F08985BB-629A-4FBF-A0CB-8762DF7590E0"></a><h4 id="JSMGM-GUID-F08985BB-629A-4FBF-A0CB-8762DF7590E0" class="sect4">Remote Monitoring and Management</h4>
                  <div>
                     <p>By default, the remote stubs for locally created remote objects that are sent to client contains the IP address of the local host in <code class="codeph">dotted-quad</code> format. For remote stubs to be associated with a specific interface address, the <code class="codeph">java.rmi.server.hostname</code> system property must be set to IP address of that interface. 
                     </p>
                     <p>To enable monitoring and management from remote systems, you must set the following system property when you start the Java VM:</p><pre class="pre codeblock"><code>com.sun.management.jmxremote.port=<span class="variable" translate="no">portNum</span>
</code></pre><div class="p">Where, <code class="codeph"><span class="variable" translate="no">portNum</span></code> is the port number to enable JMX RMI connections. Ensure that you specify an unused port number. In addition to publishing an RMI connector for local access, setting this property publishes an additional RMI connector in a private read-only registry at the specified port using the name, <code class="codeph">jmxrmi</code>. The port number to which the RMI connector will be bound using the system property: <pre class="pre codeblock"><code>com.sun.management.jmxremote.rmi.port</code></pre></div>
                     <p>Ensure to use an unused port number. </p>
                     <div class="infoboxnote" id="GUID-F08985BB-629A-4FBF-A0CB-8762DF7590E0__GUID-F8421E59-E595-44C4-9AC7-02BB6F142F50">
                        <p class="notep1">Note:</p>You must set the prior system property in addition to any properties that you might set for security.
                     </div>
                     <p>Remote monitoring and management requires security to ensure that unauthorized persons cannot control or monitor your application. Password authentication over the Secure Sockets Layer (SSL) and Transport Layer Security (TLS) is enabled by default. You can disable password authentication and SSL separately.</p>
                     <div class="infoboxnote" id="GUID-F08985BB-629A-4FBF-A0CB-8762DF7590E0__GUID-F506A7AC-3C09-4DE3-83F5-3A4AE32C5C11">
                        <p class="notep1">Note:</p>For production systems, use both <a href="monitoring-and-management-using-jmx-technology.html#GUID-7E213B43-C044-4D70-A4F4-BDA60B7E7891">SSL client certificates</a> to authenticate the client host and password authentication for user management. See <a href="monitoring-and-management-using-jmx-technology.html#GUID-FA9A0A97-6016-4283-9E9C-983C4D6F96D4">Using SSL</a> and <a href="monitoring-and-management-using-jmx-technology.html#GUID-CC2C1BC4-72BB-4C1F-B398-C48467A1F313">Using LDAP Authentication</a>.
                     </div>
                     <p>The Java platform supports pluggable <a href="https://docs.oracle.com/javase/10/docs/api/com/sun/security/auth/module/package-summary.html" target="_blank"><span class="apiname"> login modules</span></a> for authentication. You can plug in any login module depending on the authentication infrastructure in your organization. <a href="monitoring-and-management-using-jmx-technology.html#GUID-CC2C1BC4-72BB-4C1F-B398-C48467A1F313">Using LDAP Authentication</a> describes how to plug in the <a href="https://docs.oracle.com/javase/10/docs/api/com/sun/security/auth/module/LdapLoginModule.html" target="_blank"><span class="apiname"> com.sun.security.auth.module.LdapLoginModule</span></a> module for Lightweight Directory Access Protocol (LDAP)-based authentication.
                     </p>
                     <p>After you have enabled the JMX agent for remote use, you can monitor your application using JConsole, as described in <a href="monitoring-and-management-using-jmx-technology.html#GUID-EC81EB65-09FD-4179-A5FA-F1EDEB84018E">Remote Monitoring with JConsole</a>. How to connect to the management agent programmatically is described in <a href="monitoring-and-management-using-jmx-technology.html#GUID-7B962724-69BC-46AF-A46E-4A47A4E0B57A">Connecting to the JMX Agent Programmatically</a>.
                     </p>
                  </div>
                  <div class="sect4"><a id="GUID-2F341A54-B0B0-4268-BDD7-5CFAB52A6C90" name="GUID-2F341A54-B0B0-4268-BDD7-5CFAB52A6C90"></a><h5 id="JSMGM-GUID-2F341A54-B0B0-4268-BDD7-5CFAB52A6C90" class="sect5">Using Password Authentication</h5>
                     <div>
                        <p>This section details different password authentication methods that can be implemented based on the requirement. </p>
                     </div>
                     <div class="sect5"><a id="GUID-CC2C1BC4-72BB-4C1F-B398-C48467A1F313" name="GUID-CC2C1BC4-72BB-4C1F-B398-C48467A1F313"></a><h6 id="JSMGM-GUID-CC2C1BC4-72BB-4C1F-B398-C48467A1F313" class="sect6">Using LDAP Authentication</h6>
                        <div>
                           <p>The <a href="https://docs.oracle.com/javase/10/docs/api/javax/management/remote/JMXAuthenticator.html" target="_blank"><span class="apiname">JMXAuthenticator</span></a> implementation in the JMX agent is based on Java Authentication and Authorization Service (JAAS) technology. Authentication is performed by passing the user credentials to a JAAS <a href="https://docs.oracle.com/javase/10/docs/api/javax/security/auth/spi/LoginModule.html" target="_blank"><span class="apiname">javax.security.auth.spi.LoginModule</span></a> object. The <a href="https://docs.oracle.com/javase/10/docs/api/com/sun/security/auth/module/LdapLoginModule.html" target="_blank"><span class="apiname"> com.sun.security.auth.module.LdapLoginModule</span></a> class enables authentication using LDAP. You can replace the default <code class="codeph">LoginModule</code> class with the <code class="codeph">LdapLoginModule</code> class.
                           </p>
                           <p>Create a JAAS configuration file that works in the required business organization. Here is an example of a configuration file (<code class="codeph">ldap.config</code>) :
                           </p><pre class="pre codeblock"><code>ExampleCompanyConfig {
    com.sun.security.auth.module.LdapLoginModule REQUIRED
        userProvider="ldap://example-ds/ou=people,dc=examplecompany,dc=com"
        userFilter="(&amp;(uid={USERNAME})(objectClass=inetOrgPerson))"
        authzIdentity=monitorRole;
    };</code></pre><p>Here is an overview of the options mentioned in the configuration file:</p>
                           <ul style="list-style-type: disc;">
                              <li>The <code class="codeph">com.sun.security.auth.module.LdapLoginModule REQUIRED</code> option means that authentication using <code class="codeph">LdapLoginModule</code> is required for the overall authentication to be successful. 
                              </li>
                              <li>The <code class="codeph">userProvider</code> option identifies the LDAP server and the position in the directory tree where user entries are located. 
                              </li>
                              <li>The <code class="codeph">userFilter</code> option specifies the search filter to use to locate a user entry in the LDAP directory. The token <code class="codeph">{USERNAME}</code> is replaced with the user name before the filter is used to search the directory.
                              </li>
                              <li>The <code class="codeph">authzIdentity</code> option specifies the access role for authenticated users. In the example, authenticated users will have the <code class="codeph">monitorRole</code> option. See <a href="monitoring-and-management-using-jmx-technology.html#GUID-CA2FCB18-B639-4967-8E63-233E612E9D71">Access Files</a>.
                              </li>
                           </ul>
                           <p>The details of the configuration options mentioned in the code example is explained in the <a href="https://docs.oracle.com/javase/10/docs/api/com/sun/security/auth/module/LdapLoginModule.html" target="_blank"><span class="apiname"> com.sun.security.auth.module.LdapLoginModule</span></a> class.
                           </p>
                           <p>Start your application with the following properties set on the command line:</p>
                           <ul style="list-style-type: disc;">
                              <li><code class="codeph">com.sun.management.jmxremote.login.config</code>: This <a href="monitoring-and-management-using-jmx-technology.html#GUID-2C1922AD-4BA0-4397-A3FE-7823F42A94A3__COM.SUN.MANAGEMENT.JMXREMOTE.LOGIN.-0CC996DC">property</a> configures the JMX agent to use the specified JAAS configuration entry.
                              </li>
                              <li><code class="codeph">java.security.auth.login.config</code>: This property specifies the path to the JAAS configuration file.
                              </li>
                           </ul>
                           <p>Here is a sample command line:</p><pre class="pre codeblock"><code>java -Dcom.sun.management.jmxremote.port=5000
     -Dcom.sun.management.jmxremote.login.config=ExampleCompanyConfig
     -Djava.security.auth.login.config=ldap.config
     -jar MyApplication.jar
</code></pre></div>
                     </div>
                     <div class="sect5"><a id="GUID-CFC3EF23-B816-459D-9A45-0A46425FA645" name="GUID-CFC3EF23-B816-459D-9A45-0A46425FA645"></a><h6 id="JSMGM-GUID-CFC3EF23-B816-459D-9A45-0A46425FA645" class="sect6">Using File-Based Password Authentication</h6>
                        <div>
                           <p>The file-based password authentication mechanism supported by the JMX agent stores the password in clear-text and is intended only for development use. For production use, it is recommended that you use <a href="monitoring-and-management-using-jmx-technology.html#GUID-7E213B43-C044-4D70-A4F4-BDA60B7E7891">SSL client certificates</a> for authentication or plug in a secure login configuration.
                           </p>
                           <div class="infoboxnote" id="GUID-CFC3EF23-B816-459D-9A45-0A46425FA645__GUID-B0EE9BE6-E368-47EE-8AB4-8A0AD17B4692">
                              <p class="notep1">Note:</p><span class="bold">Caution </span>: A potential security issue has been identified with password authentication for remote connectors when the client obtains the remote connector from an insecure RMI registry (the default). If an attacker starts a bogus RMI registry on the target server before the legitimate registry is started, then the attacker can steal clients' passwords. This scenario includes the case where you start a Java VM with remote management enabled, using the system property <code class="codeph">com.sun.management.jmxremote.port=<span class="variable" translate="no">portNum</span></code>, even when SSL is enabled. Although such attacks are likely to be noticed, it is nevertheless a vulnerability.
                           </div>
                           <p>By default, when you enable the JMX agent for remote monitoring, it uses password authentication. However, the way you set it up depends on whether you are in a single-user environment or a multiple-user environment.</p>
                           <p>As passwords are stored in clear-text in the password file, it is not advisable to use your regular user name and password for monitoring. Instead, use the user names specified in the password file such as <code class="codeph">monitorRole</code> and <code class="codeph">controlRole</code>. See <a href="monitoring-and-management-using-jmx-technology.html#GUID-D4CBA2D6-2E24-4856-A7D8-62B3DFFB76EA">Using Password and Access Files</a>.
                           </p>
                        </div>
                        <div class="sect6"><a id="GUID-08484F70-31A5-4B87-A7DD-2BCCD2E6580D" name="GUID-08484F70-31A5-4B87-A7DD-2BCCD2E6580D"></a><h6 id="JSMGM-GUID-08484F70-31A5-4B87-A7DD-2BCCD2E6580D" class="sect6"> To Set Up a Single-User Environment</h6>
                           <div>
                              <p>You set up the password file in the <code class="codeph"><span class="variable" translate="no">JRE_HOME</span>/lib/management</code> directory as follows:
                              </p>
                              <ol>
                                 <li>Copy the password template file, <code class="codeph">jmxremote.password.template</code>, to <code class="codeph">jmxremote.password</code>.
                                 </li>
                                 <li>Set file permissions so that only the owner can read and write the password file.</li>
                                 <li>Add passwords for roles such as <code class="codeph">monitorRole</code> and <code class="codeph">controlRole.</code></li>
                              </ol>
                           </div>
                        </div>
                        <div class="sect6"><a id="GUID-D6F0189F-CC61-4132-9D36-FFE3623A7E35" name="GUID-D6F0189F-CC61-4132-9D36-FFE3623A7E35"></a><h6 id="JSMGM-GUID-D6F0189F-CC61-4132-9D36-FFE3623A7E35" class="sect6"> To Set Up a Multiple-User Environment</h6>
                           <div>
                              <p>You set up the password file in the <code class="codeph"><span class="variable" translate="no">JRE_HOME</span>/lib/management</code> directory as follows:
                              </p>
                              <ol>
                                 <li>Copy the password template file, <code class="codeph">jmxremote.password.template</code>, to your home directory and rename it to <code class="codeph">jmxremote.password</code>.
                                 </li>
                                 <li>Set file permissions so that only you can read and write the password file.</li>
                                 <li>Add passwords for the roles such as <code class="codeph">monitorRole</code> and <code class="codeph">controlRole</code>.
                                 </li>
                                 <li>Set the following system property when you start the Java VM.<pre class="pre codeblock"><code>com.sun.management.jmxremote.password.file=<span class="variable" translate="no">pwFilePath</span></code></pre><p>In the preceding property, <code class="codeph"><span class="variable" translate="no">pwFilePath</span></code> is the path to the password file.
                                    </p>
                                 </li>
                              </ol>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-9ED79A3B-B710-4B89-A64D-5C566A160A95" name="GUID-9ED79A3B-B710-4B89-A64D-5C566A160A95"></a><h5 id="JSMGM-GUID-9ED79A3B-B710-4B89-A64D-5C566A160A95" class="sect5">Disabling Password Authentication</h5>
                     <div>
                        <p>Password authentication for remote monitoring is enabled by default. To disable it, set the following system property when you start the Java VM:</p><pre class="pre codeblock"><code>com.sun.management.jmxremote.authenticate=false
</code></pre><div class="p">
                           <div class="infoboxnote" id="GUID-9ED79A3B-B710-4B89-A64D-5C566A160A95__GUID-23AC8DEA-38B0-4B7E-BBDC-BE9EAEB3A567">
                              <p class="notep1">Note:</p><span class="bold">Caution </span>: This configuration is insecure. Any remote user who knows (or guesses) your JMX port number and host name will be able to monitor and control your Java application and platform. While it may be acceptable for development, it is not recommended for production systems.
                           </div>
                        </div>
                        <p>When you disable password authentication, you can also disable SSL, as described in <a href="monitoring-and-management-using-jmx-technology.html#GUID-D0720E6F-4AC6-4C37-91C9-40069C0304AB">Disabling Security</a>. You can also disable passwords, but use SSL client authentication, as described in <a href="monitoring-and-management-using-jmx-technology.html#GUID-7E213B43-C044-4D70-A4F4-BDA60B7E7891">Enabling SSL Client Authentication</a>.
                        </p>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-FA9A0A97-6016-4283-9E9C-983C4D6F96D4" name="GUID-FA9A0A97-6016-4283-9E9C-983C4D6F96D4"></a><h5 id="JSMGM-GUID-FA9A0A97-6016-4283-9E9C-983C4D6F96D4" class="sect5">Using SSL</h5>
                     <div>
                        <p>SSL is enabled by default when you enable remote monitoring and management. To use SSL, you need to set up a digital certificate on the system where the JMX agent (the MBean server) is running and then configure SSL properly. You use the command-line utility <code class="codeph">keytool</code> to work with certificates. 
                        </p>
                        <p>The general procedure to set up SSL is as follows:</p>
                        <ol>
                           <li>If you do not have a key pair and certificate set up on the server, then perform the following tasks:
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Generate a key pair with the <code class="codeph">keytool -genkey</code> command.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Request a signed certificate from a certificate authority (CA) with the <code class="codeph">keytool -certreq</code> command.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Import the certificate into your keystore with the <code class="codeph">keytool -import</code> command. See the <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/java/javase/11/management&amp;id=JSWOR-GUID-5990A2E4-78E3-47B7-AE75-6D1826259549#GUID-5990A2E4-78E3-47B7-AE75-6D1826259549/KEYTOOL_OPTION_IMPORTCERT" target="_blank">Importing Certificates</a> in <code class="codeph">keytool</code> documentation. 
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>Configure SSL on the server system. Complete explanation of configuring and customizing SSL is beyond the scope of this document, but you generally need to set the system properties as described in the following list: 
                              <table cellpadding="4" cellspacing="0" summary frame="hsides" border="1" rules="rows" id="GUID-FA9A0A97-6016-4283-9E9C-983C4D6F96D4__SYSTEMPROPERTYDESCRIPTION-A6D1752A" role="presentation">
                                 <tr>
                                    <td valign="top"><code class="codeph">javax.net.ssl.keyStore</code></td>
                                    <td valign="top">
                                       <p>Keystore location</p>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td valign="top"><code class="codeph">javax.net.ssl.keyStoreType</code></td>
                                    <td valign="top">
                                       <p>Default keystore type</p>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td valign="top"><code class="codeph">javax.net.ssl.keyStorePassword</code></td>
                                    <td valign="top">
                                       <p>Default keystore password</p>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td valign="top"><code class="codeph">javax.net.ssl.trustStore</code></td>
                                    <td valign="top">
                                       <p>Truststore location</p>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td valign="top"><code class="codeph">javax.net.ssl.trustStoreType</code></td>
                                    <td valign="top">
                                       <p>Default truststore type</p>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td valign="top"><code class="codeph">javax.net.ssl.trustStorePassword</code></td>
                                    <td valign="top">
                                       <p>Default truststore password</p>
                                    </td>
                                 </tr>
                              </table>
                              <p>Setting system properties is detailed in the <a href="monitoring-and-management-using-jmx-technology.html#GUID-586BDF8F-A98E-4C16-AAA3-387E96309686">Setting System Properties</a> section.
                              </p>
                              <p>See:</p>
                              <ul style="list-style-type: disc;">
                                 <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/java/javase/11/management&amp;id=JSWOR-GUID-5990A2E4-78E3-47B7-AE75-6D1826259549" target="_blank">keytool - Key and Certificate Management Tool</a> in the<span><cite>Java Platform, Standard Edition Tools Reference</cite></span> 
                                 </li>
                                 <li>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/java/javase/11/management&amp;id=JSSEC-GUID-7D9F43B8-AABF-4C5B-93E6-3AFB18B66150" target="_blank">Customizing the Default Keystores and Truststores, Store Types, and Store Passwords</a> in <span><cite>Java Platform, Standard Edition Security Developer's Guide</cite></span></p>
                                 </li>
                              </ul>
                           </li>
                        </ol>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-BA10AD87-78E8-4248-B648-D02284D21626" name="GUID-BA10AD87-78E8-4248-B648-D02284D21626"></a><h5 id="JSMGM-GUID-BA10AD87-78E8-4248-B648-D02284D21626" class="sect5">Enabling RMI Registry Authentication</h5>
                     <div>
                        <p>When setting up connections for monitoring remote applications, you can optionally bind the RMI connector stub to an RMI registry that is protected by SSL. This allows clients with the appropriate SSL certificates to get the connector stub that is registered in the RMI registry. To protect the RMI registry using SSL, you must set the following system property:</p><pre class="pre codeblock"><code>com.sun.management.jmxremote.registry.ssl=true
</code></pre><p>When this property is set to <code class="codeph">true</code>, an RMI registry protected by SSL will be created and configured by the ready-to-use management agent when the Java VM is started. The default value of this property is <code class="codeph">false</code>. However, it is recommended that you set this property to <code class="codeph">true</code>. If this property is set to <code class="codeph">true</code>, then to have full security, you must also enable SSL client authentication.
                        </p>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-7E213B43-C044-4D70-A4F4-BDA60B7E7891" name="GUID-7E213B43-C044-4D70-A4F4-BDA60B7E7891"></a><h5 id="JSMGM-GUID-7E213B43-C044-4D70-A4F4-BDA60B7E7891" class="sect5">Enabling SSL Client Authentication</h5>
                     <div>
                        <p>To enable SSL client authentication, set the following system property when you start the Java VM:</p><pre class="pre codeblock"><code>com.sun.management.jmxremote.ssl.need.client.auth=true
</code></pre><p>SSL must be enabled (default is set to <code class="codeph">false</code>) to use client SSL authentication. It is recommended that you set this property to <code class="codeph">true</code>. This configuration requires that the client system have a valid digital certificate. You must install a certificate and configure SSL on the client system, as described in <a href="monitoring-and-management-using-jmx-technology.html#GUID-FA9A0A97-6016-4283-9E9C-983C4D6F96D4">Using SSL</a>. As stated in the previous section, if RMI registry SSL protection is enabled, then client SSL authentication must be set to <code class="codeph">true</code>.
                        </p>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-7F4C3AD0-D054-4ABF-9DB2-C39D8E6AFCB8" name="GUID-7F4C3AD0-D054-4ABF-9DB2-C39D8E6AFCB8"></a><h5 id="JSMGM-GUID-7F4C3AD0-D054-4ABF-9DB2-C39D8E6AFCB8" class="sect5">Disabling SSL</h5>
                     <div>
                        <p>To disable SSL when monitoring remotely, you must set the following system property when you start the Java VM:</p><pre class="pre codeblock"><code>com.sun.management.jmxremote.ssl=false
</code></pre><p>Password authentication will still be required unless you disable it, as specified in <a href="monitoring-and-management-using-jmx-technology.html#GUID-9ED79A3B-B710-4B89-A64D-5C566A160A95">Disabling Password Authentication</a>.
                        </p>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-D0720E6F-4AC6-4C37-91C9-40069C0304AB" name="GUID-D0720E6F-4AC6-4C37-91C9-40069C0304AB"></a><h5 id="JSMGM-GUID-D0720E6F-4AC6-4C37-91C9-40069C0304AB" class="sect5">Disabling Security</h5>
                     <div>
                        <p>To disable both password authentication and SSL (namely to disable <span class="bold">all</span> security), you should set the following system properties when you start the Java VM:
                        </p><pre class="pre codeblock"><code>com.sun.management.jmxremote.authenticate=false
com.sun.management.jmxremote.ssl=false
</code></pre><div class="infoboxnote" id="GUID-D0720E6F-4AC6-4C37-91C9-40069C0304AB__GUID-2D7859AB-2CE6-4F16-8969-CA97B53A8494">
                           <p class="notep1">Note:</p><span class="bold">Caution </span>: This configuration is insecure; any remote user who knows (or guesses) your port number and host name will be able to monitor and control your Java applications and platform. Furthermore, possible harm is not limited to the operations that you define in your MBeans. A remote client could create a <code class="codeph">javax.management.loading.MLet</code> MBean and use it to create new MBeans from arbitrary URLs, at least if there is no security manager. In other words, a remote client can make your Java application execute arbitrary code.
                        </div>
                        <p></p>
                        <p>Consequently, while disabling security might be acceptable for development, it is strongly recommended that you do not disable security for production systems.</p>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-EC81EB65-09FD-4179-A5FA-F1EDEB84018E" name="GUID-EC81EB65-09FD-4179-A5FA-F1EDEB84018E"></a><h5 id="JSMGM-GUID-EC81EB65-09FD-4179-A5FA-F1EDEB84018E" class="sect5">Remote Monitoring with JConsole</h5>
                     <div>
                        <p>You can remotely monitor an application using JConsole, with or
without security enabled.</p>
                     </div>
                  </div>
                  <div class="sect4"><a id="GUID-8CF90313-3A12-45BD-93C1-3495139D0457" name="GUID-8CF90313-3A12-45BD-93C1-3495139D0457"></a><h5 id="JSMGM-GUID-8CF90313-3A12-45BD-93C1-3495139D0457" class="sect5">Remote Monitoring with JConsole with SSL Enabled</h5>
                     <div>
                        <p>To monitor a remote application with SSL enabled, you need to set up the <code class="codeph">truststore</code> file on the system where JConsole is running and configure SSL properly. For example, you can create a <code class="codeph">keystore</code> file and start your application (called <code class="codeph">Server</code> in this example) with the following commands:
                        </p><pre class="pre codeblock"><code>% java -Djavax.net.ssl.keyStore=keystore \
  -Djavax.net.ssl.keyStorePassword=password Server
</code></pre><p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/java/javase/11/management&amp;id=JSSEC-GUID-7D9F43B8-AABF-4C5B-93E6-3AFB18B66150" target="_blank">Customizing the Default Keystores and Truststores, Store Types, and Store Passwords</a> in the <span><cite>Java Platform, Standard Edition Security Developer's Guide</cite></span>.
                        </p>
                        <p>If you create the <code class="codeph">keystore</code> file and start the <code class="codeph">Server</code> applicaton, then start JConsole as follows:
                        </p><pre class="pre codeblock"><code>% jconsole -J-Djavax.net.ssl.trustStore=truststore \
  -J-Djavax.net.ssl.trustStorePassword=trustword
</code></pre><p>See <a href="using-jconsole.html#GUID-77416B38-7F15-4E35-B3D1-34BFD88350B5">Using JConsole</a>.
                        </p>
                        <p>The configuration authenticates the server only. If SSL client authentication is set up, then you need to provide a similar <code class="codeph">keystore</code> file for JConsole's keys and an appropriate <code class="codeph">truststore</code> file for the application.
                        </p>
                     </div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-D4CBA2D6-2E24-4856-A7D8-62B3DFFB76EA" name="GUID-D4CBA2D6-2E24-4856-A7D8-62B3DFFB76EA"></a><h4 id="JSMGM-GUID-D4CBA2D6-2E24-4856-A7D8-62B3DFFB76EA" class="sect4">Using Password and Access Files</h4>
                  <div>
                     <p>The password and access files control security for remote monitoring and management. These files are located by default in <code class="codeph"><span class="variable" translate="no">JRE_HOME</span>/lib/management</code> and are in the standard Java properties file format. For more information on the format, see the API reference for the <a href="https://docs.oracle.com/javase/10/docs/api/java/util/logging/package-summary.html" target="_blank"><span class="apiname">java.util.Properties</span></a> package.
                     </p>
                  </div>
                  <div class="sect4"><a id="GUID-979A49B7-B9E7-4E4E-B80C-421B636D06FA" name="GUID-979A49B7-B9E7-4E4E-B80C-421B636D06FA"></a><h5 id="JSMGM-GUID-979A49B7-B9E7-4E4E-B80C-421B636D06FA" class="sect5">Password Files</h5>
                     <div>
                        <p>The password file defines the different roles and their passwords. The access control file (<code class="codeph">jmxremote.access</code> by default) defines the permitted access for each role. To be functional, a role must have an entry in both the password and the access files.
                        </p>
                        <p>The JRE implementation contains a password file template named <code class="codeph">jmxremote.password.template</code>. Copy this file to <code class="codeph"><span class="codeinlineitalic">jre_home</span>/lib/management/jmxremote.password</code> in to your home directory and add the passwords for the roles defined in the access file.
                        </p>
                        <p>You must ensure that only the owner has read and write permissions on this file, because it contains the passwords in clear-text. For security reasons, the system checks that the file is readable only by the owner and exits with an error if it is not. Thus in a multiple-user environment, you should store the password file in a private location such as your home directory.</p>
                        <p>Property names are roles, and the associated value is the role's password. <a href="monitoring-and-management-using-jmx-technology.html#GUID-979A49B7-B9E7-4E4E-B80C-421B636D06FA__EXAMPLE2-1ANEXAMPLEPASSWORDFILE-EF5F1655">Example 2&#x2013;1</a> shows sample entries in the password file.
                        </p>
                        <p id="GUID-979A49B7-B9E7-4E4E-B80C-421B636D06FA__EXAMPLE2-1ANEXAMPLEPASSWORDFILE-EF5F1655">Example&nbsp;2-1 An Example Password File </p><pre class="pre codeblock"><code># specify actual password instead of the text <span class="italic">password</span>
monitorRole <span class="italic">password</span>
controlRole <span class="italic">password</span>
</code></pre><p>On Solaris, Linux, or macOS operating systems, you can set the file permissions for the password file by running the following command:</p><pre class="pre codeblock"><code>chmod 600 jmxremote.password
</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-CA2FCB18-B639-4967-8E63-233E612E9D71" name="GUID-CA2FCB18-B639-4967-8E63-233E612E9D71"></a><h5 id="JSMGM-GUID-CA2FCB18-B639-4967-8E63-233E612E9D71" class="sect5">Access Files</h5>
                     <div>
                        <p>By default, the access file is named <code class="codeph">jmxremote.access</code>. Property names are identities from the same space as the password file. The associated value must either be <code class="codeph">readonly</code> or <code class="codeph">readwrite</code>.
                        </p>
                        <p>The access file defines roles and their access levels. By default, the access file defines the following primary roles:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">monitorRole</code>, which grants read-only access for monitoring.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">controlRole</code>, which grants read/write access for monitoring and management.
                              </p>
                           </li>
                        </ul>
                        <div class="p">An access control entry consists of a role name and an associated access level. The role name cannot contain spaces or tabs and must correspond to an entry in the password file. The access level can be either one of the following:
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">readonly</code>: Grants access to read the MBean's attributes. For monitoring, this means that a remote client in this role can read measurements but cannot perform any action that changes the environment of the running program. The remote client can also listen to MBean notifications.
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">readwrite</code>: Grants access to read and write the MBean's attributes, to call operations on them, and to create or remove them. This access should be granted only to trusted clients, because they can potentially interfere with the operation of an application.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <p>A role should have only one entry in the access file. If a role has no entry, then it has no access. If a role has multiple entries, then the last entry takes precedence. Typical predefined roles in the access file resemble what is shown in the <a href="monitoring-and-management-using-jmx-technology.html#GUID-CA2FCB18-B639-4967-8E63-233E612E9D71__EXAMPLE2-2ANEXAMPLEACCESSFILE-EF680AED">Example 2-2</a>. 
                        </p>
                        <p id="GUID-CA2FCB18-B639-4967-8E63-233E612E9D71__EXAMPLE2-2ANEXAMPLEACCESSFILE-EF680AED">Example&nbsp;2-2 An Example Access File </p><pre class="pre codeblock"><code># The "monitorRole" role has readonly access.
# The "controlRole" role has readwrite access.
monitorRole readonly
controlRole readwrite
</code></pre></div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-3A4EFD73-E420-45E6-BF3D-277B496CD1E9" name="GUID-3A4EFD73-E420-45E6-BF3D-277B496CD1E9"></a><h3 id="JSMGM-GUID-3A4EFD73-E420-45E6-BF3D-277B496CD1E9" class="sect3">Remote Monitoring with JConsole with SSL Disabled</h3>
               <div>
                  <p>To monitor a remote application with SSL disabled, start the JConsole with the following command:</p><pre class="pre codeblock"><code>% jconsole hostName:portNum
</code></pre><p>You can also omit the host name and port number, and enter them in the dialog box that JConsole provides.</p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-2C1922AD-4BA0-4397-A3FE-7823F42A94A3" name="GUID-2C1922AD-4BA0-4397-A3FE-7823F42A94A3"></a><h3 id="JSMGM-GUID-2C1922AD-4BA0-4397-A3FE-7823F42A94A3" class="sect3">Ready-to-Use Monitoring and Management Properties</h3>
               <div>
                  <p>You can set ready-to-use monitoring and management properties in a configuration file or on the command line. Properties specified on the command line override properties in a configuration file. The default location for the configuration file is <code class="codeph"><span class="codeinlineitalic">jre_home</span>/lib/management/management.properties</code>. The Java VM reads this file if either of the command-line properties is set:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">com.sun.management.jmxremote</code></p> or 
                     </li>
                     <li>
                        <p><code class="codeph">com.sun.management.jmxremote.port</code></p>
                     </li>
                  </ul>
                  <p>You can specify a different location for the configuration file with the following command-line option:</p><pre class="pre codeblock"><code>com.sun.management.config.file=<span class="variable" translate="no">ConfigFilePath</span>
</code></pre><p><code class="codeph"><span class="variable" translate="no">ConfigFilePath</span></code> is the path to the configuration file.
                  </p>
                  <p><a href="monitoring-and-management-using-jmx-technology.html#GUID-2C1922AD-4BA0-4397-A3FE-7823F42A94A3__READY-TO-USEMONITORINGANDMANAGEMENT-0CCB777F" title="Ready-to-Use Monitoring and Management Properties">Table 2-1</a> describes the ready-to-use monitoring and management properties.
                  </p>
                  <div class="tblformal" id="GUID-2C1922AD-4BA0-4397-A3FE-7823F42A94A3__READY-TO-USEMONITORINGANDMANAGEMENT-0CCB777F">
                     <p class="titleintable">Table 2-1 Ready-to-Use Monitoring and Management Properties</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Ready-to-Use Monitoring and Management Properties" summary="Ready-to-Use Monitoring and Management Properties" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th rowspan="1" colspan="1" align="left" valign="bottom" id="d2824e1143">Property</th>
                              <th rowspan="1" colspan="1" align="left" valign="bottom" id="d2824e1146">Description</th>
                              <th rowspan="1" colspan="1" align="left" valign="bottom" id="d2824e1149">Values</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td rowspan="1" colspan="1" align="left" valign="top" id="d2824e1154" headers="d2824e1143 ">
                                 <p><code class="codeph">com.sun.management.jmxremote</code></p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1154 d2824e1146 ">
                                 <p>Enables the JMX remote agent and local monitoring using a JMX connector. This agent is published on a private interface that is used by JConsole and any other local JMX clients, which use the Attach API. JConsole can use this connector if it is started by the same user who started the agent. No password or access files are checked for requests coming from this connector.</p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1154 d2824e1149 ">
                                 <p><code class="codeph">true</code> / <code class="codeph">false</code>. Default is <code class="codeph">true</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td rowspan="1" colspan="1" align="left" valign="top" id="d2824e1173" headers="d2824e1143 ">
                                 <p><code class="codeph">com.sun.management.jmxremote.port</code></p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1173 d2824e1146 ">
                                 <p>Enables the JMX remote agent and creates a remote JMX connector to listen through the specified port. By default, the SSL, password, and access file properties are used for this connector. It also enables local monitoring as described for the <code class="codeph">com.sun.management.jmxremote</code> property.
                                 </p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1173 d2824e1149 ">
                                 <p>Port number. No default.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td rowspan="1" colspan="1" align="left" valign="top" id="d2824e1187" headers="d2824e1143 ">
                                 <p><code class="codeph">com.sun.management.jmxremote.registry.ssl</code></p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1187 d2824e1146 ">
                                 <p>Binds the RMI connector stub to an RMI registry that is protected by SSL.</p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1187 d2824e1149 ">
                                 <p><code class="codeph">true</code> / <code class="codeph">false</code>. Default is <code class="codeph">false</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td rowspan="1" colspan="1" align="left" valign="top" id="d2824e1206" headers="d2824e1143 ">
                                 <p><code class="codeph">com.sun.management.jmxremote.ssl</code></p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1206 d2824e1146 ">
                                 <p>Enables secure monitoring using SSL. If the value is <code class="codeph">false</code>, then SSL is not used.
                                 </p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1206 d2824e1149 ">
                                 <p><code class="codeph">true</code> / <code class="codeph">false</code>. Default is <code class="codeph">true</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td rowspan="1" colspan="1" align="left" valign="top" id="d2824e1228" headers="d2824e1143 ">
                                 <p><code class="codeph">com.sun.management.jmxremote.ssl.enabled.protocols</code></p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1228 d2824e1146 ">
                                 <p>Shows a comma-delimited list of SSL/TLS protocol versions to enable. Used in conjunction with <code class="codeph">com.sun.management.jmxremote.ssl</code>.
                                 </p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1228 d2824e1149 ">
                                 <p>Default SSL/TLS protocol version.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td rowspan="1" colspan="1" align="left" valign="top" id="d2824e1242" headers="d2824e1143 ">
                                 <p><code class="codeph">com.sun.management.jmxremote.ssl.enabled.cipher.suites</code></p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1242 d2824e1146 ">
                                 <p>Shows a comma-delimited list of SSL/TLS cipher suites to enable. Used in conjunction with <code class="codeph">com.sun.management.jmxremote.ssl</code>.
                                 </p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1242 d2824e1149 ">
                                 <p>Default SSL/TLS cipher suites.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td rowspan="1" colspan="1" align="left" valign="top" id="d2824e1256" headers="d2824e1143 ">
                                 <p><code class="codeph">com.sun.management.jmxremote.ssl.need.client.auth</code></p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1256 d2824e1146 ">
                                 <p>Performs client authentication if this property is <code class="codeph">true</code> and the property <code class="codeph">com.sun.management.jmxremote.ssl</code> is also <code class="codeph">true</code>. 
                                 </p>
                                 <p>It is recommended that you set this property to <code class="codeph">true</code>.
                                 </p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1256 d2824e1149 ">
                                 <p><code class="codeph">true</code> / <code class="codeph">false</code>. Default is <code class="codeph">false</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td rowspan="1" colspan="1" align="left" valign="top" id="d2824e1289" headers="d2824e1143 ">
                                 <p><code class="codeph">com.sun.management.jmxremote.authenticate</code></p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1289 d2824e1146 ">
                                 <p>Prevents JMX from using password or access files if this property is <code class="codeph">false</code>. All users are provided complete access.
                                 </p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1289 d2824e1149 ">
                                 <p><code class="codeph">true</code> / <code class="codeph">false</code>. Default is <code class="codeph">true</code>.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td rowspan="1" colspan="1" align="left" valign="top" id="d2824e1311" headers="d2824e1143 ">
                                 <p><code class="codeph">com.sun.management.jmxremote. password.file</code></p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1311 d2824e1146 ">
                                 <p>Specifies the location for the password file. If <code class="codeph">com.sun.management.jmxremote.authenticate</code> is <code class="codeph">false</code>, then this property, and the password and access files are ignored. Otherwise, the password file must exist and be in the valid format. If the password file is empty or nonexistent, then no access is allowed.
                                 </p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1311 d2824e1149 ">
                                 <p><code class="codeph"><span class="variable" translate="no">JRE_HOME</span>/lib/management/ jmxremote.password</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td rowspan="1" colspan="1" align="left" valign="top" id="d2824e1331" headers="d2824e1143 ">
                                 <p><code class="codeph">com.sun.management.jmxremote.access.file</code></p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1331 d2824e1146 ">
                                 <p>Specifies the location for the access file. If <code class="codeph">com.sun.management.jmxremote.authenticate</code> is false, then this property, and the password and access files, are ignored. Otherwise, the access file must exist and be in the valid format. If the access file is empty or nonexistent, then no access is allowed.
                                 </p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1331 d2824e1149 ">
                                 <p><code class="codeph"><span class="variable" translate="no">JRE_HOME</span>/lib/management/jmxremote.access</code></p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td id="d2824e1348" rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1143 ">
                                 <p id="GUID-2C1922AD-4BA0-4397-A3FE-7823F42A94A3__COM.SUN.MANAGEMENT.JMXREMOTE.LOGIN.-0CC996DC"><code class="codeph">com.sun.management.jmxremote.login.config</code></p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1348 d2824e1146 ">
                                 <p>Specifies the name of a Java Authentication and Authorization Service (JAAS) login configuration entry to use when the JMX agent authenticates users. When using this property to override the default login configuration, the named configuration entry must be in a file that is loaded by JAAS. In addition, the login modules specified in the configuration should use the name and password callbacks to acquire the user's credentials. For more information, see the API documentation for <code class="codeph">javax.security.auth.callback.NameCallback</code> and <code class="codeph">javax.security.auth.callback.PasswordCallback</code>.
                                 </p>
                              </td>
                              <td rowspan="1" colspan="1" align="left" valign="top" headers="d2824e1348 d2824e1149 ">
                                 <p>Default login configuration is a file-based password authentication.</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <div class="sect3"><a id="GUID-1C798094-1CC3-4804-B4F2-0DCF2E0030CF" name="GUID-1C798094-1CC3-4804-B4F2-0DCF2E0030CF"></a><h4 id="JSMGM-GUID-1C798094-1CC3-4804-B4F2-0DCF2E0030CF" class="sect4">Configuration Errors</h4>
                  <div>
                     <p>If any errors occur during the start up of the MBean server, the RMI registry, or the connector, then the Java VM will throw an exception and exit. Configuration errors include the following:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Failure to bind to the port number</p>
                        </li>
                        <li>
                           <p>Invalid password file</p>
                        </li>
                        <li>
                           <p>Invalid access file</p>
                        </li>
                        <li>
                           <p>Password file is readable by users other than the owner</p>
                        </li>
                     </ul>
                     <p>If your application runs a security manager, then additional permissions are required in the security permissions file.</p>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-7B962724-69BC-46AF-A46E-4A47A4E0B57A" name="GUID-7B962724-69BC-46AF-A46E-4A47A4E0B57A"></a><h3 id="JSMGM-GUID-7B962724-69BC-46AF-A46E-4A47A4E0B57A" class="sect3">Connecting to the JMX Agent Programmatically</h3>
               <div>
                  <p>After you have enabled the JMX agent, a client can use the following URL to access the monitoring service:</p><pre class="pre codeblock"><code>service:jmx:rmi:///jndi/rmi://<span class="variable" translate="no">hostName</span>:<span class="variable" translate="no">portNum</span>/jmxrmi
</code></pre><p>A client can create a connector for the agent by instantiating a <code class="codeph">javax.management.remote.JMXServiceURL</code> object using the URL, and then creating a connection using the <code class="codeph">JMXConnectorFactory.connect</code> method, as shown in the <a href="monitoring-and-management-using-jmx-technology.html#GUID-7B962724-69BC-46AF-A46E-4A47A4E0B57A__EXAMPLE2-3CREATINGACONNECTIONUSING-8F09E0B4">Example&nbsp;2-3</a>.
                  </p>
                  <p id="GUID-7B962724-69BC-46AF-A46E-4A47A4E0B57A__EXAMPLE2-3CREATINGACONNECTIONUSING-8F09E0B4">Example&nbsp;2-3 Creating a Connection Using JMXConnectorFactory.connect </p><pre class="pre codeblock"><code>JMXServiceURL u = new JMXServiceURL(
  "service:jmx:rmi:///jndi/rmi://" + hostName + ":" + portNum +  "/jmxrmi");
  JMXConnector c = JMXConnectorFactory.connect(u); 
</code></pre></div>
            </div>
            <div class="sect2"><a id="GUID-20C7215D-ED29-4939-B026-FAA01EC65765" name="GUID-20C7215D-ED29-4939-B026-FAA01EC65765"></a><h3 id="JSMGM-GUID-20C7215D-ED29-4939-B026-FAA01EC65765" class="sect3">Setting Up Monitoring and Management Programmatically</h3>
               <div>
                  <p>You can create a JMX client that uses the <a href="https://docs.oracle.com/javase/10/docs/api/com/sun/tools/attach/package-summary.html" target="_blank"> Attach API</a> to enable ready-to-use monitoring and management of any applications that are started on the Java SE 10 platform, without having to configure the applications for monitoring when you start them. The Attach API provides a way for tools to attach to and start agents in the target application. After an agent is running, JMX clients (and other tools) are able to obtain the JMX connector address for that agent using a property list that is maintained by the Java VM on behalf of the agents. The properties in the list are accessible from tools that use the Attach API. So, if an agent is started in an application, and if the agent creates a property to represent a piece of configuration information, then that configuration information is available to tools that attach to the application.
                  </p>
                  <p>The JMX agent creates a property with the address of the local JMX connector server. This allows JMX tools to attach to and get the connector address of an agent, if it is running.</p>
                  <p><a href="monitoring-and-management-using-jmx-technology.html#GUID-20C7215D-ED29-4939-B026-FAA01EC65765__EXAMPLE2-4ATTACHINGAJMXTOOLTOACONNE-8F09610A">Example&nbsp;2-4</a> shows code that could be used in a JMX tool to attach to a target VM, get the connector address of the JMX agent and connect to it.
                  </p>
                  <p id="GUID-20C7215D-ED29-4939-B026-FAA01EC65765__EXAMPLE2-4ATTACHINGAJMXTOOLTOACONNE-8F09610A">Example&nbsp;2-4 Attaching a JMX Tool To A Connector And Getting the Agent's Address </p><pre class="pre codeblock"><code>static final String CONNECTOR_ADDRESS =
"com.sun.management.jmxremote.localConnectorAddress";

// attach to the target application
VirtualMachine vm = VirtualMachine.attach(id);

// get the connector address
String connectorAddress =
    vm.getAgentProperties().getProperty(CONNECTOR_ADDRESS);

// no connector address, so we start the JMX agent
if (connectorAddress == null) {
     vm.startLocalManagementAgent();

   // agent is started, get the connector address
   connectorAddress =
       vm.getAgentProperties().getProperty(CONNECTOR_ADDRESS);
}
// establish connection to connector server
JMXServiceURL url = new JMXServiceURL(connectorAddress);
JMXConnector jmxConnector = JMXConnectorFactory.connect(url);
</code></pre><p><a href="monitoring-and-management-using-jmx-technology.html#GUID-20C7215D-ED29-4939-B026-FAA01EC65765__EXAMPLE2-4ATTACHINGAJMXTOOLTOACONNE-8F09610A">Example&nbsp;2-4</a> uses the <code class="codeph">com.sun.tools.attach.VirtualMachine</code> class's <code class="codeph">attach()</code> method to attach to a given Java VM so that it can read the properties that the target Java VM maintains on behalf of any agents running in it. If an agent is already running, then the <code class="codeph">VirtualMachine</code> class's <code class="codeph">getAgentProperties()</code> method is called to obtain the agent's address. The <code class="codeph">getAgentProperties()</code> method returns a string property for the local connector address <code class="codeph">com.sun.management.jmxremote.localConnectorAddress</code>, which you can use to connect to the local JMX agent.
                  </p>
                  <p>If no agent is running, then one is loaded by the <code class="codeph">VirtualMachine</code> class from <code class="codeph"><span class="codeinlineitalic">jre_home</span>/lib/management-agent.jar</code>, and its connector address is obtained by the <code class="codeph">getAgentProperties()</code> method.
                  </p>
                  <p>A connection to the agent is then established by calling <code class="codeph">JMXConnectorFactory.connect</code> on a JMX service URL that has been constructed from this connector address.
                  </p>
                  <div class="infoboxnote" id="GUID-20C7215D-ED29-4939-B026-FAA01EC65765__GUID-E7D16EE0-E12A-4708-AD4E-576501FDAA43">
                     <p class="notep1">Note:</p>
                     <p>Previous to JDK 11, the Attach API had issues locating JVMs running in docker containers. This is now fixed, and <code class="codeph">jcmd</code> and <code class="codeph">jps</code> work as expected. However, <code class="codeph">jmc</code> will not list <code class="codeph">java</code> processes running in separate docker containers. There is no known way to explicitly provide the PID of the <code class="codeph">java</code> process to this tool.
                     </p>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-E4673A12-41F2-4479-9F7A-0FD8593CE462" name="GUID-E4673A12-41F2-4479-9F7A-0FD8593CE462"></a><h3 id="JSMGM-GUID-E4673A12-41F2-4479-9F7A-0FD8593CE462" class="sect3">Mimicking Ready-to-Use Management Using the JMX Remote API</h3>
               <div>
                  <p>The remote access to the ready-to-use management agent is protected by authentication and authorization, and by SSL encryption. The configuration is performed by setting system properties or by defining a <code class="codeph">management.properties</code> file. In most cases, using the ready-to-use management agent and configuring it through the <code class="codeph">management.properties</code> file is sufficient to provide secure management of remote Java VMs. However, in some cases, greater levels of security are required and in other cases, certain system configurations do not allow the use of a <code class="codeph">management.properties</code> file. Such cases might involve exporting the RMI server's remote objects over a certain port to allow passage through a firewall, or exporting the RMI server's remote objects using a specific network interface in multihomed systems. For such cases, the behavior of the ready-to-use management agent can be mimicked by using the JMX Remote API directly to create, configure, and deploy the management agent programmatically.
                  </p>
               </div>
               <div class="sect3"><a id="GUID-0A699033-903C-4757-BCEC-D2DB60D96A89" name="GUID-0A699033-903C-4757-BCEC-D2DB60D96A89"></a><h4 id="JSMGM-GUID-0A699033-903C-4757-BCEC-D2DB60D96A89" class="sect4">Example of Mimicking Ready-to-Use Management</h4>
                  <div>
                     <p>This section provides an example of how to implement a JMX agent that identically mimics an ready-to-use management agent. In exactly the same way as the ready-to-use management agent, the agent created in <a href="monitoring-and-management-using-jmx-technology.html#GUID-0A699033-903C-4757-BCEC-D2DB60D96A89__EXAMPLE2-5MIMICKINGANOUT-OF-THE-BOX-8F0B9A6B">Example&nbsp;2-5</a> will run on port 3000. It will have a password file named <code class="codeph">password.properties</code>, an access file named <code class="codeph">access.properties</code>, and it will implement the default configuration for SSL/TLS-based RMI Socket Factories, requiring server authentication only. This example assumes a <code class="codeph">keystore</code> has already been created, as described in <a href="monitoring-and-management-using-jmx-technology.html#GUID-FA9A0A97-6016-4283-9E9C-983C4D6F96D4">Using SSL</a>. Information about how to set up the SSL configuration is explained in <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/java/javase/11/management&amp;id=JSSEC-GUID-3D26386B-BC7A-41BB-AC70-80E6CD147D6F" target="_blank">Creating a Keystore to Use with JSSE</a> section of <span><cite>Java Platform, Standard Edition Security Developer's Guide</cite></span>.
                     </p>
                     <p>To enable monitoring and management on an application named <code class="codeph">com.example.MyApp</code>, using the ready-to-use JMX agent with the configuration, run the <code class="codeph">com.example.MyApp</code> with the following command:
                     </p><pre class="pre codeblock"><code>% java -Dcom.sun.management.jmxremote.port=3000 \
     -Dcom.sun.management.jmxremote.password.file=password.properties \
     -Dcom.sun.management.jmxremote.access.file=access.properties \
     -Djavax.net.ssl.keyStore=keystore \
     -Djavax.net.ssl.keyStorePassword=password \
     com.example.MyApp
</code></pre><div class="infoboxnote" id="GUID-0A699033-903C-4757-BCEC-D2DB60D96A89__GUID-5445D36F-D855-43AE-8128-9EF6993666F6">
                        <p class="notep1">Note:</p> The <code class="codeph">com.sun.management.jmxremote.*</code> properties can be specified in a <code class="codeph">management.properties</code> file instead of passing them at the command line. In that case, the system property <code class="codeph">-Dcom.sun.management.config.file=management.properties</code> is required to specify the location of the <code class="codeph">management.properties</code> file.
                     </div>
                     <p><a href="monitoring-and-management-using-jmx-technology.html#GUID-0A699033-903C-4757-BCEC-D2DB60D96A89__EXAMPLE2-5MIMICKINGANOUT-OF-THE-BOX-8F0B9A6B">Example&nbsp;2-5</a> shows the code that you need to write to programmatically create a JMX agent, which will allow exactly the same monitoring and management on <code class="codeph">com.example.MyApp</code> as using the prior command.
                     </p>
                     <p id="GUID-0A699033-903C-4757-BCEC-D2DB60D96A89__EXAMPLE2-5MIMICKINGANOUT-OF-THE-BOX-8F0B9A6B">Example&nbsp;2-5 Mimicking a Ready-to-Use JMX Agent Programmatically </p><pre class="pre codeblock"><code>package com.example;

import java.lang.management.*;
import java.rmi.registry.*;
import java.util.*;
import javax.management.*;
import javax.management.remote.*;
import javax.management.remote.rmi.*;
import javax.rmi.ssl.*;

public class MyApp {

    public static void main(String[] args) throws Exception {

        // Ensure cryptographically strong random number generator used
        // to choose the object number - see java.rmi.server.ObjID
        //
        System.setProperty("java.rmi.server.randomIDs", "true");

        // Start an RMI registry on port 3000.
        //
        System.out.println("Create RMI registry on port 3000");
        LocateRegistry.createRegistry(3000);

        // Retrieve the PlatformMBeanServer.
        //
        System.out.println("Get the platform's MBean server");
        MBeanServer mbs = ManagementFactory.getPlatformMBeanServer();

        // Environment map.
        //
        System.out.println("Initialize the environment map");
        HashMap&lt;String,Object&gt; env = new HashMap&lt;String,Object&gt;();

        // Provide SSL-based RMI socket factories.
        //
        // The protocol and cipher suites to be enabled will be the ones
        // defined by the default JSSE implementation and only server
        // authentication will be required.
        //
        SslRMIClientSocketFactory csf = new SslRMIClientSocketFactory();
        SslRMIServerSocketFactory ssf = new SslRMIServerSocketFactory();
        env.put(RMIConnectorServer.RMI_CLIENT_SOCKET_FACTORY_ATTRIBUTE, csf);
        env.put(RMIConnectorServer.RMI_SERVER_SOCKET_FACTORY_ATTRIBUTE, ssf);

        // Provide the password file used by the connector server to
        // perform user authentication. The password file is a properties
        // based text file specifying username/password pairs.
        //
        env.put("jmx.remote.x.password.file", "password.properties");

        // Provide the access level file used by the connector server to
        // perform user authorization. The access level file is a properties
        // based text file specifying username/access level pairs where
        // access level is either "readonly" or "readwrite" access to the
        // MBeanServer operations.
        //
        env.put("jmx.remote.x.access.file", "access.properties");

        // Create an RMI connector server.
        //
        // As specified in the JMXServiceURL the RMIServer stub will be
        // registered in the RMI registry running in the local host on
        // port 3000 with the name "jmxrmi". This is the same name that the
        // ready-to-use management agent uses to register the RMIServer
        // stub.
        //
        System.out.println("Create an RMI connector server");
        JMXServiceURL url =
            new JMXServiceURL("service:jmx:rmi:///jndi/rmi://:3000/jmxrmi");
        JMXConnectorServer cs =
            JMXConnectorServerFactory.newJMXConnectorServer(url, env, mbs);

        // Start the RMI connector server.
        //
        System.out.println("Start the RMI connector server");
        cs.start();
    }
}
</code></pre><p>Start this application with the following command:</p><pre class="pre codeblock"><code>java -Djavax.net.ssl.keyStore=keystore \
     -Djavax.net.ssl.keyStorePassword=password \
     com.example.MyApp
</code></pre><p>The <code class="codeph">com.example.MyApp</code> application will enable the JMX agent and will be monitored and managed in exactly the same way as if the Java platform's ready-to-use management agent has been used. However, there is one slight but important difference between the RMI registry used by the ready-to-use management agent and the one used by a management agent that mimics it. The RMI registry used by the ready-to-use management agent is read-only, namely a single entry can be bound to it and upon being bound, this entry cannot be unbound. This is not true with the RMI registry created in <a href="monitoring-and-management-using-jmx-technology.html#GUID-0A699033-903C-4757-BCEC-D2DB60D96A89__EXAMPLE2-5MIMICKINGANOUT-OF-THE-BOX-8F0B9A6B">Example&nbsp;2-5</a>.
                     </p>
                     <p>Furthermore, both RMI registries are insecure as they do not use SSL/TLS. The RMI registries should be created using SSL/TLS-based RMI socket factories that require client authentication. This will prevent a client from sending its credentials to a rogue RMI server and will also prevent the RMI registry from giving access to the RMI server stub to a nontrusted client.</p>
                     <p>RMI registries that implement SSL/TLS RMI socket factories can be created by adding the following properties to your <code class="codeph">management.properties</code> file:
                     </p><pre class="pre codeblock"><code>com.sun.management.jmxremote.registry.ssl=true
com.sun.management.jmxremote.ssl.need.client.auth=true
</code></pre><p><a href="monitoring-and-management-using-jmx-technology.html#GUID-0A699033-903C-4757-BCEC-D2DB60D96A89__EXAMPLE2-5MIMICKINGANOUT-OF-THE-BOX-8F0B9A6B">Example&nbsp;2-5</a> mimics the main behavior of the ready-to-use JMX agent, but does not replicate all the existing properties in the <code class="codeph">management.properties</code> file. However, you can add other properties by modifying <code class="codeph">com.example.MyApp</code> appropriately.
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-34811D07-AB51-4EC7-8D37-EEAF7C15F5C7" name="GUID-34811D07-AB51-4EC7-8D37-EEAF7C15F5C7"></a><h4 id="JSMGM-GUID-34811D07-AB51-4EC7-8D37-EEAF7C15F5C7" class="sect4">Monitoring Applications Through a Firewall</h4>
                  <div>
                     <p>The code in <a href="monitoring-and-management-using-jmx-technology.html#GUID-0A699033-903C-4757-BCEC-D2DB60D96A89__EXAMPLE2-5MIMICKINGANOUT-OF-THE-BOX-8F0B9A6B"> Example&nbsp;2-5</a> can be used to monitor applications through a firewall, which might not be possible if you use the ready-to-use monitoring solution. The <code class="codeph">com.sun.management.jmxremote.port</code> management property specifies the port where the RMI registry can be reached but the ports where the <code class="codeph">RMIServer</code> and <code class="codeph">RMIConnection</code> remote objects are exported is chosen by the RMI stack. To export the remote objects (<code class="codeph">RMIServer</code> and <code class="codeph">RMIConnection</code>) to a given port, you need to create your own RMI connector server programmatically, as described in <a href="monitoring-and-management-using-jmx-technology.html#GUID-0A699033-903C-4757-BCEC-D2DB60D96A89__EXAMPLE2-5MIMICKINGANOUT-OF-THE-BOX-8F0B9A6B">Example&nbsp;2-5</a>. However, you must specify <code class="codeph">JMXServiceURL</code> as follows:
                     </p><pre class="pre codeblock"><code>JMXServiceURL url = new JMXServiceURL("service:jmx:rmi://localhost:" + 
      <span class="variable" translate="no">port1</span>  + "/jndi/rmi://localhost:" + <span class="variable" translate="no">port2</span> + "/jmxrmi");
</code></pre><p><code class="codeph"><span class="variable" translate="no">port1</span></code> is the port number on which the <code class="codeph">RMIServer</code> and <code class="codeph">RMIConnection</code> remote objects are exported, and <code class="codeph"><span class="variable" translate="no">port2</span></code> is the port number of the RMI Registry.
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-797B5B00-ADF9-47C6-9DD5-762A0383C233" name="GUID-797B5B00-ADF9-47C6-9DD5-762A0383C233"></a><h4 id="JSMGM-GUID-797B5B00-ADF9-47C6-9DD5-762A0383C233" class="sect4">Using an Agent Class to Instrument an Application</h4>
                  <div>
                     <p>The Java SE platform provides services that allow Java programming language agents to instrument programs running on the Java VM. Creating an instrumentation agent means that you do not have to add any new code to your application in order to allow it to be monitored. Instead of implementing monitoring and management in your application's static <code class="codeph">main</code> method, you implement it in a separate agent class, and start your application with the <code class="codeph">-javaagent</code> option specified. See the API reference documentation for the <a href="https://docs.oracle.com/javase/10/docs/api/java/lang/instrument/package-summary.html" target="_blank"><span class="apiname">java.lang.instrument</span></a> package for full details about how to create an agent class to instrument your applications.
                     </p>
                  </div>
                  <div class="sect4"><a id="GUID-937A3DE2-2D20-4DBE-9026-DFEA95B64B28" name="GUID-937A3DE2-2D20-4DBE-9026-DFEA95B64B28"></a><h5 id="JSMGM-GUID-937A3DE2-2D20-4DBE-9026-DFEA95B64B28" class="sect5"> Creating an Agent Class to Instrument an Application</h5>
                     <div>
                        <p>The following procedure shows how you can adapt the code of <code class="codeph">com.example.MyApp</code> to create an agent to instrument any other application for monitoring and management.
                        </p>
                        <ol>
                           <li>Create a <code class="codeph">com.example.MyAgent</code> class. 
                              <p>Create a class called <code class="codeph">com.example.MyAgent</code>, declaring a <code class="codeph">premain</code> method rather than a <code class="codeph">main</code> method.
                              </p><pre class="pre codeblock"><code>package com.example;

[...]

public class MyAgent {
    
    public static void premain(String args) throws Exception {
    
    [...]
</code></pre><p>The rest of the code for the <code class="codeph">com.example.MyAgent</code> class is same as the <code class="codeph">com.example.MyApp</code> class as shown in <a href="monitoring-and-management-using-jmx-technology.html#GUID-0A699033-903C-4757-BCEC-D2DB60D96A89__EXAMPLE2-5MIMICKINGANOUT-OF-THE-BOX-8F0B9A6B"> Example&nbsp;2-5</a>.
                              </p>
                           </li>
                           <li>Compile the <code class="codeph">com.example.MyAgent</code> class.
                           </li>
                           <li>Create a manifest file, <code class="codeph">MANIFEST.MF</code>, with a <code class="codeph">Premain-Class</code> entry. 
                              <p>An agent is deployed as a Java archive (JAR) file. An attribute in the JAR file manifest specifies the agent class that will be loaded to start the agent. Create a file called <code class="codeph">MANIFEST.MF</code>, containing the following line:
                              </p><pre class="pre codeblock"><code>Premain-Class: com.example.MyAgent
</code></pre></li>
                           <li>Create a JAR file, <code class="codeph">MyAgent.jar</code>.
                              <p>The JAR file should contain the following files:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">META-INF/MANIFEST.MF</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">com/example/MyAgent.class</code></p>
                                 </li>
                              </ul>
                           </li>
                           <li>Start an application, specifying the agent to provide monitoring and management services.
                              <p> You can use <code class="codeph">com.example.MyAgent</code> to instrument any application for monitoring and management. This example uses the <code class="codeph">Notepad</code> application.
                              </p><pre class="pre codeblock"><code>% java -javaagent:MyAgent.jar -Djavax.net.ssl.keyStore=keystore \
      -Djavax.net.ssl.keyStorePassword=password -jar Notepad.jar
</code></pre><p>The <code class="codeph">com.example.MyAgent</code> agent is specified using the <code class="codeph">-javaagent</code> option when you start <code class="codeph">Notepad</code>. Also, if your <code class="codeph">com.example.MyAgent</code> application replicates the same code as the <code class="codeph">com.example.MyApp</code> application shown in <a href="monitoring-and-management-using-jmx-technology.html#GUID-0A699033-903C-4757-BCEC-D2DB60D96A89__EXAMPLE2-5MIMICKINGANOUT-OF-THE-BOX-8F0B9A6B"> Example&nbsp;2-5</a>, then provide the <code class="codeph">keystore</code> and <code class="codeph">password</code> information because the RMI connector server is protected by SSL.
                              </p>
                           </li>
                        </ol>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>
