<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<!-- GenHTML revision 25226-->
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>Creating the Java Persistence API Entity - Your First Cup: An Introduction to the Java EE Platform</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2012-04-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
<link rel="stylesheet" type="text/css" href="css/javaeetutorial.css">
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>

<body>

<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tbody>
   <tr valign="top">
      <td width="400px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="gcqyw.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="gcqyb.html">1.&nbsp;&nbsp;Introduction</a></p>
<p class="toc level1 tocsp"><a href="gcrlo.html">2.&nbsp;&nbsp;Understanding Java Platform, Enterprise Edition</a></p>
<p class="toc level1 tocsp"><a href="gcrkp.html">3.&nbsp;&nbsp;Creating Your First Java EE Application</a></p>
<p class="toc level1 tocsp"><a href="glcfc.html">4.&nbsp;&nbsp;Creating Your Second Web Application</a></p>
<p class="toc level2"><a href="gjbca.html">Creating the <tt>firstcup</tt> Project</a></p>
<p class="toc level3"><a href="gjbca.html#gimnt">Create the Web Application Project</a></p>
<div id="scrolltoc" class="onpage">
<p class="toc level2 tocsp"><a href="">Creating the Java Persistence API Entity</a></p>
<p class="toc level3"><a href="#gjbam">Create the <tt>FirstcupUser</tt> Entity Class</a></p>
<p class="toc level3"><a href="#gjbao">Add Properties to the <tt>FirstcupUser</tt> Entity</a></p>
<p class="toc level3"><a href="#gkknn">Add Constructors to the <tt>FirstcupUser</tt> Entity</a></p>
<p class="toc level3"><a href="#gjbcm">Add a Named Query to the <tt>FirstcupUser</tt> Entity</a></p>
</div>
<p class="toc level2 tocsp"><a href="gcrlx.html">Creating the Enterprise Bean</a></p>
<p class="toc level3"><a href="gcrlx.html#gcrpv">Create the <tt>DukesBirthdayBean</tt> Enterprise Bean Class</a></p>
<p class="toc level3"><a href="gcrlx.html#gcrpg">Add a Logger Instance to <tt>DukesBirthdayBean.java</tt></a></p>
<p class="toc level3"><a href="gcrlx.html#gjbcu">Add a Business Method to <tt>DukesBirthdayBean</tt> that Gets the Average Age Difference of <tt>firstcup</tt> Users</a></p>
<p class="toc level3"><a href="gcrlx.html#gkgot">Add a Business Method for Calculating the Age Difference Between Duke and the User</a></p>
<p class="toc level2 tocsp"><a href="gcrlt.html">Creating the Web Client</a></p>
<p class="toc level3"><a href="gcrlt.html#gcrpf">Creating a Resource Bundle</a></p>
<p class="toc level4"><a href="gcrlt.html#gcrrz">Create a Resource Bundle</a></p>
<p class="toc level3 tocsp"><a href="gcrlt.html#gcrri">Configuring the Resource Bundle in the Configuration File</a></p>
<p class="toc level4"><a href="gcrlt.html#gjbco">Create a Configuration File</a></p>
<p class="toc level4"><a href="gcrlt.html#gcrqy">Configure the Resource Bundle</a></p>
<p class="toc level3 tocsp"><a href="gcrlt.html#gcrqx">Creating the <tt>DukesBDay</tt> Managed Bean Class</a></p>
<p class="toc level4"><a href="gcrlt.html#gcrrq">Create the Managed Bean Class</a></p>
<p class="toc level4"><a href="gcrlt.html#gcrre">Add an Enterprise Bean Reference</a></p>
<p class="toc level4"><a href="gcrlt.html#gcuzv">Add Properties to the Bean</a></p>
<p class="toc level4"><a href="gcrlt.html#gcrsa">Get the Age Difference from the <tt>DukesBirthdayBean</tt> Enterprise Bean</a></p>
<p class="toc level3 tocsp"><a href="gcrlt.html#gimvd">Creating the Facelets Client</a></p>
<p class="toc level4"><a href="gcrlt.html#gimug">Resource Libraries in <tt>firstcup</tt></a></p>
<p class="toc level4"><a href="gcrlt.html#gimtw">The <tt>inputDate</tt> Composite Component</a></p>
<p class="toc level4"><a href="gcrlt.html#gimwv">Create the <tt>inputDate</tt> Composite Component</a></p>
<p class="toc level4"><a href="gcrlt.html#gimum">The Facelets Web Interface</a></p>
<p class="toc level4"><a href="gcrlt.html#gimxf">Create the XHTML Files</a></p>
<p class="toc level4"><a href="gcrlt.html#giplb">Set the Welcome File in the <tt>web.xml</tt> Deployment Descriptor</a></p>
<p class="toc level4"><a href="gcrlt.html#gimua">Modify the XHTML Files</a></p>
<p class="toc level4"><a href="gcrlt.html#gimta">Add the Form to <tt>greeting.xhtml</tt></a></p>
<p class="toc level4"><a href="gcrlt.html#gimvw">Add the Form to <tt>response.html</tt></a></p>
<p class="toc level2 tocsp"><a href="gctnx.html">Building, Packaging, Deploying, and Running the <tt>firstcup</tt> Web Application</a></p>
<p class="toc level3"><a href="gctnx.html#gctoj">Build, Package, and Deploy the <tt>firstcup</tt> Web Application</a></p>
<p class="toc level3"><a href="gctnx.html#gctqc">Run the <tt>firstcup</tt> Application</a></p>
<p class="toc level1 tocsp"><a href="gcrll.html">5.&nbsp;&nbsp;Next Steps</a></p>
</td>
      <td width="10px">&nbsp;</td>
      <td>
         <div class="header">
             <div class="banner">
                <table width="100%" border="0" cellpadding="5" cellspacing="0">
                   <tbody>
                      <tr>
                         <td valign="bottom"><p class="Banner">Your First Cup
</p></td>
                         <td align="right"  valign="bottom"><img src="graphics/javalogo.png" alt="Java Coffee Cup logo"></td>
                      </tr>
                   </tbody>
                </table>
             </div>

             <div class="header-links">
	         <a href="./index.html">Home</a> | 
<a href="./gcqzl.html#gcrnx">Download</a> | 
<a href="./firstcup.pdf">PDF</a> | 
<a href="http://docs.oracle.com/javaee/support/feedback.htm">Feedback</a>

             </div>
             <div class="navigation">
                 <a href="gjbca.html"><img src="graphics/leftButton.gif" border="0" alt="Previous" title="Previous"></a>
                 <a href="p1.html"><img src="graphics/upButton.gif" border="0" alt="Contents" title="Contents"></a>
                 <a href="gcrlx.html"><img src="graphics/rightButton.gif" border="0" alt="Next" title="Next"></a>
             </div>
         </div>

	 <div class="maincontent">      	 
             

<a name="gjbcs"></a><h2>Creating the Java Persistence API Entity</h2>
<p>The Java Persistence API allows you to create and use Java programming language
classes that represent data in a database table. A Java Persistence API <b>entity</b>
is a lightweight, persistent Java programming language object that represents data in a data
store. Entities can be created, modified, and removed from the data store by
calling the operations of the Java Persistence API <b>entity manager</b>. Entities, or the data
encapsulated by the persistent fields or properties of a entity, can be queried
using the Java Persistence Query Language (JPQL), a language similar to SQL that
operates on entities.</p>

<p>In <tt>firstcup</tt>, there is a single entity that defines one query.</p>



<a name="gjbam"></a><h3>Create the <tt>FirstcupUser</tt> Entity Class</h3><p>The <tt>FirstcupUser</tt> Java Persistence API entity represents a particular <tt>firstcup</tt> user, and stores the
user's birthday and the difference in age between the user and Duke.
<tt>FirstcupUser</tt> also defines a Java Persistence API query used to calculate the average
age difference of all users.</p>

<ol>
<li><b>Select the <tt>firstcup</tt> project in the Projects tab.</b></li>
<li><b>From the File menu, choose New File.</b></li>
<li><b>In the Categories pane, select Persistence.</b></li>
<li><b>In the File Types pane, select Entity Class.</b></li>
<li><b>Click Next.</b></li>
<li><b>In the Class Name field, type <tt>FirstcupUser</tt>.</b></li>
<li><b>In the Package field, type <tt>firstcup.entity</tt>.</b></li>
<li><b>Click Next.</b></li>
<li><b>Select <tt>jdbc/__default</tt> from the Data Source menu.</b></li>
<li><b>For Table Generation Strategy, select Drop and Create.</b></li>
<li><b>Click Finish.</b><p>You should now see the <tt>FirstcupUser.java</tt> file inside the <tt>firstcup.entity</tt> package in the
Projects tab. The <tt>FirstcupUser.java</tt> file should also be open in the editor pane.</p></li></ol>

<a name="gjbao"></a><h3>Add Properties to the <tt>FirstcupUser</tt> Entity</h3><p>Create the <tt>FirstcupUser</tt> entity's two properties: <tt>birthday</tt>, of type <tt>java.util.Calendar</tt>; and <tt>ageDifference</tt>,
of type <tt>int</tt>.</p>

<p>The <tt>birthday</tt> property must be annotated with the <tt>javax.persistence.Temporal</tt> annotation to mark
the property as a date field in the underlying database table. All persistent
fields or properties of type <tt>java.util.Calendar</tt> or <tt>java.util.Date</tt> must be annotated with <tt>@Temporal</tt>.</p>

<ol>
<li><b>In <tt>FirstcupUser.java</tt> below the <tt>id</tt> field definition, copy and paste in the following
field definitions for <tt>birthday</tt> and <tt>ageDifference</tt>:</b><pre>    @Temporal(javax.persistence.TemporalType.DATE)
    protected Calendar birthday;
    protected int ageDifference;</pre></li>
<li><b>Below the getter and setter methods for the <tt>id</tt> property, copy and paste
in the following getter and setter methods for the <tt>birthday</tt> and <tt>ageDifference</tt>
properties:</b><pre>    public Calendar getBirthday() {
        return birthday;
    }

    public void setBirthday(Calendar birthday) {
        this.birthday = birthday;
    }

    public int getAgeDifference() {
        return ageDifference;
    }

    public void setAgeDifference(int ageDifference) {
        this.ageDifference = ageDifference;
    }</pre></li>
<li><b>Right-click in the editor window and select Format.</b></li>
<li><b>Right-click in the editor window and select Fix Imports.</b></li></ol>

<a name="gkknn"></a><h3>Add Constructors to the <tt>FirstcupUser</tt> Entity</h3><p>Create two constructors for <tt>FirstcupUser</tt>: one that takes no arguments, and another that
takes two arguments.</p>

<ol>
<li><b>Below the field definitions in the <tt>FirstcupUser</tt> class, add the following constructors:.</b><pre>    public FirstcupUser() {
    }

    public FirstcupUser(Date date, int ageDifference) {
        Calendar cal = new GregorianCalendar();
        cal.setTime(date);
        this.setBirthday(cal);
        this.setAgeDifference(ageDifference);
    }</pre></li>
<li><b>Right-click in the editor window and select Format.</b></li>
<li><b>Right-click in the editor window and select Fix Imports, then click OK.</b></li></ol>

<a name="gjbcm"></a><h3>Add a Named Query to the <tt>FirstcupUser</tt> Entity</h3><p>Add a JPQL named query to the <tt>FirstcupUser</tt> entity that returns the average
age difference of all <tt>firstcup</tt> users.</p>

<p>This query uses the <tt>AVG</tt> aggregate function to return the average of all
the values of the <tt>ageDifference</tt> property of the <tt>FirstcupUser</tt> entities.</p>

<ol>
<li><b>Directly before the class definition, copy and paste in the following code:</b><pre>@NamedQuery(name="findAverageAgeDifferenceOfAllFirstcupUsers",
query="SELECT AVG(u.ageDifference) FROM FirstcupUser u")</pre><p>The <tt>@NamedQuery</tt> annotation appears just before the class definition of the entity, and
has two required attributes: <tt>name</tt>, with the unique name for this query;
and <tt>query</tt>, the JPQL query definition.</p></li>
<li><b>Right-click in the editor window and select Format.</b></li>
<li><b>Right-click in the editor window and select Fix Imports.</b></li>
<li><b>From the File menu, choose Save.</b></li></ol>
         </div>
         <div class="navigation">
             <a href="gjbca.html"><img src="graphics/leftButton.gif" border="0" alt="Previous" title="Previous"></a>
             <a href="p1.html"><img src="graphics/upButton.gif" border="0" alt="Contents" title="Contents"></a>
             <a href="gcrlx.html"><img src="graphics/rightButton.gif" border="0" alt="Next" title="Next"></a>
         </div>

         <div class="copyright">
      	    <p>Copyright &copy; 2012, Oracle and/or its affiliates. All rights reserved. <a href="docinfo.html">Legal Notices</a></p>
      	 </div>

      </td>
   </tr>
</tbody>
</table>
<!-- Start SiteCatalyst code   -->
<script language="JavaScript" src="http://www.oracle.com/ocom/groups/systemobject/@mktg_admin/documents/systemobject/s_code_download.js"></script>
<script language="JavaScript" src="http://www.oracle.com/ocom/groups/systemobject/@mktg_admin/documents/systemobject/s_code.js"></script>
 
<!-- ********** DO NOT ALTER ANYTHING BELOW THIS LINE ! *********** -->
<!--  Below code will send the info to Omniture server -->
<script language="javascript">var s_code=s.t();if(s_code)document.write(s_code)</script>
<noscript><p>Scripting on this page tracks web page traffic,
but does not change the content in any way.</p></noscript>
<!-- End SiteCatalyst code -->
</body>
</html>

