<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<!-- GenHTML revision 25226-->
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>Bean-Managed Transactions - The Java EE 6 Tutorial</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2013-01-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
<link rel="stylesheet" type="text/css" href="css/javaeetutorial.css">
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>

<body>

<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tbody>
   <tr valign="top">
      <td width="400px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="gexaf.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="gfirp.html">Part&nbsp;I&nbsp;Introduction</a></p>
<p class="toc level2"><a href="bnaaw.html">1.&nbsp;&nbsp;Overview</a></p>
<p class="toc level2"><a href="gfiud.html">2.&nbsp;&nbsp;Using the Tutorial Examples</a></p>
<p class="toc level1 tocsp"><a href="bnadp.html">Part&nbsp;II&nbsp;The Web Tier</a></p>
<p class="toc level2"><a href="bnadr.html">3.&nbsp;&nbsp;Getting Started with Web Applications</a></p>
<p class="toc level2"><a href="bnaph.html">4.&nbsp;&nbsp;JavaServer Faces Technology</a></p>
<p class="toc level2"><a href="giepx.html">5.&nbsp;&nbsp;Introduction to Facelets</a></p>
<p class="toc level2"><a href="gjddd.html">6.&nbsp;&nbsp;Expression Language</a></p>
<p class="toc level2"><a href="bnaqz.html">7.&nbsp;&nbsp;Using JavaServer Faces Technology in Web Pages</a></p>
<p class="toc level2"><a href="gjcut.html">8.&nbsp;&nbsp;Using Converters, Listeners, and Validators</a></p>
<p class="toc level2"><a href="bnatx.html">9.&nbsp;&nbsp;Developing with JavaServer Faces Technology</a></p>
<p class="toc level2"><a href="gkmaa.html">10.&nbsp;&nbsp;JavaServer Faces Technology: Advanced Concepts</a></p>
<p class="toc level2"><a href="gkiow.html">11.&nbsp;&nbsp;Using Ajax with JavaServer Faces Technology</a></p>
<p class="toc level2"><a href="gkhxa.html">12.&nbsp;&nbsp;Composite Components: Advanced Topics and Example</a></p>
<p class="toc level2"><a href="bnavg.html">13.&nbsp;&nbsp;Creating Custom UI Components and Other Custom Objects</a></p>
<p class="toc level2"><a href="bnawo.html">14.&nbsp;&nbsp;Configuring JavaServer Faces Applications</a></p>
<p class="toc level2"><a href="bnafd.html">15.&nbsp;&nbsp;Java Servlet Technology</a></p>
<p class="toc level2"><a href="glrbb.html">16.&nbsp;&nbsp;Uploading Files with Java Servlet Technology</a></p>
<p class="toc level2"><a href="bnaxu.html">17.&nbsp;&nbsp;Internationalizing and Localizing Web Applications</a></p>
<p class="toc level1 tocsp"><a href="bnayk.html">Part&nbsp;III&nbsp;Web Services</a></p>
<p class="toc level2"><a href="gijti.html">18.&nbsp;&nbsp;Introduction to Web Services</a></p>
<p class="toc level2"><a href="bnayl.html">19.&nbsp;&nbsp;Building Web Services with JAX-WS</a></p>
<p class="toc level2"><a href="giepu.html">20.&nbsp;&nbsp;Building RESTful Web Services with JAX-RS</a></p>
<p class="toc level2"><a href="gjjxe.html">21.&nbsp;&nbsp;JAX-RS: Advanced Topics and Example</a></p>
<p class="toc level1 tocsp"><a href="bnblr.html">Part&nbsp;IV&nbsp;Enterprise Beans</a></p>
<p class="toc level2"><a href="gijsz.html">22.&nbsp;&nbsp;Enterprise Beans</a></p>
<p class="toc level2"><a href="gijre.html">23.&nbsp;&nbsp;Getting Started with Enterprise Beans</a></p>
<p class="toc level2"><a href="gijrb.html">24.&nbsp;&nbsp;Running the Enterprise Bean Examples</a></p>
<p class="toc level2"><a href="bnbpk.html">25.&nbsp;&nbsp;A Message-Driven Bean Example</a></p>
<p class="toc level2"><a href="gkcqz.html">26.&nbsp;&nbsp;Using the Embedded Enterprise Bean Container</a></p>
<p class="toc level2"><a href="gkidz.html">27.&nbsp;&nbsp;Using Asynchronous Method Invocation in Session Beans</a></p>
<p class="toc level1 tocsp"><a href="gjbnr.html">Part&nbsp;V&nbsp;Contexts and Dependency Injection for the Java EE Platform</a></p>
<p class="toc level2"><a href="giwhb.html">28.&nbsp;&nbsp;Introduction to Contexts and Dependency Injection for the Java EE Platform</a></p>
<p class="toc level2"><a href="gjbls.html">29.&nbsp;&nbsp;Running the Basic Contexts and Dependency Injection Examples</a></p>
<p class="toc level2"><a href="gjehi.html">30.&nbsp;&nbsp;Contexts and Dependency Injection for the Java EE Platform: Advanced Topics</a></p>
<p class="toc level2"><a href="gkhre.html">31.&nbsp;&nbsp;Running the Advanced Contexts and Dependency Injection Examples</a></p>
<p class="toc level1 tocsp"><a href="bnbpy.html">Part&nbsp;VI&nbsp;Persistence</a></p>
<p class="toc level2"><a href="bnbpz.html">32.&nbsp;&nbsp;Introduction to the Java Persistence API</a></p>
<p class="toc level2"><a href="gijst.html">33.&nbsp;&nbsp;Running the Persistence Examples</a></p>
<p class="toc level2"><a href="bnbtg.html">34.&nbsp;&nbsp;The Java Persistence Query Language</a></p>
<p class="toc level2"><a href="gjitv.html">35.&nbsp;&nbsp;Using the Criteria API to Create Queries</a></p>
<p class="toc level2"><a href="gkjiq.html">36.&nbsp;&nbsp;Creating and Using String-Based Criteria Queries</a></p>
<p class="toc level2"><a href="gkjjf.html">37.&nbsp;&nbsp;Controlling Concurrent Access to Entity Data with Locking</a></p>
<p class="toc level2"><a href="gkjia.html">38.&nbsp;&nbsp;Using a Second-Level Cache with Java Persistence API Applications</a></p>
<p class="toc level1 tocsp"><a href="gijrp.html">Part&nbsp;VII&nbsp;Security</a></p>
<p class="toc level2"><a href="bnbwj.html">39.&nbsp;&nbsp;Introduction to Security in the Java EE Platform</a></p>
<p class="toc level2"><a href="bncas.html">40.&nbsp;&nbsp;Getting Started Securing Web Applications</a></p>
<p class="toc level2"><a href="bnbyk.html">41.&nbsp;&nbsp;Getting Started Securing Enterprise Applications</a></p>
<p class="toc level2"><a href="gjjwx.html">42.&nbsp;&nbsp;Java EE Security: Advanced Topics</a></p>
<p class="toc level1 tocsp"><a href="gijue.html">Part&nbsp;VIII&nbsp;Java EE Supporting Technologies</a></p>
<p class="toc level2"><a href="gijto.html">43.&nbsp;&nbsp;Introduction to Java EE Supporting Technologies</a></p>
<p class="toc level2"><a href="bncih.html">44.&nbsp;&nbsp;Transactions</a></p>
<p class="toc level3"><a href="bncii.html">What Is a Transaction?</a></p>
<p class="toc level3"><a href="bncij.html">Container-Managed Transactions</a></p>
<p class="toc level4"><a href="bncij.html#bncik">Transaction Attributes</a></p>
<p class="toc level5"><a href="bncij.html#bncim"><tt>Required</tt> Attribute</a></p>
<p class="toc level5"><a href="bncij.html#bncin"><tt>RequiresNew</tt> Attribute</a></p>
<p class="toc level5"><a href="bncij.html#bncio"><tt>Mandatory</tt> Attribute</a></p>
<p class="toc level5"><a href="bncij.html#bncip"><tt>NotSupported</tt> Attribute</a></p>
<p class="toc level5"><a href="bncij.html#bnciq"><tt>Supports</tt> Attribute</a></p>
<p class="toc level5"><a href="bncij.html#bncir"><tt>Never</tt> Attribute</a></p>
<p class="toc level5"><a href="bncij.html#bncis">Summary of Transaction Attributes</a></p>
<p class="toc level5"><a href="bncij.html#bnciu">Setting Transaction Attributes</a></p>
<p class="toc level4 tocsp"><a href="bncij.html#bnciv">Rolling Back a Container-Managed Transaction</a></p>
<p class="toc level4"><a href="bncij.html#bnciw">Synchronizing a Session Bean's Instance Variables</a></p>
<p class="toc level4"><a href="bncij.html#bncix">Methods Not Allowed in Container-Managed Transactions</a></p>
<div id="scrolltoc" class="onpage">
<p class="toc level3 tocsp"><a href="">Bean-Managed Transactions</a></p>
<p class="toc level4"><a href="#bnciz">JTA Transactions</a></p>
<p class="toc level4"><a href="#bncja">Returning without Committing</a></p>
<p class="toc level4"><a href="#bncjb">Methods Not Allowed in Bean-Managed Transactions</a></p>
</div>
<p class="toc level3 tocsp"><a href="bncjc.html">Transaction Timeouts</a></p>
<p class="toc level4"><a href="bncjc.html#gentextid-29581">To Set a Transaction Timeout</a></p>
<p class="toc level3 tocsp"><a href="bncjd.html">Updating Multiple Databases</a></p>
<p class="toc level3"><a href="bncjg.html">Transactions in Web Components</a></p>
<p class="toc level3"><a href="gkcmi.html">Further Information about Transactions</a></p>
<p class="toc level2 tocsp"><a href="bncjh.html">45.&nbsp;&nbsp;Resources and Resource Adapters</a></p>
<p class="toc level2"><a href="glodb.html">46.&nbsp;&nbsp;The Resource Adapter Example</a></p>
<p class="toc level2"><a href="bncdq.html">47.&nbsp;&nbsp;Java Message Service Concepts</a></p>
<p class="toc level2"><a href="bncgv.html">48.&nbsp;&nbsp;Java Message Service Examples</a></p>
<p class="toc level2"><a href="gkahp.html">49.&nbsp;&nbsp;Bean Validation: Advanced Topics</a></p>
<p class="toc level2"><a href="gkeed.html">50.&nbsp;&nbsp;Using Java EE Interceptors</a></p>
<p class="toc level1 tocsp"><a href="gkgjw.html">Part&nbsp;IX&nbsp;Case Studies</a></p>
<p class="toc level2"><a href="glnvi.html">51.&nbsp;&nbsp;Duke's Bookstore Case Study Example</a></p>
<p class="toc level2"><a href="gkaee.html">52.&nbsp;&nbsp;Duke's Tutoring Case Study Example</a></p>
<p class="toc level2"><a href="glnpw.html">53.&nbsp;&nbsp;Duke's Forest Case Study Example</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td width="10px">&nbsp;</td>
      <td>
         <div class="header">
             <div class="banner">
                <table width="100%" border="0" cellpadding="5" cellspacing="0">
                   <tbody>
                      <tr>
                         <td valign="bottom"><p class="Banner">The Java EE 6 Tutorial
</p></td>
                         <td align="right"  valign="bottom"><img src="graphics/javalogo.png" alt="Java Coffee Cup logo"></td>
                      </tr>
                   </tbody>
                </table>
             </div>

             <div class="header-links">
	         <a href="./index.html">Home</a> | 
<a href="../information/download.html">Download</a> | 
<a href="./javaeetutorial6.pdf">PDF</a> | 
<a href="../information/faq.html">FAQ</a> | 
<a href="http://docs.oracle.com/javaee/support/feedback.htm">Feedback</a>

             </div>
             <div class="navigation">
                 <a href="bncij.html"><img src="graphics/leftButton.gif" border="0" alt="Previous" title="Previous"></a>
                 <a href="p1.html"><img src="graphics/upButton.gif" border="0" alt="Contents" title="Contents"></a>
                 <a href="bncjc.html"><img src="graphics/rightButton.gif" border="0" alt="Next" title="Next"></a>
             </div>
         </div>

	 <div class="maincontent">      	 
             

<a name="bnciy"></a><h2>Bean-Managed Transactions</h2>
<a name="indexterm-2279"></a><a name="indexterm-2280"></a><p><a name="indexterm-2281"></a><a name="indexterm-2282"></a>In <b>bean-managed transaction demarcation</b>, the code in the session or message-driven bean explicitly marks the
boundaries of the transaction. Although beans with container-managed transactions require less coding, they have
one limitation: When a method is executing, it can be associated with either
a single transaction or no transaction at all. If this limitation will make
coding your bean difficult, you should consider using bean-managed transactions.</p>

<p>The following pseudocode illustrates the kind of fine-grained control you can obtain with
application-managed transactions. By checking various conditions, the pseudocode decides whether to start or
stop certain transactions within the business method:</p>

<pre>begin transaction
...
    update table-a
...
    if (condition-x)
   commit transaction
    else if (condition-y)
   update table-b
   commit transaction
    else
   rollback transaction
   begin transaction
   update table-c
   commit transaction</pre><p><a name="indexterm-2283"></a><a name="indexterm-2284"></a><a name="indexterm-2285"></a>When coding an application-managed transaction for session or message-driven beans, you must decide
whether to use Java Database Connectivity or JTA transactions. The sections that follow
discuss both types of transactions.</p>



<a name="bnciz"></a><h3>JTA Transactions</h3>
<a name="indexterm-2286"></a><a name="indexterm-2287"></a><a name="indexterm-2288"></a><p><a name="indexterm-2289"></a><a name="indexterm-2290"></a>JTA, or the Java Transaction API, allows you to demarcate transactions in a
manner that is independent of the transaction manager implementation. GlassFish Server implements the transaction
manager with the Java Transaction Service (JTS). However, your code doesn&rsquo;t call the
JTS methods directly but instead invokes the JTA methods, which then call the
lower-level JTS routines.</p>

<p><a name="indexterm-2291"></a><a name="indexterm-2292"></a>A <b>JTA transaction</b> is controlled by the Java EE transaction manager. You may want
to use a JTA transaction because it can span updates to multiple databases
from different vendors. A particular DBMS&rsquo;s transaction manager may not work with heterogeneous
databases. However, the Java EE transaction manager does have one limitation: It does not
support nested transactions. In other words, it cannot start a transaction for an
instance until the preceding transaction has ended.</p>

<p><a name="indexterm-2293"></a><a name="indexterm-2294"></a><a name="indexterm-2295"></a>To demarcate a JTA transaction, you invoke the <tt>begin</tt>, <tt>commit</tt>, and <tt>rollback</tt>
methods of the <tt>javax.transaction.UserTransaction</tt> interface.</p>



<a name="bncja"></a><h3>Returning without Committing</h3>
<p><a name="indexterm-2296"></a>In a stateless session bean with bean-managed transactions, a business method must commit
or roll back a transaction before returning. However, a stateful session bean does
not have this restriction.</p>

<p><a name="indexterm-2297"></a>In a stateful session bean with a JTA transaction, the association between the
bean instance and the transaction is retained across multiple client calls. Even if
each business method called by the client opens and closes the database connection,
the association is retained until the instance completes the transaction.</p>

<p>In a stateful session bean with a JDBC transaction, the JDBC connection retains
the association between the bean instance and the transaction across multiple calls. If
the connection is closed, the association is not retained.</p>



<a name="bncjb"></a><h3>Methods Not Allowed in Bean-Managed Transactions</h3>
<p><a name="indexterm-2298"></a><a name="indexterm-2299"></a><a name="indexterm-2300"></a><a name="indexterm-2301"></a><a name="indexterm-2302"></a><a name="indexterm-2303"></a><a name="indexterm-2304"></a>Do not invoke the <tt>getRollbackOnly</tt> and <tt>setRollbackOnly</tt> methods of the <tt>EJBContext</tt> interface in
bean-managed transactions. These methods should be used only in container-managed transactions. For bean-managed
transactions, invoke the <tt>getStatus</tt> and <tt>rollback</tt> methods of the <tt>UserTransaction</tt> interface.</p>


         </div>
         <div class="navigation">
             <a href="bncij.html"><img src="graphics/leftButton.gif" border="0" alt="Previous" title="Previous"></a>
             <a href="p1.html"><img src="graphics/upButton.gif" border="0" alt="Contents" title="Contents"></a>
             <a href="bncjc.html"><img src="graphics/rightButton.gif" border="0" alt="Next" title="Next"></a>
         </div>

         <div class="copyright">
      	    <p>Copyright &copy; 2013, Oracle and/or its affiliates. All rights reserved. <a href="docinfo.html">Legal Notices</a></p>
      	 </div>

      </td>
   </tr>
</tbody>
</table>
<!-- Start SiteCatalyst code   -->
<script language="JavaScript" src="http://www.oracle.com/ocom/groups/systemobject/@mktg_admin/documents/systemobject/s_code_download.js"></script>
<script language="JavaScript" src="http://www.oracle.com/ocom/groups/systemobject/@mktg_admin/documents/systemobject/s_code.js"></script>
 
<!-- ********** DO NOT ALTER ANYTHING BELOW THIS LINE ! *********** -->
<!--  Below code will send the info to Omniture server -->
<script language="javascript">var s_code=s.t();if(s_code)document.write(s_code)</script>
<noscript><p>Scripting on this page tracks web page traffic,
but does not change the content in any way.</p></noscript>
<!-- End SiteCatalyst code -->
</body>
</html>

