<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<!-- GenHTML revision 25226-->
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>The customer Example Application - The Java EE 6 Tutorial</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2013-01-01">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/ipg.css">
<link rel="stylesheet" type="text/css" href="css/javaeetutorial.css">
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>

<body>

<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tbody>
   <tr valign="top">
      <td width="400px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="gexaf.html">Preface</a></p>
<p class="toc level1 tocsp"><a href="gfirp.html">Part&nbsp;I&nbsp;Introduction</a></p>
<p class="toc level2"><a href="bnaaw.html">1.&nbsp;&nbsp;Overview</a></p>
<p class="toc level2"><a href="gfiud.html">2.&nbsp;&nbsp;Using the Tutorial Examples</a></p>
<p class="toc level1 tocsp"><a href="bnadp.html">Part&nbsp;II&nbsp;The Web Tier</a></p>
<p class="toc level2"><a href="bnadr.html">3.&nbsp;&nbsp;Getting Started with Web Applications</a></p>
<p class="toc level2"><a href="bnaph.html">4.&nbsp;&nbsp;JavaServer Faces Technology</a></p>
<p class="toc level2"><a href="giepx.html">5.&nbsp;&nbsp;Introduction to Facelets</a></p>
<p class="toc level2"><a href="gjddd.html">6.&nbsp;&nbsp;Expression Language</a></p>
<p class="toc level2"><a href="bnaqz.html">7.&nbsp;&nbsp;Using JavaServer Faces Technology in Web Pages</a></p>
<p class="toc level2"><a href="gjcut.html">8.&nbsp;&nbsp;Using Converters, Listeners, and Validators</a></p>
<p class="toc level2"><a href="bnatx.html">9.&nbsp;&nbsp;Developing with JavaServer Faces Technology</a></p>
<p class="toc level2"><a href="gkmaa.html">10.&nbsp;&nbsp;JavaServer Faces Technology: Advanced Concepts</a></p>
<p class="toc level2"><a href="gkiow.html">11.&nbsp;&nbsp;Using Ajax with JavaServer Faces Technology</a></p>
<p class="toc level2"><a href="gkhxa.html">12.&nbsp;&nbsp;Composite Components: Advanced Topics and Example</a></p>
<p class="toc level2"><a href="bnavg.html">13.&nbsp;&nbsp;Creating Custom UI Components and Other Custom Objects</a></p>
<p class="toc level2"><a href="bnawo.html">14.&nbsp;&nbsp;Configuring JavaServer Faces Applications</a></p>
<p class="toc level2"><a href="bnafd.html">15.&nbsp;&nbsp;Java Servlet Technology</a></p>
<p class="toc level2"><a href="glrbb.html">16.&nbsp;&nbsp;Uploading Files with Java Servlet Technology</a></p>
<p class="toc level2"><a href="bnaxu.html">17.&nbsp;&nbsp;Internationalizing and Localizing Web Applications</a></p>
<p class="toc level1 tocsp"><a href="bnayk.html">Part&nbsp;III&nbsp;Web Services</a></p>
<p class="toc level2"><a href="gijti.html">18.&nbsp;&nbsp;Introduction to Web Services</a></p>
<p class="toc level2"><a href="bnayl.html">19.&nbsp;&nbsp;Building Web Services with JAX-WS</a></p>
<p class="toc level2"><a href="giepu.html">20.&nbsp;&nbsp;Building RESTful Web Services with JAX-RS</a></p>
<p class="toc level2"><a href="gjjxe.html">21.&nbsp;&nbsp;JAX-RS: Advanced Topics and Example</a></p>
<p class="toc level3"><a href="gkkrb.html">Annotations for Field and Bean Properties of Resource Classes</a></p>
<p class="toc level4"><a href="gkkrb.html#gkkya">Extracting Path Parameters</a></p>
<p class="toc level4"><a href="gkkrb.html#gkkxj">Extracting Query Parameters</a></p>
<p class="toc level4"><a href="gkkrb.html#gkkyc">Extracting Form Data</a></p>
<p class="toc level4"><a href="gkkrb.html#gklcq">Extracting the Java Type of a Request or Response</a></p>
<p class="toc level3 tocsp"><a href="gknav.html">Subresources and Runtime Resource Resolution</a></p>
<p class="toc level4"><a href="gknav.html#gklag">Subresource Methods</a></p>
<p class="toc level4"><a href="gknav.html#gkrhr">Subresource Locators</a></p>
<p class="toc level3 tocsp"><a href="gkncy.html">Integrating JAX-RS with EJB Technology and CDI</a></p>
<p class="toc level3"><a href="gkqda.html">Conditional HTTP Requests</a></p>
<p class="toc level3"><a href="gkqbq.html">Runtime Content Negotiation</a></p>
<p class="toc level3"><a href="gkknj.html">Using JAX-RS With JAXB</a></p>
<p class="toc level4"><a href="gkknj.html#gmfrj">Using Java Objects to Model Your Data</a></p>
<p class="toc level4"><a href="gkknj.html#gmfqs">Starting from an Existing XML Schema Definition</a></p>
<p class="toc level4"><a href="gkknj.html#gmfnu">Using JSON with JAX-RS and JAXB</a></p>
<div id="scrolltoc" class="onpage">
<p class="toc level3 tocsp"><a href="">The <tt>customer</tt> Example Application</a></p>
<p class="toc level4"><a href="#gmggz">Overview of the <tt>customer</tt> Example Application</a></p>
<p class="toc level4"><a href="#gmgcm">The <tt>Customer</tt> and <tt>Address</tt> Entity Classes</a></p>
<p class="toc level4"><a href="#gklgt">The <tt>CustomerService</tt> Class</a></p>
<p class="toc level4"><a href="#gkqjq">The <tt>CustomerClientXML</tt> and <tt>CustomerClientJSON</tt> Classes</a></p>
<p class="toc level4"><a href="#gmgbv">Modifying the Example to Generate Entity Classes from an Existing Schema</a></p>
<p class="toc level5"><a href="#gmgot">To Modify the <tt>customer</tt> Example to Generate Java Entity Classes from an Existing XML Schema Definition</a></p>
<p class="toc level4 tocsp"><a href="#gkqkv">Running the <tt>customer</tt> Example</a></p>
<p class="toc level5"><a href="#gkqly">To Build, Package, and Deploy the <tt>customer</tt> Example Using NetBeans IDE</a></p>
<p class="toc level5"><a href="#gkqjv">To Build, Package, and Deploy the <tt>customer</tt> Example Using Ant</a></p>
<p class="toc level5"><a href="#glhwn">To Run the <tt>customer</tt> Example Using the Jersey Client</a></p>
<p class="toc level5"><a href="#gkqkq">To Run the <tt>customer</tt> Example Using the Web Services Tester</a></p>
<p class="toc level5"><a href="#gkqjl">Using Curl to Run the <tt>customer</tt> Example Application</a></p>
</div>
<p class="toc level1 tocsp"><a href="bnblr.html">Part&nbsp;IV&nbsp;Enterprise Beans</a></p>
<p class="toc level2"><a href="gijsz.html">22.&nbsp;&nbsp;Enterprise Beans</a></p>
<p class="toc level2"><a href="gijre.html">23.&nbsp;&nbsp;Getting Started with Enterprise Beans</a></p>
<p class="toc level2"><a href="gijrb.html">24.&nbsp;&nbsp;Running the Enterprise Bean Examples</a></p>
<p class="toc level2"><a href="bnbpk.html">25.&nbsp;&nbsp;A Message-Driven Bean Example</a></p>
<p class="toc level2"><a href="gkcqz.html">26.&nbsp;&nbsp;Using the Embedded Enterprise Bean Container</a></p>
<p class="toc level2"><a href="gkidz.html">27.&nbsp;&nbsp;Using Asynchronous Method Invocation in Session Beans</a></p>
<p class="toc level1 tocsp"><a href="gjbnr.html">Part&nbsp;V&nbsp;Contexts and Dependency Injection for the Java EE Platform</a></p>
<p class="toc level2"><a href="giwhb.html">28.&nbsp;&nbsp;Introduction to Contexts and Dependency Injection for the Java EE Platform</a></p>
<p class="toc level2"><a href="gjbls.html">29.&nbsp;&nbsp;Running the Basic Contexts and Dependency Injection Examples</a></p>
<p class="toc level2"><a href="gjehi.html">30.&nbsp;&nbsp;Contexts and Dependency Injection for the Java EE Platform: Advanced Topics</a></p>
<p class="toc level2"><a href="gkhre.html">31.&nbsp;&nbsp;Running the Advanced Contexts and Dependency Injection Examples</a></p>
<p class="toc level1 tocsp"><a href="bnbpy.html">Part&nbsp;VI&nbsp;Persistence</a></p>
<p class="toc level2"><a href="bnbpz.html">32.&nbsp;&nbsp;Introduction to the Java Persistence API</a></p>
<p class="toc level2"><a href="gijst.html">33.&nbsp;&nbsp;Running the Persistence Examples</a></p>
<p class="toc level2"><a href="bnbtg.html">34.&nbsp;&nbsp;The Java Persistence Query Language</a></p>
<p class="toc level2"><a href="gjitv.html">35.&nbsp;&nbsp;Using the Criteria API to Create Queries</a></p>
<p class="toc level2"><a href="gkjiq.html">36.&nbsp;&nbsp;Creating and Using String-Based Criteria Queries</a></p>
<p class="toc level2"><a href="gkjjf.html">37.&nbsp;&nbsp;Controlling Concurrent Access to Entity Data with Locking</a></p>
<p class="toc level2"><a href="gkjia.html">38.&nbsp;&nbsp;Using a Second-Level Cache with Java Persistence API Applications</a></p>
<p class="toc level1 tocsp"><a href="gijrp.html">Part&nbsp;VII&nbsp;Security</a></p>
<p class="toc level2"><a href="bnbwj.html">39.&nbsp;&nbsp;Introduction to Security in the Java EE Platform</a></p>
<p class="toc level2"><a href="bncas.html">40.&nbsp;&nbsp;Getting Started Securing Web Applications</a></p>
<p class="toc level2"><a href="bnbyk.html">41.&nbsp;&nbsp;Getting Started Securing Enterprise Applications</a></p>
<p class="toc level2"><a href="gjjwx.html">42.&nbsp;&nbsp;Java EE Security: Advanced Topics</a></p>
<p class="toc level1 tocsp"><a href="gijue.html">Part&nbsp;VIII&nbsp;Java EE Supporting Technologies</a></p>
<p class="toc level2"><a href="gijto.html">43.&nbsp;&nbsp;Introduction to Java EE Supporting Technologies</a></p>
<p class="toc level2"><a href="bncih.html">44.&nbsp;&nbsp;Transactions</a></p>
<p class="toc level2"><a href="bncjh.html">45.&nbsp;&nbsp;Resources and Resource Adapters</a></p>
<p class="toc level2"><a href="glodb.html">46.&nbsp;&nbsp;The Resource Adapter Example</a></p>
<p class="toc level2"><a href="bncdq.html">47.&nbsp;&nbsp;Java Message Service Concepts</a></p>
<p class="toc level2"><a href="bncgv.html">48.&nbsp;&nbsp;Java Message Service Examples</a></p>
<p class="toc level2"><a href="gkahp.html">49.&nbsp;&nbsp;Bean Validation: Advanced Topics</a></p>
<p class="toc level2"><a href="gkeed.html">50.&nbsp;&nbsp;Using Java EE Interceptors</a></p>
<p class="toc level1 tocsp"><a href="gkgjw.html">Part&nbsp;IX&nbsp;Case Studies</a></p>
<p class="toc level2"><a href="glnvi.html">51.&nbsp;&nbsp;Duke's Bookstore Case Study Example</a></p>
<p class="toc level2"><a href="gkaee.html">52.&nbsp;&nbsp;Duke's Tutoring Case Study Example</a></p>
<p class="toc level2"><a href="glnpw.html">53.&nbsp;&nbsp;Duke's Forest Case Study Example</a></p>
<p class="toc level1 tocsp"><a href="idx-1.html">Index</a></p>
</td>
      <td width="10px">&nbsp;</td>
      <td>
         <div class="header">
             <div class="banner">
                <table width="100%" border="0" cellpadding="5" cellspacing="0">
                   <tbody>
                      <tr>
                         <td valign="bottom"><p class="Banner">The Java EE 6 Tutorial
</p></td>
                         <td align="right"  valign="bottom"><img src="graphics/javalogo.png" alt="Java Coffee Cup logo"></td>
                      </tr>
                   </tbody>
                </table>
             </div>

             <div class="header-links">
	         <a href="./index.html">Home</a> | 
<a href="../information/download.html">Download</a> | 
<a href="./javaeetutorial6.pdf">PDF</a> | 
<a href="../information/faq.html">FAQ</a> | 
<a href="http://docs.oracle.com/javaee/support/feedback.htm">Feedback</a>

             </div>
             <div class="navigation">
                 <a href="gkknj.html"><img src="graphics/leftButton.gif" border="0" alt="Previous" title="Previous"></a>
                 <a href="p1.html"><img src="graphics/upButton.gif" border="0" alt="Contents" title="Contents"></a>
                 <a href="bnblr.html"><img src="graphics/rightButton.gif" border="0" alt="Next" title="Next"></a>
             </div>
         </div>

	 <div class="maincontent">      	 
             

<a name="gkoib"></a><h2>The <tt>customer</tt> Example Application</h2>
<a name="indexterm-1327"></a><a name="indexterm-1328"></a><a name="indexterm-1329"></a><p>This section describes how to build and run the <tt>customer</tt> sample application. This
example application is a RESTful web service that uses JAXB to perform the
Create, Read, Update, Delete (CRUD) operations for a specific entity.</p>

<p>The <tt>customer</tt> sample application is in the <tt></tt><i>tut-install</i><tt>/examples/jaxrs/customer/</tt> directory. See <a href="gfiud.html">Chapter&nbsp;2, Using the Tutorial Examples</a> for
basic information on building and running sample applications.</p>



<a name="gmggz"></a><h3>Overview of the <tt>customer</tt> Example Application</h3>
<p>The source files of this application are at <tt></tt><i>tut-install</i><tt>/examples/jaxrs/customer/src/java/</tt>. The application has
three parts:</p>


<ul><li><p>The <tt>Customer</tt> and <tt>Address</tt> entity classes. These classes model the data of the application and contain JAXB annotations. See <a href="#gmgcm">The <tt>Customer</tt> and <tt>Address</tt> Entity Classes</a> for details.</p>

</li>
<li><p>The <tt>CustomerService</tt> resource class. This class contains JAX-RS resource methods that perform operations on <tt>Customer</tt> instances represented as XML or JSON data using JAXB.  See <a href="#gklgt">The <tt>CustomerService</tt> Class</a> for details.</p>

</li>
<li><p>The <tt>CustomerClientXML</tt> and <tt>CustomerClientJSON</tt> client classes. These classes test the resource methods of the web service using XML and JSON representations of <tt>Customer</tt> instances.  See <a href="#gkqjq">The <tt>CustomerClientXML</tt> and <tt>CustomerClientJSON</tt> Classes</a> for details.</p>

</li></ul>
<p>The <tt>customer</tt> sample application shows you how to model your data entities as
Java classes with JAXB annotations. The JAXB schema generator produces an equivalent XML
schema definition file (<tt>.xsd</tt>) for your entity classes. The resulting schema is used
to automatically marshal and unmarshal entity instances to and from XML or JSON
in the JAX-RS resource methods.</p>

<p>In some cases you may already have an XML schema definition for
your entities. See <a href="#gmgbv">Modifying the Example to Generate Entity Classes from an Existing Schema</a> for instructions on how to modify the <tt>customer</tt> example to
model your data starting from an <tt>.xsd</tt> file and using JAXB to
generate the equivalent Java classes.</p>



<a name="gmgcm"></a><h3>The <tt>Customer</tt> and <tt>Address</tt> Entity Classes</h3>
<p>The following class represents a customer&rsquo;s address:</p>

<pre>@XmlRootElement(name="address")
@XmlAccessorType(XmlAccessType.FIELD)
public class Address {
    
    @XmlElement(required=true) 
    protected int number;

    @XmlElement(required=true)  
    protected String street;
    
    @XmlElement(required=true)  
    protected String city;
    
    @XmlElement(required=true) 
    protected String state;
    
    @XmlElement(required=true)  
    protected String zip;
    
    @XmlElement(required=true)
    protected String country;
    
    public Address() { }

    // Getter and setter methods
    // ...
}</pre><p>The <tt>@XmlRootElement(name="address")</tt> annotation maps this class to the <tt>address</tt> XML element. The <tt>@XmlAccessorType(XmlAccessType.FIELD)</tt>
annotation specifies that all the fields of this class are bound to XML
by default. The <tt>@XmlElement(required=true)</tt> annotation specifies that an element must be present in
the XML representation.</p>

<p>The following class represents a customer:</p>

<pre>@XmlRootElement(name="customer")
@XmlAccessorType(XmlAccessType.FIELD)
public class Customer {
    
    @XmlAttribute(required=true) 
    protected int id;
    
    @XmlElement(required=true) 
    protected String firstname;
    
    @XmlElement(required=true) 
    protected String lastname;
    
    @XmlElement(required=true)
    protected Address address;
    
    @XmlElement(required=true)
    protected String email;
 
    @XmlElement (required=true)
    protected String phone;

    
    public Customer() { }

    // Getter and setter methods
    // ...
}</pre><p>The <tt>Customer</tt> class contains the same JAXB annotations as the previous class, except
for the <tt>@XmlAttribute(required=true)</tt> annotation, which maps a property to an attribute of the
XML element representing the class.</p>

<p>The <tt>Customer</tt> class contains a property whose type is another entity, the <tt>Address</tt>
class. This mechanism allows you to define in Java code the hierarchical relationships
between entities without having to write an <tt>.xsd</tt> file yourself.</p>

<p>JAXB generates the following XML schema definition for the two classes above:</p>

<pre>&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?>
&lt;xs:schema version="1.0" xmlns:xs="http://www.w3.org/2001/XMLSchema">

  &lt;xs:element name="address" type="address"/>
  &lt;xs:element name="customer" type="customer"/>

  &lt;xs:complexType name="address">
    &lt;xs:sequence>
      &lt;xs:element name="number" type="xs:int"/>
      &lt;xs:element name="street" type="xs:string"/>
      &lt;xs:element name="city" type="xs:string"/>
      &lt;xs:element name="state" type="xs:string"/>
      &lt;xs:element name="zip" type="xs:string"/>
      &lt;xs:element name="country" type="xs:string"/>
    &lt;/xs:sequence>
  &lt;/xs:complexType>

  &lt;xs:complexType name="customer">
    &lt;xs:sequence>
      &lt;xs:element name="firstname" type="xs:string"/>
      &lt;xs:element name="lastname" type="xs:string"/>
      &lt;xs:element ref="address"/>
      &lt;xs:element name="email" type="xs:string"/>
      &lt;xs:element name="phone" type="xs:string"/>
    &lt;/xs:sequence>
    &lt;xs:attribute name="id" type="xs:int" use="required"/>
  &lt;/xs:complexType>
&lt;/xs:schema></pre><p>The file <tt>sample-input.xml</tt> in the top-level directory of the project contains an example
of an XML representation of a customer:</p>

<pre>&lt;?xml version="1.0" encoding="UTF-8"?>
&lt;customer id="1">
  &lt;firstname>Duke&lt;/firstname>
  &lt;lastname>OfJava&lt;/lastname>
  &lt;address>
    &lt;number>1&lt;/number>
    &lt;street>Duke's Way&lt;/street>
    &lt;city>JavaTown&lt;/city>
    &lt;state>JA&lt;/state>
    &lt;zip>12345&lt;/zip>
    &lt;country>USA&lt;/country>
  &lt;/address>
  &lt;email>duke@example.com&lt;/email>
  &lt;phone>123-456-7890&lt;/phone>
&lt;/customer></pre><p>The file <tt>sample-input.json</tt> contains an example of a JSON representation of a customer:</p>

<pre>{
    "@id": "1",
    "firstname": "Duke",
    "lastname": "OfJava",
    "address": {
        "number": 1,
        "street": "Duke's Way",
        "city": "JavaTown",
        "state": "JA",
        "zip": "12345",
        "country": "USA"
    },
    "email": "duke@example.com",
    "phone": "123-456-7890"
}</pre>

<a name="gklgt"></a><h3>The <tt>CustomerService</tt> Class</h3>
<p>The <tt>CustomerService</tt> class has a <tt>createCustomer</tt> method that creates a customer resource
based on the <tt>Customer</tt> class and returns a URI for the new
resource. The <tt>persist</tt> method emulates the behavior of the JPA entity manager.
This example uses a <tt>java.util.Properties</tt> file to store data. If you are using the
default configuration of GlassFish Server, the properties file is at <tt></tt><i>domain-dir</i><tt>/CustomerDATA.txt</tt>.</p>

<pre>@Path("/Customer")
public class CustomerService {
    public static final String DATA_STORE = "CustomerDATA.txt";
    public static final Logger logger = 
            Logger.getLogger(CustomerService.class.getCanonicalName());
    ...

    @POST
    @Consumes({"application/xml", "application/json"})
    public Response createCustomer(Customer customer) {
        try {
            long customerId = persist(customer);
            return Response.created(URI.create("/" + customerId)).build();
        } catch (Exception e) {
          throw new WebApplicationException(e, 
                  Response.Status.INTERNAL_SERVER_ERROR);
        }
    }
    ...

    private long persist(Customer customer) throws IOException {

        File dataFile = new File(DATA_STORE);

        if (!dataFile.exists()) {
            dataFile.createNewFile();
        }

        long customerId = customer.getId();
        Address address = customer.getAddress();

        Properties properties = new Properties();
        properties.load(new FileInputStream(dataFile));

        properties.setProperty(String.valueOf(customerId),
                customer.getFirstname() + ","
                + customer.getLastname() + ","
                + address.getNumber() + ","
                + address.getStreet() + ","
                + address.getCity() + ","
                + address.getState() + ","
                + address.getZip() + ","
                + address.getCountry() + ","
                + customer.getEmail() + ","
                + customer.getPhone());

        properties.store(new FileOutputStream(DATA_STORE),null);

        return customerId;
    }
    ...
}</pre><p>The response returned to the client has a URI to the newly
created resource. The return type is an entity body mapped from the property
of the response with the status code specified by the status property of
the response. The <tt>WebApplicationException</tt> is a <tt>RuntimeException</tt> that is used to wrap the
appropriate HTTP error status code, such as 404, 406, 415, or 500.</p>

<p>The <tt>@Consumes({"application/xml","application/json"})</tt> and <tt>@Produces({"application/xml","application/json"})</tt> annotations set the request and response media types to
use the appropriate MIME client. These annotations can be applied to a resource
method, a resource class, or even an entity provider. If you do not
use these annotations, JAX-RS allows the use of any media type (<tt>"*/*"</tt>).</p>

<p>The following code snippet shows the implementation of the <tt>getCustomer</tt> and <tt>findbyId</tt>
methods. The <tt>getCustomer</tt> method uses the <tt>@Produces</tt> annotation and returns a <tt>Customer</tt> object,
which is converted to an XML or JSON representation depending on the <tt>Accept:</tt>
header specified by the client.</p>

<pre>@GET
@Path("{id}")
@Produces({"application/xml", "application/json"})
public Customer getCustomer(@PathParam("id") String customerId) {
    Customer customer = null;

    try {
        customer = findById(customerId);
    } catch (Exception ex) {
        logger.log(Level.SEVERE,
                "Error calling searchCustomer() for customerId {0}. {1}",
                new Object[]{customerId, ex.getMessage()});
    }
    return customer;
}

private Customer findById(String customerId) throws IOException {
    properties properties = new Properties();
    properties.load(new FileInputStream(DATA_STORE));
    String rawData = properties.getProperty(customerId);

    if (rawData != null) {
        final String[] field = rawData.split(",");

        Address address = new Address();
        Customer customer = new Customer();
        customer.setId(Integer.parseInt(customerId));
        customer.setAddress(address);

        customer.setFirstname(field[0]);
        customer.setLastname(field[1]);
        address.setNumber(Integer.parseInt(field[2]));
        address.setStreet(field[3]);
        address.setCity(field[4]);
        address.setState(field[5]);
        address.setZip(field[6]);
        address.setCountry(field[7]);
        customer.setEmail(field[8]);
        customer.setPhone(field[9]);

        return customer;
    }
    return null;
}</pre>

<a name="gkqjq"></a><h3>The <tt>CustomerClientXML</tt> and <tt>CustomerClientJSON</tt> Classes</h3>
<p>Jersey is the reference implementation of JAX-RS (JSR 311). You can use the
Jersey client API to write a test client for the <tt>customer</tt> example application.
You can find the Jersey APIs at <a href="http://jersey.java.net/nonav/apidocs/latest/jersey/">http://jersey.java.net/nonav/apidocs/latest/jersey/</a>.</p>

<p>The <tt>CustomerClientXML</tt> class calls Jersey APIs to test the <tt>CustomerService</tt> web service:</p>

<pre>package customer.rest.client;

import com.sun.jersey.api.client.Client;
import com.sun.jersey.api.client.ClientResponse;
import com.sun.jersey.api.client.WebResource;
import customer.data.Address;
import customer.data.Customer;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.ws.rs.core.MediaType;

public class CustomerClientXML {
    public static final Logger logger =
            Logger.getLogger(CustomerClientXML.class.getCanonicalName());

    public static void main(String[] args) {

        Client client = Client.create();
        // Define the URL for testing the example application
        WebResource webResource = 
               client.resource("http://localhost:8080/customer/rest/Customer");

        // Test the POST method
        Customer customer = new Customer();
        Address address = new Address();
        customer.setAddress(address);

        customer.setId(1);
        customer.setFirstname("Duke");
        customer.setLastname("OfJava");
        address.setNumber(1);
        address.setStreet("Duke's Drive");
        address.setCity("JavaTown");
        address.setZip("1234");
        address.setState("JA");
        address.setCountry("USA");
        customer.setEmail("duke@java.net");
        customer.setPhone("12341234");

        ClientResponse response = 
                webResource.type("application/xml").post(ClientResponse.class,
                customer);

        logger.info("POST status: {0}" + response.getStatus());
        if (response.getStatus() == 201) {
            logger.info("POST succeeded");
        } else {
            logger.info("POST failed");
        }

        // Test the GET method using content negotiation
        response = webResource.path("1").accept(MediaType.APPLICATION_XML)
                .get(ClientResponse.class);
        Customer entity = response.getEntity(Customer.class);

        logger.log(Level.INFO, "GET status: {0}", response.getStatus());
        if (response.getStatus() == 200) {
            logger.log(Level.INFO, "GET succeeded, city is {0}",
                    entity.getAddress().getCity());
        } else {
            logger.info("GET failed");
        }

        // Test the DELETE method
        response = webResource.path("1").delete(ClientResponse.class);

        logger.log(Level.INFO, "DELETE status: {0}", response.getStatus());
        if (response.getStatus() == 204) {
            logger.info("DELETE succeeded (no content)");
        } else {
            logger.info("DELETE failed");
        }

        response = webResource.path("1").accept(MediaType.APPLICATION_XML)
                .get(ClientResponse.class);
        logger.log(Level.INFO, "GET status: {0}", response.getStatus());
        if (response.getStatus() == 204) {
            logger.info("After DELETE, the GET request returned no content.");
        } else {
            logger.info("Failed, after DELETE, GET returned a response.");
        }
    }
}</pre><p>This Jersey client tests the POST, GET, and DELETE methods using XML representations.</p>

<p>All of these HTTP status codes indicate success: 201 for POST, 200
for GET, and 204 for DELETE. For details about the meanings of HTTP
status codes, see <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html</a>.</p>

<p>The <tt>CustomerClientJSON</tt> class is similar to <tt>CustomerClientXML</tt> but it uses JSON representations
to test the web service. In the <tt>CustomerClientJSON</tt> class <tt>"application/xml"</tt> is replaced by
<tt>"application/json"</tt>, and <tt>MediaType.APPLICATION_XML</tt> is replaced by <tt>MediaType.APPLICATION_JSON</tt>.</p>



<a name="gmgbv"></a><h3>Modifying the Example to Generate Entity Classes from an Existing Schema</h3>
<p>This section describes how you can modify the <tt>customer</tt> example if you provide
an XML schema definition file for your entities instead of providing Java classes.
In this case JAXB generates the equivalent Java entity classes from the schema
definition.</p>

<p>For the <tt>customer</tt> example you provide the following <tt>.xsd</tt> file:</p>

<pre>&lt;?xml version="1.0"?>
&lt;xs:schema targetNamespace="http://xml.customer"
    xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified"
    xmlns:ora="http://xml.customer">

  &lt;xs:element name="customer" type="ora:Customer"/>

  &lt;xs:complexType name="Address">
    &lt;xs:sequence>
      &lt;xs:element name="number" type="xs:int"/>
      &lt;xs:element name="street" type="xs:string"/>
      &lt;xs:element name="city" type="xs:string"/>
      &lt;xs:element name="state" type="xs:string"/>
      &lt;xs:element name="zip" type="xs:string"/>
      &lt;xs:element name="country" type="xs:string"/>
    &lt;/xs:sequence>
  &lt;/xs:complexType>

  &lt;xs:complexType name="Customer">
    &lt;xs:sequence>
      &lt;xs:element name="firstname" type="xs:string"/>
      &lt;xs:element name="lastname" type="xs:string"/>
      &lt;xs:element name="address" type="ora:Address"/>
      &lt;xs:element name="email" type="xs:string"/>
      &lt;xs:element name="phone" type="xs:string"/>
    &lt;/xs:sequence>
    &lt;xs:attribute name="id" type="xs:int" use="required"/>
  &lt;/xs:complexType>
&lt;/xs:schema></pre><p>You can modify the <tt>customer</tt> example as follows:</p>



<a name="gmgot"></a><h4>To Modify the <tt>customer</tt> Example to Generate Java Entity Classes from an Existing XML Schema Definition</h4>
<ol>
<li><b>Create a JAXB binding to generate the entity Java classes from the schema
definition. For example, in NetBeans IDE, follow these steps:</b><ol style="list-style-type: lower-alpha">
<li><b>Right click on the <tt>customer</tt> project and select New > Other...</b></li>
<li><b>Under the XML folder, select JAXB Binding and click Next.</b></li>
<li><b>In the Binding Name field, type <tt>CustomerBinding</tt>.</b></li>
<li><b>Click Browse and choose the <tt>.xsd</tt> file from your file system.</b></li>
<li><b>In the Package Name field, type <tt>customer.xml</tt>.</b></li>
<li><b>Click Finish.</b></li></ol><p>This procedure creates the <tt>Customer</tt> class, the <tt>Address</tt> class, and some JAXB
auxiliary classes in the package <tt>customer.xml</tt>.</p></li>
<li><b>Modify the <tt>CustomerService</tt> class as follows:</b><ol style="list-style-type: lower-alpha">
<li><b>Replace the <tt>customer.data.*</tt> imports with <tt>customer.xml.*</tt> imports and import the <tt>JAXBElement</tt> and
<tt>ObjectFactory</tt> classes:</b><pre>import customer.xml.Customer;
import customer.xml.Address;
import customer.xml.ObjectFactory;
import javax.xml.bind.JAXBElement;</pre></li>
<li><b>Replace the return type of the <tt>getCustomer</tt> method:</b><pre>public JAXBElement&lt;Customer> getCustomer(
        @PathParam("id") String customerId) {
    ...
    return new ObjectFactory().createCustomer(customer);
}</pre></li></ol></li>
<li><b>Modify the <tt>CustomerClientXML</tt> and <tt>CustomerClientJSON</tt> classes as follows:</b><ol style="list-style-type: lower-alpha">
<li><b>Replace the <tt>customer.data.*</tt> imports with <tt>customer.xml.*</tt> imports and import the <tt>JAXBElement</tt> and
<tt>ObjectFactory</tt> classes:</b><pre>import customer.xml.Address;
import customer.xml.Customer;
import customer.xml.ObjectFactory;
import javax.xml.bind.JAXBElement;</pre></li>
<li><b>Create an <tt>ObjectFactory</tt> instance and a <tt>JAXBElement&lt;Customer></tt> instance at the beginning of
the <tt>main</tt> method:</b><pre>public static void main(String[] args) {
    Client client = Client.create();
    ObjectFactory factory = new ObjectFactory();
    WebResource webResource = ...;
    ...
    customer.setPhone("12341234");
    JAXBElement&lt;Customer> customerJAXB = factory.createCustomer(customer);
    ClientResponse response = webResource.type("application/xml")
            .post(ClientResponse.class, customerJAXB);
    ...
}</pre></li>
<li><b>Modify the <tt>GET</tt> request after testing the <tt>DELETE</tt> method:</b><pre>response = webResource.path("1").accept(MediaType.APPLICATION_XML)
        .get(ClientResponse.class);
entity = response.getEntity(Customer.class);
logger.log(Level.INFO, "GET status: {0}", response.getStatus());
try {
    logger.info(entity.getAddress().getCity());
} catch (NullPointerException ne) {
    // null after deleting the only customer
    logger.log(Level.INFO, "After DELETE, city is: {0}", ne.getCause());
}</pre></li></ol><p>The instructions for building, deploying, and running the example are the same for
the original <tt>customer</tt> example and for the modified version using this procedure.</p></li></ol>

<a name="gkqkv"></a><h3>Running the <tt>customer</tt> Example</h3>
<p>You can use either NetBeans IDE or Ant to build, package, deploy, and
run the <tt>customer</tt> application.</p>



<a name="gkqly"></a><h4>To Build, Package, and Deploy the <tt>customer</tt> Example Using NetBeans IDE</h4>
<p>This procedure builds the application into the <tt></tt><i>tut-install</i><tt>/examples/jax-rs/customer/build/web/</tt> directory. The contents of
this directory are deployed to the GlassFish Server.</p>

<ol>
<li><b>From the File menu, choose Open Project.</b></li>
<li><b>In the Open Project dialog, navigate to:</b><pre><tt></tt><i>tut-install</i><tt>/examples/jaxrs/</tt></pre></li>
<li><b>Select the <tt>customer</tt> folder.</b></li>
<li><b>Select the Open as Main Project check box.</b></li>
<li><b>Click Open Project.</b><p>It may appear that there are errors in the source files, because the
files refer to JAXB classes that will be generated when you build the
application. You can ignore these errors.</p></li>
<li><b>In the Projects tab, right-click the <tt>customer</tt> project and select Deploy.</b></li></ol>

<a name="gkqjv"></a><h4>To Build, Package, and Deploy the <tt>customer</tt> Example Using Ant</h4>
<ol>
<li><b>In a terminal window, go to:</b><pre><tt></tt><i>tut-install</i><tt>/examples/jaxrs/customer/</tt></pre></li>
<li><b>Type the following command:</b><pre><tt><b>ant</b></tt></pre><p>This command calls the <tt>default</tt> target, which builds and packages the application into
a WAR file, <tt>customer.war</tt>, located in the <tt>dist</tt> directory.</p></li>
<li><b>Type the following command:</b><pre><tt><b>ant deploy</b></tt></pre><p>Typing this command deploys <tt>customer.war</tt> to the GlassFish Server.</p></li></ol>

<a name="glhwn"></a><h4>To Run the <tt>customer</tt> Example Using the Jersey Client</h4>
<ol>
<li><b>In NetBeans IDE, expand the Source Packages node.</b></li>
<li><b>Expand the <tt>customer.rest.client</tt> node.</b></li>
<li><b>Right-click the <tt>CustomerClientXML.java</tt> file and select Run File.</b><p>The output of the client looks like this:</p><pre>run:
Jun 12, 2012 2:40:20 PM customer.rest.client.CustomerClientXML main
INFO: POST status: 201
Jun 12, 2012 2:40:20 PM customer.rest.client.CustomerClientXML main
INFO: POST succeeded
Jun 12, 2012 2:40:20 PM customer.rest.client.CustomerClientXML main
INFO: GET status: 200
Jun 12, 2012 2:40:20 PM customer.rest.client.CustomerClientXML main
INFO: GET succeeded, city is JavaTown
Jun 12, 2012 2:40:20 PM customer.rest.client.CustomerClientXML main
INFO: DELETE status: 204
Jun 12, 2012 2:40:20 PM customer.rest.client.CustomerClientXML main
INFO: DELETE succeeded (no content)
Jun 12, 2012 2:40:20 PM customer.rest.client.CustomerClientXML main
INFO: GET status: 204
Jun 12, 2012 2:40:20 PM customer.rest.client.CustomerClientXML main
INFO: After DELETE, the GET request returned no content.
BUILD SUCCESSFUL (total time: 5 seconds)</pre><p>The output is slightly different for the modified <tt>customer</tt> example:</p><pre>run:
Jun 12, 2012 2:40:20 PM customer.rest.client.CustomerClientXML main
INFO: POST status: 201
[...]
Jun 12, 2012 2:40:20 PM customer.rest.client.CustomerClientXML main
INFO: DELETE succeeded (no content)
Jun 12, 2012 2:40:20 PM customer.rest.client.CustomerClientXML main
INFO: GET status: 200
Jun 12, 2012 2:40:20 PM customer.rest.client.CustomerClientXML main
INFO: After DELETE, city is: null
BUILD SUCCESSFUL (total time: 5 seconds)</pre></li></ol>

<a name="gkqkq"></a><h4>To Run the <tt>customer</tt> Example Using the Web Services Tester</h4>
<ol>
<li><b>In NetBeans IDE, right-click the customer node and select Test RESTful Web Services.</b>
<hr><p><b>Note - </b>The Web Services Tester works only with the modified version of the <tt>customer</tt>
example.</p>


<hr>
</li>
<li><b>In the Configure REST Test Client dialog, select Web Test Client in Project
and click Browse.</b></li>
<li><b>In the Select Project dialog, choose the customer project and click OK.</b></li>
<li><b>In the Configure REST Test Client dialog, click OK.</b></li>
<li><b>When the test client appears in the browser, select the Customer resource node
in the left pane.</b></li>
<li><b>Paste the following XML code into the Content text area, replacing &ldquo;Insert content
here&rdquo;:</b><pre>&lt;?xml version="1.0" encoding="UTF-8"?>
&lt;customer id="1">
  &lt;firstname>Duke&lt;/firstname>
  &lt;lastname>OfJava&lt;/lastname>
  &lt;address>
    &lt;number>1&lt;/number>
    &lt;street>Duke's Way&lt;/street>
    &lt;city>JavaTown&lt;/city>
    &lt;state>JA&lt;/state>
    &lt;zip>12345&lt;/zip>
    &lt;country>USA&lt;/country>
  &lt;/address>
  &lt;email>duke@example.com&lt;/email>
  &lt;phone>123-456-7890&lt;/phone>
&lt;/customer></pre><p>You can find the code in the file <tt>customer/sample-input.xml</tt>.</p></li>
<li><b>Click Test.</b><p>The following message appears in the window below:</p><pre>Status: 201 (Created)</pre></li>
<li><b>Expand the Customer node and click <tt>{id}</tt>.</b></li>
<li><b>Type <tt>1</tt> in the id field and click Test to test the GET
method.</b><p>The following status message appears:</p><pre>Status: 200 (OK)</pre><p>The XML output for the resource appears in the Response window:</p><pre>&lt;?xml version="1.0" encoding="UTF-8"?>
&lt;customer xmlns="http://xml.customer" id="1">
  &lt;firstname>Duke&lt;/firstname>
  &lt;lastname>OfJava&lt;/lastname>
  &lt;address>
    &lt;number>1&lt;/number>
    &lt;street>Duke's Way&lt;/street>
    &lt;city>JavaTown&lt;/city>
    &lt;state>JA&lt;/state>
    &lt;zip>12345&lt;/zip>
    &lt;country>USA&lt;/country>
  &lt;/address>
  &lt;email>duke@example.com&lt;/email>
  &lt;phone>123-456-7890&lt;/phone>
&lt;/customer></pre><p>A GET for a nonexistent ID also returns a <tt>200 (OK)</tt> status, but the
output in the Response window shows no content:</p><pre>&lt;?xml version="1.0" encoding="UTF-8"?>
   &lt;customer xmlns="http://xml.customer" 
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/></pre><p>You can test other methods as follows:</p>


<ul><li><p>Select PUT, type the input for an existing customer, modify any content except the <tt>id</tt> value, and click Test to update the customer fields. A successful update returns the following status message:</p>

<pre>Status: 303 (See Other)</pre></li>
<li><p>Select DELETE, type the ID for an existing customer, and click Test to remove the customer. A successful delete returns the following status message:</p>

<pre>Status: 204 (See Other)</pre></li></ul>
</li></ol>

<a name="gkqjl"></a><h4>Using Curl to Run the <tt>customer</tt> Example Application</h4>
<p>Curl is a command-line tool you can use to run the <tt>customer</tt>
application on UNIX platforms. You can download Curl from <a href="http://curl.haxx.se">http://curl.haxx.se</a> or add it
to a Cygwin installation.</p>

<p>Run the following commands in the directory <tt></tt><i>tut-install</i><tt>/examples/jaxrs/customer/</tt> after deploying the application.</p>

<p>To add a new customer and test the POST method using XML
data, use the following command:</p>

<pre>curl -i --data @sample-input.xml \
--header Content-type:application/xml \
http://localhost:8080/customer/rest/Customer</pre><p>To add a new customer using JSON data instead, use the following
command:</p>

<pre>curl -i --data @sample-input.json \
--header Content-type:application/json \
http://localhost:8080/customer/rest/Customer</pre><p>A successful POST returns HTTP <tt>Status: 201 (Created)</tt>.</p>

<p>To retrieve the details of the customer whose ID is 1, use
the following command:</p>

<pre>curl -i -X GET http://localhost:8080/customer/rest/Customer/1</pre><p>To retrieve the details of the same customer represented as JSON data, use
the following command:</p>

<pre>curl -i --header Accept:application/json
     -X GET http://localhost:8080/customer/rest/Customer/1</pre><p>A successful GET returns HTTP <tt>Status: 200 (OK)</tt>.</p>

<p>To delete a customer record, use the following command:</p>

<pre>curl -i -X DELETE http://localhost:8080/customer/rest/Customer/1</pre><p>A successful DELETE returns HTTP <tt>Status: 204</tt>.</p>

<p>The <tt>customer</tt> example and the modified version respond differently to a GET request
for a customer ID that does not exist. The original customer example returns
HTTP <tt>Status: 204 (No content)</tt>, whereas the modified version returns HTTP <tt>Status: 200 (OK)</tt> with a response that contains
the XML header but no customer data.</p>


         </div>
         <div class="navigation">
             <a href="gkknj.html"><img src="graphics/leftButton.gif" border="0" alt="Previous" title="Previous"></a>
             <a href="p1.html"><img src="graphics/upButton.gif" border="0" alt="Contents" title="Contents"></a>
             <a href="bnblr.html"><img src="graphics/rightButton.gif" border="0" alt="Next" title="Next"></a>
         </div>

         <div class="copyright">
      	    <p>Copyright &copy; 2013, Oracle and/or its affiliates. All rights reserved. <a href="docinfo.html">Legal Notices</a></p>
      	 </div>

      </td>
   </tr>
</tbody>
</table>
<!-- Start SiteCatalyst code   -->
<script language="JavaScript" src="http://www.oracle.com/ocom/groups/systemobject/@mktg_admin/documents/systemobject/s_code_download.js"></script>
<script language="JavaScript" src="http://www.oracle.com/ocom/groups/systemobject/@mktg_admin/documents/systemobject/s_code.js"></script>
 
<!-- ********** DO NOT ALTER ANYTHING BELOW THIS LINE ! *********** -->
<!--  Below code will send the info to Omniture server -->
<script language="javascript">var s_code=s.t();if(s_code)document.write(s_code)</script>
<noscript><p>Scripting on this page tracks web page traffic,
but does not change the content in any way.</p></noscript>
<!-- End SiteCatalyst code -->
</body>
</html>

